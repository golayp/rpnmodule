(function(t){t.fn.disableSelection=function(){return this.attr("unselectable","on").css("user-select","none").on("selectstart",false)}})(jQuery);(function(t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{t(jQuery)}})(function(t){t.ui=t.ui||{};t.extend(t.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});t.fn.extend({scrollParent:function(e){var i=this.css("position"),s=i==="absolute",n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);if(s&&e.css("position")==="static"){return false}return n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return i==="fixed"||!o.length?t(this[0].ownerDocument||document):o},uniqueId:function(){var t=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++t}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){t(this).removeAttr("id")}})}});function e(e,s){var n,o,r,a=e.nodeName.toLowerCase();if("area"===a){n=e.parentNode;o=n.name;if(!e.href||!o||n.nodeName.toLowerCase()!=="map"){return false}r=t("img[usemap='#"+o+"']")[0];return!!r&&i(r)}return(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||s:s)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return t.css(this,"visibility")==="hidden"}).length}t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var s=t.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&e(i,!n)}});if(!t("<a>").outerWidth(1).jquery){t.each(["Width","Height"],function(e,i){var s=i==="Width"?["Left","Right"]:["Top","Bottom"],n=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};function r(e,i,n,o){t.each(s,function(){i-=parseFloat(t.css(e,"padding"+this))||0;if(n){i-=parseFloat(t.css(e,"border"+this+"Width"))||0}if(o){i-=parseFloat(t.css(e,"margin"+this))||0}});return i}t.fn["inner"+i]=function(e){if(e===undefined){return o["inner"+i].call(this)}return this.each(function(){t(this).css(n,r(this,e)+"px")})};t.fn["outer"+i]=function(e,s){if(typeof e!=="number"){return o["outer"+i].call(this,e)}return this.each(function(){t(this).css(n,r(this,e,true,s)+"px")})}})}if(!t.fn.addBack){t.fn.addBack=function(t){return this.add(t==null?this.prevObject:this.prevObject.filter(t))}}if(t("<a>").data("a-b","a").removeData("a-b").data("a-b")){t.fn.removeData=function(e){return function(i){if(arguments.length){return e.call(this,t.camelCase(i))}else{return e.call(this)}}}(t.fn.removeData)}t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());t.fn.extend({focus:function(e){return function(i,s){return typeof i==="number"?this.each(function(){var e=this;setTimeout(function(){t(e).focus();if(s){s.call(e)}},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(e!==undefined){return this.css("zIndex",e)}if(this.length){var i=t(this[0]),s,n;while(i.length&&i[0]!==document){s=i.css("position");if(s==="absolute"||s==="relative"||s==="fixed"){n=parseInt(i.css("zIndex"),10);if(!isNaN(n)&&n!==0){return n}}i=i.parent()}}return 0}});t.ui.plugin={add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s){o.plugins[n]=o.plugins[n]||[];o.plugins[n].push([i,s[n]])}},call:function(t,e,i,s){var n,o=t.plugins[e];if(!o){return}if(!s&&(!t.element[0].parentNode||t.element[0].parentNode.nodeType===11)){return}for(n=0;n<o.length;n++){if(t.options[o[n][0]]){o[n][1].apply(t.element,i)}}}};var s=0,n=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;(n=i[o])!=null;o++){try{s=t._data(n,"events");if(s&&s.remove){t(n).triggerHandler("remove")}}catch(r){}}e(i)}}(t.cleanData);t.widget=function(e,i,s){var n,o,r,a,l={},h=e.split(".")[0];e=e.split(".")[1];n=h+"-"+e;if(!s){s=i;i=t.Widget}t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)};t[h]=t[h]||{};o=t[h][e];r=t[h][e]=function(t,e){if(!this._createWidget){return new r(t,e)}if(arguments.length){this._createWidget(t,e)}};t.extend(r,o,{version:s.version,_proto:t.extend({},s),_childConstructors:[]});a=new i;a.options=t.widget.extend({},a.options);t.each(s,function(e,s){if(!t.isFunction(s)){l[e]=s;return}l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e=this._super,i=this._superApply,o;this._super=t;this._superApply=n;o=s.apply(this,arguments);this._super=e;this._superApply=i;return o}}()});r.prototype=t.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||e:e},l,{constructor:r,namespace:h,widgetName:e,widgetFullName:n});if(o){t.each(o._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,r,i._proto)});delete o._childConstructors}else{i._childConstructors.push(r)}t.widget.bridge(e,r);return r};t.widget.extend=function(e){var i=n.call(arguments,1),s=0,o=i.length,r,a;for(;s<o;s++){for(r in i[s]){a=i[s][r];if(i[s].hasOwnProperty(r)&&a!==undefined){if(t.isPlainObject(a)){e[r]=t.isPlainObject(e[r])?t.widget.extend({},e[r],a):t.widget.extend({},a)}else{e[r]=a}}}}return e};t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(o){var r=typeof o==="string",a=n.call(arguments,1),l=this;o=!r&&a.length?t.widget.extend.apply(null,[o].concat(a)):o;if(r){this.each(function(){var i,n=t.data(this,s);if(o==="instance"){l=n;return false}if(!n){return t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+o+"'")}if(!t.isFunction(n[o])||o.charAt(0)==="_"){return t.error("no such method '"+o+"' for "+e+" widget instance")}i=n[o].apply(n,a);if(i!==n&&i!==undefined){l=i&&i.jquery?l.pushStack(i.get()):i;return false}})}else{this.each(function(){var e=t.data(this,s);if(e){e.option(o||{});if(e._init){e._init()}}else{t.data(this,s,new i(o,this))}})}return l}};t.Widget=function(){};t.Widget._childConstructors=[];t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0];this.element=t(i);this.uuid=s++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=t();this.hoverable=t();this.focusable=t();if(i!==this){t.data(i,this.widgetFullName,this);this._on(true,this.element,{remove:function(t){if(t.target===i){this.destroy()}}});this.document=t(i.style?i.ownerDocument:i.document||i);this.window=t(this.document[0].defaultView||this.document[0].parentWindow)}this.options=t.widget.extend({},this.options,this._getCreateOptions(),e);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s=e,n,o,r;if(arguments.length===0){return t.widget.extend({},this.options)}if(typeof e==="string"){s={};n=e.split(".");e=n.shift();if(n.length){o=s[e]=t.widget.extend({},this.options[e]);for(r=0;r<n.length-1;r++){o[n[r]]=o[n[r]]||{};o=o[n[r]]}e=n.pop();if(arguments.length===1){return o[e]===undefined?null:o[e]}o[e]=i}else{if(arguments.length===1){return this.options[e]===undefined?null:this.options[e]}s[e]=i}}this._setOptions(s);return this},_setOptions:function(t){var e;for(e in t){this._setOption(e,t[e])}return this},_setOption:function(t,e){this.options[t]=e;if(t==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!e);if(e){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(e,i,s){var n,o=this;if(typeof e!=="boolean"){s=i;i=e;e=false}if(!s){s=i;i=this.element;n=this.widget()}else{i=n=t(i);this.bindings=this.bindings.add(i)}t.each(s,function(s,r){function a(){if(!e&&(o.options.disabled===true||t(this).hasClass("ui-state-disabled"))){return}return(typeof r==="string"?o[r]:r).apply(o,arguments)}if(typeof r!=="string"){a.guid=r.guid=r.guid||a.guid||t.guid++}var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];if(c){n.delegate(c,h,a)}else{i.bind(h,a)}})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.unbind(i).undelegate(i);this.bindings=t(this.bindings.not(e).get());this.focusable=t(this.focusable.not(e).get());this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return(typeof t==="string"?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,o,r=this.options[e];s=s||{};i=t.Event(i);i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();i.target=this.element[0];o=i.originalEvent;if(o){for(n in o){if(!(n in i)){i[n]=o[n]}}}this.element.trigger(i,s);return!(t.isFunction(r)&&r.apply(this.element[0],[i].concat(s))===false||i.isDefaultPrevented())}};t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){if(typeof n==="string"){n={effect:n}}var r,a=!n?e:n===true||typeof n==="number"?i:n.effect||i;n=n||{};if(typeof n==="number"){n={duration:n}}r=!t.isEmptyObject(n);n.complete=o;if(n.delay){s.delay(n.delay)}if(r&&t.effects&&t.effects.effect[a]){s[e](n)}else if(a!==e&&s[a]){s[a](n.duration,n.easing,o)}else{s.queue(function(i){t(this)[e]();if(o){o.call(s[0])}i()})}}});var o=t.widget;var r=false;t(document).mouseup(function(){r=false});var a=t.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){if(true===t.data(i.target,e.widgetName+".preventClickEvent")){t.removeData(i.target,e.widgetName+".preventClickEvent");i.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(e){if(r){return}this._mouseMoved=false;this._mouseStarted&&this._mouseUp(e);this._mouseDownEvent=e;var i=this,s=e.which===1,n=typeof this.options.cancel==="string"&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:false;if(!s||n||!this._mouseCapture(e)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==false;if(!this._mouseStarted){e.preventDefault();return true}}if(true===t.data(e.target,this.widgetName+".preventClickEvent")){t.removeData(e.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(t){return i._mouseMove(t)};this._mouseUpDelegate=function(t){return i._mouseUp(t)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();r=true;return true},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button){return this._mouseUp(e)}else if(!e.which){return this._mouseUp(e)}}if(e.which||e.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==false;this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)}return!this._mouseStarted},_mouseUp:function(e){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(e.target===this._mouseDownEvent.target){t.data(e.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(e)}r=false;return false},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}});t.widget("ui.draggable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative()}if(this.options.addClasses){this.element.addClass("ui-draggable")}if(this.options.disabled){this.element.addClass("ui-draggable-disabled")}this._setHandleClassName();this._mouseInit()},_setOption:function(t,e){this._super(t,e);if(t==="handle"){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return}this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._removeHandleClassName();this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;this._blurActiveElement(e);if(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(e);if(!this.handle){return false}this._blockFrames(i.iframeFix===true?"iframe":i.iframeFix);return true},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_blurActiveElement:function(e){var i=this.document[0];if(!this.handleElement.is(e.target)){return}try{if(i.activeElement&&i.activeElement.nodeName.toLowerCase()!=="body"){t(i.activeElement).blur()}}catch(s){}},_mouseStart:function(e){var i=this.options;this.helper=this._createHelper(e);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(t.ui.ddmanager){t.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return t(this).css("position")==="fixed"}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(e);this.originalPosition=this.position=this._generatePosition(e,false);this.originalPageX=e.pageX;this.originalPageY=e.pageY;i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt);this._setContainment();if(this._trigger("start",e)===false){this._clear();return false}this._cacheHelperProportions();if(t.ui.ddmanager&&!i.dropBehaviour){t.ui.ddmanager.prepareOffsets(this,e)}this._normalizeRightBottom();this._mouseDrag(e,true);if(t.ui.ddmanager){t.ui.ddmanager.dragStart(this,e)}return true},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(e,true);this.positionAbs=this._convertPositionTo("absolute");if(!i){var s=this._uiHash();if(this._trigger("drag",e,s)===false){this._mouseUp({});return false}this.position=s.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if(t.ui.ddmanager){t.ui.ddmanager.drag(this,e)}return false},_mouseStop:function(e){var i=this,s=false;if(t.ui.ddmanager&&!this.options.dropBehaviour){s=t.ui.ddmanager.drop(this,e)}if(this.dropped){s=this.dropped;this.dropped=false}if(this.options.revert==="invalid"&&!s||this.options.revert==="valid"&&s||this.options.revert===true||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)){t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(i._trigger("stop",e)!==false){i._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(e){this._unblockFrames();if(t.ui.ddmanager){t.ui.ddmanager.dragStop(this,e)}if(this.handleElement.is(e.target)){this.element.focus()}return t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:true},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):i.helper==="clone"?this.element.clone().removeAttr("id"):this.element;if(!n.parents("body").length){n.appendTo(i.appendTo==="parent"?this.element[0].parentNode:i.appendTo)}if(s&&n[0]===this.element[0]){this._setPositionRelative()}if(n[0]!==this.element[0]&&!/(fixed|absolute)/.test(n.css("position"))){n.css("position","absolute")}return n},_setPositionRelative:function(){if(!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative"}},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(t.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this._isRootNode(this.offsetParent[0])){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0}}var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(!e?this.scrollParent.scrollTop():0),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(!e?this.scrollParent.scrollLeft():0)}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,o=this.document[0];this.relativeContainer=null;if(!n.containment){this.containment=null;return}if(n.containment==="window"){this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment==="document"){this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment.constructor===Array){this.containment=n.containment;return}if(n.containment==="parent"){n.containment=this.helper[0].parentNode}i=t(n.containment);s=i[0];if(!s){return}e=/(scroll|auto)/.test(i.css("overflow"));this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relativeContainer=i},_convertPositionTo:function(t,e){if(!e){e=this.position}var i=t==="absolute"?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-(this.cssPosition==="fixed"?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-(this.cssPosition==="fixed"?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,o,r=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;if(!a||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}}if(e){if(this.containment){if(this.relativeContainer){s=this.relativeContainer.offset();i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]}else{i=this.containment}if(t.pageX-this.offset.click.left<i[0]){l=i[0]+this.offset.click.left}if(t.pageY-this.offset.click.top<i[1]){h=i[1]+this.offset.click.top}if(t.pageX-this.offset.click.left>i[2]){l=i[2]+this.offset.click.left}if(t.pageY-this.offset.click.top>i[3]){h=i[3]+this.offset.click.top}}if(r.grid){n=r.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY;h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-r.grid[1]:n+r.grid[1]:n;o=r.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX;l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-r.grid[0]:o+r.grid[0]:o}if(r.axis==="y"){l=this.originalPageX}if(r.axis==="x"){h=this.originalPageY}}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy()}},_normalizeRightBottom:function(){if(this.options.axis!=="y"&&this.helper.css("right")!=="auto"){this.helper.width(this.helper.width());this.helper.css("right","auto")}if(this.options.axis!=="x"&&this.helper.css("bottom")!=="auto"){this.helper.height(this.helper.height());this.helper.css("bottom","auto")}},_trigger:function(e,i,s){s=s||this._uiHash();t.ui.plugin.call(this,e,[i,s,this],true);if(/^(drag|start|stop)/.test(e)){this.positionAbs=this._convertPositionTo("absolute");s.offset=this.positionAbs}return t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[];t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");if(i&&!i.options.disabled){s.sortables.push(i);i.refreshPositions();i._trigger("activate",e,n)}})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=false;t.each(s.sortables,function(){var t=this;if(t.isOver){t.isOver=0;s.cancelHelperRemoval=true;t.cancelHelperRemoval=false;t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")};t._mouseStop(e);t.options.helper=t.options._helper}else{t.cancelHelperRemoval=true;t._trigger("deactivate",e,n)}})},drag:function(e,i,s){t.each(s.sortables,function(){var n=false,o=this;o.positionAbs=s.positionAbs;o.helperProportions=s.helperProportions;o.offset.click=s.offset.click;if(o._intersectsWith(o.containerCache)){n=true;t.each(s.sortables,function(){this.positionAbs=s.positionAbs;this.helperProportions=s.helperProportions;this.offset.click=s.offset.click;if(this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])){n=false}return n})}if(n){if(!o.isOver){o.isOver=1;o.currentItem=i.helper.appendTo(o.element).data("ui-sortable-item",true);o.options._helper=o.options.helper;o.options.helper=function(){return i.helper[0]};e.target=o.currentItem[0];o._mouseCapture(e,true);o._mouseStart(e,true,true);o.offset.click.top=s.offset.click.top;o.offset.click.left=s.offset.click.left;o.offset.parent.left-=s.offset.parent.left-o.offset.parent.left;o.offset.parent.top-=s.offset.parent.top-o.offset.parent.top;s._trigger("toSortable",e);s.dropped=o.element;t.each(s.sortables,function(){this.refreshPositions()});s.currentItem=s.element;o.fromOutside=s}if(o.currentItem){o._mouseDrag(e);i.position=o.position}}else{if(o.isOver){o.isOver=0;o.cancelHelperRemoval=true;o.options._revert=o.options.revert;o.options.revert=false;o._trigger("out",e,o._uiHash(o));o._mouseStop(e,true);o.options.revert=o.options._revert;o.options.helper=o.options._helper;if(o.placeholder){o.placeholder.remove()}s._refreshOffsets(e);i.position=s._generatePosition(e,true);s._trigger("fromSortable",e);s.dropped=false;t.each(s.sortables,function(){this.refreshPositions()})}}})}});t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),o=s.options;if(n.css("cursor")){o._cursor=n.css("cursor")}n.css("cursor",o.cursor)},stop:function(e,i,s){var n=s.options;if(n._cursor){t("body").css("cursor",n._cursor)}}});t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),o=s.options;if(n.css("opacity")){o._opacity=n.css("opacity")}n.css("opacity",o.opacity)},stop:function(e,i,s){var n=s.options;if(n._opacity){t(i.helper).css("opacity",n._opacity)}}});t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false)}if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset()}},drag:function(e,i,s){var n=s.options,o=false,r=s.scrollParentNotHidden[0],a=s.document[0];if(r!==a&&r.tagName!=="HTML"){if(!n.axis||n.axis!=="x"){if(s.overflowOffset.top+r.offsetHeight-e.pageY<n.scrollSensitivity){r.scrollTop=o=r.scrollTop+n.scrollSpeed}else if(e.pageY-s.overflowOffset.top<n.scrollSensitivity){r.scrollTop=o=r.scrollTop-n.scrollSpeed}}if(!n.axis||n.axis!=="y"){if(s.overflowOffset.left+r.offsetWidth-e.pageX<n.scrollSensitivity){r.scrollLeft=o=r.scrollLeft+n.scrollSpeed}else if(e.pageX-s.overflowOffset.left<n.scrollSensitivity){r.scrollLeft=o=r.scrollLeft-n.scrollSpeed}}}else{if(!n.axis||n.axis!=="x"){if(e.pageY-t(a).scrollTop()<n.scrollSensitivity){o=t(a).scrollTop(t(a).scrollTop()-n.scrollSpeed)}else if(t(window).height()-(e.pageY-t(a).scrollTop())<n.scrollSensitivity){o=t(a).scrollTop(t(a).scrollTop()+n.scrollSpeed)}}if(!n.axis||n.axis!=="y"){if(e.pageX-t(a).scrollLeft()<n.scrollSensitivity){o=t(a).scrollLeft(t(a).scrollLeft()-n.scrollSpeed)}else if(t(window).width()-(e.pageX-t(a).scrollLeft())<n.scrollSensitivity){o=t(a).scrollLeft(t(a).scrollLeft()+n.scrollSpeed)}}}if(o!==false&&t.ui.ddmanager&&!n.dropBehaviour){t.ui.ddmanager.prepareOffsets(s,e)}}});t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[];t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();if(this!==s.element[0]){s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})}})},drag:function(e,i,s){var n,o,r,a,l,h,c,d,f,p,u=s.options,m=u.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,b=i.offset.top,_=b+s.helperProportions.height;for(f=s.snapElements.length-1;f>=0;f--){l=s.snapElements[f].left-s.margins.left;h=l+s.snapElements[f].width;c=s.snapElements[f].top-s.margins.top;d=c+s.snapElements[f].height;if(v<l-m||g>h+m||_<c-m||b>d+m||!t.contains(s.snapElements[f].item.ownerDocument,s.snapElements[f].item)){if(s.snapElements[f].snapping){s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[f].item}))}s.snapElements[f].snapping=false;continue}if(u.snapMode!=="inner"){n=Math.abs(c-_)<=m;o=Math.abs(d-b)<=m;r=Math.abs(l-v)<=m;a=Math.abs(h-g)<=m;if(n){i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top}if(o){i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top}if(r){i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left}if(a){i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left}}p=n||o||r||a;if(u.snapMode!=="outer"){n=Math.abs(c-b)<=m;o=Math.abs(d-_)<=m;r=Math.abs(l-g)<=m;a=Math.abs(h-v)<=m;if(n){i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top}if(o){i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top}if(r){i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left}if(a){i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left}}if(!s.snapElements[f].snapping&&(n||o||r||a||p)){s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{
snapItem:s.snapElements[f].item}))}s.snapElements[f].snapping=n||o||r||a||p}}});t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,o=s.options,r=t.makeArray(t(o.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});if(!r.length){return}n=parseInt(t(r[0]).css("zIndex"),10)||0;t(r).each(function(e){t(this).css("zIndex",n+e)});this.css("zIndex",n+r.length)}});t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),o=s.options;if(n.css("zIndex")){o._zIndex=n.css("zIndex")}n.css("zIndex",o.zIndex)},stop:function(e,i,s){var n=s.options;if(n._zIndex){t(i.helper).css("zIndex",n._zIndex)}}});var l=t.ui.draggable;t.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=false;this.isout=true;this.accept=t.isFunction(s)?s:function(t){return t.is(s)};this.proportions=function(){if(arguments.length){e=arguments[0]}else{return e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(i.scope);i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[];t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){var e=0;for(;e<t.length;e++){if(t[e]===this){t.splice(e,1)}}},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if(e==="accept"){this.accept=t.isFunction(i)?i:function(t){return t.is(i)}}else if(e==="scope"){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s);this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(i){this._trigger("activate",e,this.ui(i))}},_deactivate:function(e){var i=t.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(i){this._trigger("deactivate",e,this.ui(i))}},_over:function(e){var i=t.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],i.currentItem||i.element)){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",e,this.ui(i))}},_out:function(e){var i=t.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],i.currentItem||i.element)){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",e,this.ui(i))}},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=false;if(!s||(s.currentItem||s.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");if(i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&t.ui.intersect(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)){n=true;return false}});if(n){return false}if(this.accept.call(this.element[0],s.currentItem||s.element)){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",e,this.ui(s));return this.element}return false},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}});t.ui.intersect=function(){function t(t,e,i){return t>=e&&t<e+i}return function(e,i,s,n){if(!i.offset){return false}var o=(e.positionAbs||e.position.absolute).left+e.margins.left,r=(e.positionAbs||e.position.absolute).top+e.margins.top,a=o+e.helperProportions.width,l=r+e.helperProportions.height,h=i.offset.left,c=i.offset.top,d=h+i.proportions().width,f=c+i.proportions().height;switch(s){case"fit":return h<=o&&a<=d&&c<=r&&l<=f;case"intersect":return h<o+e.helperProportions.width/2&&a-e.helperProportions.width/2<d&&c<r+e.helperProportions.height/2&&l-e.helperProportions.height/2<f;case"pointer":return t(n.pageY,c,i.proportions().height)&&t(n.pageX,h,i.proportions().width);case"touch":return(r>=c&&r<=f||l>=c&&l<=f||r<c&&l>f)&&(o>=h&&o<=d||a>=h&&a<=d||o<h&&a>d);default:return false}}}();t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,o=t.ui.ddmanager.droppables[e.options.scope]||[],r=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;s<o.length;s++){if(o[s].options.disabled||e&&!o[s].accept.call(o[s].element[0],e.currentItem||e.element)){continue}for(n=0;n<a.length;n++){if(a[n]===o[s].element[0]){o[s].proportions().height=0;continue t}}o[s].visible=o[s].element.css("display")!=="none";if(!o[s].visible){continue}if(r==="mousedown"){o[s]._activate.call(o[s],i)}o[s].offset=o[s].element.offset();o[s].proportions({width:o[s].element[0].offsetWidth,height:o[s].element[0].offsetHeight})}},drop:function(e,i){var s=false;t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)){s=this._drop.call(this,i)||s}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)){this.isout=true;this.isover=false;this._deactivate.call(this,i)}});return s},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){if(!e.options.refreshPositions){t.ui.ddmanager.prepareOffsets(e,i)}})},drag:function(e,i){if(e.options.refreshPositions){t.ui.ddmanager.prepareOffsets(e,i)}t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var s,n,o,r=t.ui.intersect(e,this,this.options.tolerance,i),a=!r&&this.isover?"isout":r&&!this.isover?"isover":null;if(!a){return}if(this.options.greedy){n=this.options.scope;o=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n});if(o.length){s=t(o[0]).droppable("instance");s.greedyChild=a==="isover"}}if(s&&a==="isover"){s.isover=false;s.isout=true;s._out.call(s,i)}this[a]=true;this[a==="isout"?"isover":"isout"]=false;this[a==="isover"?"_over":"_out"].call(this,i);if(s&&a==="isout"){s.isout=false;s.isover=true;s._over.call(s,i)}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable");if(!e.options.refreshPositions){t.ui.ddmanager.prepareOffsets(e,i)}}};var h=t.ui.droppable;var c=t.widget("ui.sortable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){var t=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?t.axis==="x"||this._isFloating(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true},_setOption:function(t,e){this._super(t,e);if(t==="handle"){this._setHandleClassName()}},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--){this.items[t].item.removeData(this.widgetName+"-item")}return this},_mouseCapture:function(e,i){var s=null,n=false,o=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(e);t(e.target).parents().each(function(){if(t.data(this,o.widgetName+"-item")===o){s=t(this);return false}});if(t.data(e.target,o.widgetName+"-item")===o){s=t(e.target)}if(!s){return false}if(this.options.handle&&!i){t(this.options.handle,s).find("*").addBack().each(function(){if(this===e.target){n=true}});if(!n){return false}}this.currentItem=s;this._removeCurrentsFromItems();return true},_mouseStart:function(e,i,s){var n,o,r=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(e);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(e);this.originalPageX=e.pageX;this.originalPageY=e.pageY;r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(r.containment){this._setContainment()}if(r.cursor&&r.cursor!=="auto"){o=this.document.find("body");this.storedCursor=o.css("cursor");o.css("cursor",r.cursor);this.storedStylesheet=t("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(o)}if(r.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",r.opacity)}if(r.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",r.zIndex)}if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",e,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!s){for(n=this.containers.length-1;n>=0;n--){this.containers[n]._trigger("activate",e,this._uiHash(this))}}if(t.ui.ddmanager){t.ui.ddmanager.current=this}if(t.ui.ddmanager&&!r.dropBehaviour){t.ui.ddmanager.prepareOffsets(this,e)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(e);return true},_mouseDrag:function(e){var i,s,n,o,r=this.options,a=false;this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<r.scrollSensitivity){this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+r.scrollSpeed}else if(e.pageY-this.overflowOffset.top<r.scrollSensitivity){this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-r.scrollSpeed}if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<r.scrollSensitivity){this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+r.scrollSpeed}else if(e.pageX-this.overflowOffset.left<r.scrollSensitivity){this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-r.scrollSpeed}}else{if(e.pageY-t(document).scrollTop()<r.scrollSensitivity){a=t(document).scrollTop(t(document).scrollTop()-r.scrollSpeed)}else if(t(window).height()-(e.pageY-t(document).scrollTop())<r.scrollSensitivity){a=t(document).scrollTop(t(document).scrollTop()+r.scrollSpeed)}if(e.pageX-t(document).scrollLeft()<r.scrollSensitivity){a=t(document).scrollLeft(t(document).scrollLeft()-r.scrollSpeed)}else if(t(window).width()-(e.pageX-t(document).scrollLeft())<r.scrollSensitivity){a=t(document).scrollLeft(t(document).scrollLeft()+r.scrollSpeed)}}if(a!==false&&t.ui.ddmanager&&!r.dropBehaviour){t.ui.ddmanager.prepareOffsets(this,e)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(i=this.items.length-1;i>=0;i--){s=this.items[i];n=s.item[0];o=this._intersectsWithPointer(s);if(!o){continue}if(s.instance!==this.currentContainer){continue}if(n!==this.currentItem[0]&&this.placeholder[o===1?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&(this.options.type==="semi-dynamic"?!t.contains(this.element[0],n):true)){this.direction=o===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(s)){this._rearrange(e,s)}else{break}this._trigger("change",e,this._uiHash());break}}this._contactContainers(e);if(t.ui.ddmanager){t.ui.ddmanager.drag(this,e)}this._trigger("sort",e,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,i){if(!e){return}if(t.ui.ddmanager&&!this.options.dropBehaviour){t.ui.ddmanager.drop(this,e)}if(this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,r={};if(!o||o==="x"){r.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)}if(!o||o==="y"){r.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)}this.reverting=true;t(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else{this._clear(e,i)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,this._uiHash(this));if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",null,this._uiHash(this));this.containers[e].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}t.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){t(this.domPosition.prev).after(this.currentItem)}else{t(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];e=e||{};t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);if(i){s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}});if(!s.length&&e.key){s.push(e.key+"=")}return s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];e=e||{};i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")});return s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,r=o+t.width,a=t.top,l=a+t.height,h=this.offset.click.top,c=this.offset.click.left,d=this.options.axis==="x"||s+h>a&&s+h<l,f=this.options.axis==="y"||e+c>o&&e+c<r,p=d&&f;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]){return p}else{return o<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<r&&a<s+this.helperProportions.height/2&&n-this.helperProportions.height/2<l}},_intersectsWithPointer:function(t){var e=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),s=e&&i,n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();if(!s){return false}return this.floating?o&&o==="right"||n==="down"?2:1:n&&(n==="down"?2:1)},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();if(this.floating&&n){return n==="right"&&i||n==="left"&&!i}else{return s&&(s==="down"&&e||s==="up"&&!e)}},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return t!==0&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return t!==0&&(t>0?"right":"left")},refresh:function(t){this._refreshItems(t);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,s,n,o,r=[],a=[],l=this._connectWith();if(l&&e){for(i=l.length-1;i>=0;i--){n=t(l[i]);for(s=n.length-1;s>=0;s--){o=t.data(n[s],this.widgetFullName);if(o&&o!==this&&!o.options.disabled){a.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o])}}}}a.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function h(){r.push(this)}for(i=a.length-1;i>=0;i--){a[i][0].each(h)}return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++){if(e[i]===t.item[0]){return false}}return true})},_refreshItems:function(e){this.items=[];this.containers=[this];var i,s,n,o,r,a,l,h,c=this.items,d=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready){for(i=f.length-1;i>=0;i--){n=t(f[i]);for(s=n.length-1;s>=0;s--){o=t.data(n[s],this.widgetFullName);if(o&&o!==this&&!o.options.disabled){d.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]);this.containers.push(o)}}}}for(i=d.length-1;i>=0;i--){r=d[i][1];a=d[i][0];for(s=0,h=a.length;s<h;s++){l=t(a[s]);l.data(this.widgetName+"-item",r);c.push({item:l,instance:r,width:0,height:0,left:0,top:0})}}},refreshPositions:function(e){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var i,s,n,o;for(i=this.items.length-1;i>=0;i--){s=this.items[i];if(s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]){continue}n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item;if(!e){s.width=n.outerWidth();s.height=n.outerHeight()}o=n.offset();s.left=o.left;s.top=o.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(i=this.containers.length-1;i>=0;i--){o=this.containers[i].element.offset();this.containers[i].containerCache.left=o.left;this.containers[i].containerCache.top=o.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}}return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;if(!s.placeholder||s.placeholder.constructor===String){i=s.placeholder;s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(s==="tr"){e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)})}else if(s==="img"){n.attr("src",e.currentItem.attr("src"))}if(!i){n.css("visibility","hidden")}return n},update:function(t,n){if(i&&!s.forcePlaceholderSize){return}if(!n.height()){n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10))}if(!n.width()){n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}}e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem));e.currentItem.after(e.placeholder);s.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var i,s,n,o,r,a,l,h,c,d,f=null,p=null;for(i=this.containers.length-1;i>=0;i--){if(t.contains(this.currentItem[0],this.containers[i].element[0])){continue}if(this._intersectsWith(this.containers[i].containerCache)){if(f&&t.contains(this.containers[i].element[0],f.element[0])){continue}f=this.containers[i];p=i}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",e,this._uiHash(this));this.containers[i].containerCache.over=0}}}if(!f){return}if(this.containers.length===1){if(!this.containers[p].containerCache.over){this.containers[p]._trigger("over",e,this._uiHash(this));this.containers[p].containerCache.over=1}}else{n=1e4;o=null;c=f.floating||this._isFloating(this.currentItem);r=c?"left":"top";a=c?"width":"height";d=c?"clientX":"clientY";for(s=this.items.length-1;s>=0;s--){if(!t.contains(this.containers[p].element[0],this.items[s].item[0])){continue}if(this.items[s].item[0]===this.currentItem[0]){continue}l=this.items[s].item.offset()[r];h=false;if(e[d]-l>this.items[s][a]/2){h=true}if(Math.abs(e[d]-l)<n){n=Math.abs(e[d]-l);o=this.items[s];this.direction=h?"up":"down"}}if(!o&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[p]){if(!this.currentContainer.containerCache.over){this.containers[p]._trigger("over",e,this._uiHash());this.currentContainer.containerCache.over=1}return}o?this._rearrange(e,o,null,true):this._rearrange(e,null,this.containers[p].element,true);this._trigger("change",e,this._uiHash());this.containers[p]._trigger("change",e,this._uiHash(this));this.currentContainer=this.containers[p];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[p]._trigger("over",e,this._uiHash(this));this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):i.helper==="clone"?this.currentItem.clone():this.currentItem;if(!s.parents("body").length){t(i.appendTo!=="parent"?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0])}if(s[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!s[0].style.width||i.forceHelperSize){s.width(this.currentItem.width())}if(!s[0].style.height||i.forceHelperSize){s.height(this.currentItem.height())}return s},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(t.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&t.ui.ie){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;if(n.containment==="parent"){n.containment=this.helper[0].parentNode}if(n.containment==="document"||n.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t(n.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(t(n.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(n.containment)){e=t(n.containment)[0];i=t(n.containment).offset();s=t(e).css("overflow")!=="hidden";this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,i){if(!i){i=this.position}var s=e==="absolute"?1:-1,n=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,r=e.pageY,a=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=/(html|body)/i.test(a[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(e.pageX-this.offset.click.left<this.containment[0]){o=this.containment[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<this.containment[1]){r=this.containment[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>this.containment[2]){o=this.containment[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>this.containment[3]){r=this.containment[3]+this.offset.click.top}}if(n.grid){i=this.originalPageY+Math.round((r-this.originalPageY)/n.grid[1])*n.grid[1];r=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i;s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0];o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s}}return{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?e.item[0]:e.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){if(n===this.counter){this.refreshPositions(!s)}})},_clear:function(t,e){this.reverting=false;var i,s=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!e){s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!e){s.push(function(t){this._trigger("update",t,this._uiHash())})}if(this!==this.currentContainer){if(!e){s.push(function(t){this._trigger("remove",t,this._uiHash())});s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer));s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))}}function n(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}for(i=this.containers.length-1;i>=0;i--){if(!e){s.push(n("deactivate",this,this.containers[i]))}if(this.containers[i].containerCache.over){s.push(n("out",this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(!e){this._trigger("beforeStop",t,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null}if(!e){for(i=0;i<s.length;i++){s[i].call(this,t)}this._trigger("stop",t,this._uiHash())}this.fromOutside=false;return!this.cancelHelperRemoval},_trigger:function(){if(t.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})});(function(t){var e,s,n,o,r,a,l,h,c,d,f;s=!!document.createElement("canvas").getContext;e=function(){var t=document.createElement("div");t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var e=t.firstChild;e.style.behavior="url(#default#VML)";return e?typeof e.adj=="object":true}();if(!(s||e)){t.fn.maphilight=function(){return this};return}if(s){
h=function(t){return Math.max(0,Math.min(parseInt(t,16),255))};c=function(t,e){return"rgba("+h(t.substr(0,2))+","+h(t.substr(2,2))+","+h(t.substr(4,2))+","+e+")"};n=function(e){var i=t('<canvas style="width:'+t(e).width()+"px;height:"+t(e).height()+'px;"></canvas>').get(0);i.getContext("2d").clearRect(0,0,t(e).width(),t(e).height());return i};var p=function(t,e,s,n,o){n=n||0;o=o||0;t.beginPath();if(e=="rect"){t.rect(s[0]+n,s[1]+o,s[2]-s[0],s[3]-s[1])}else if(e=="poly"){t.moveTo(s[0]+n,s[1]+o);for(i=2;i<s.length;i+=2){t.lineTo(s[i]+n,s[i+1]+o)}}else if(e=="circ"){t.arc(s[0]+n,s[1]+o,s[2],0,Math.PI*2,false)}t.closePath()};o=function(e,i,s,n,o){var r,a=e.getContext("2d");if(n.shadow){a.save();if(n.shadowPosition=="inside"){p(a,i,s);a.clip()}var l=e.width*100;var h=e.height*100;p(a,i,s,l,h);a.shadowOffsetX=n.shadowX-l;a.shadowOffsetY=n.shadowY-h;a.shadowBlur=n.shadowRadius;a.shadowColor=c(n.shadowColor,n.shadowOpacity);var d=n.shadowFrom;if(!d){if(n.shadowPosition=="outside"){d="fill"}else{d="stroke"}}if(d=="stroke"){a.strokeStyle="rgba(0,0,0,1)";a.stroke()}else if(d=="fill"){a.fillStyle="rgba(0,0,0,1)";a.fill()}a.restore();if(n.shadowPosition=="outside"){a.save();p(a,i,s);a.globalCompositeOperation="destination-out";a.fillStyle="rgba(0,0,0,1);";a.fill();a.restore()}}a.save();p(a,i,s);if(n.fill){a.fillStyle=c(n.fillColor,n.fillOpacity);a.fill()}if(n.stroke){a.strokeStyle=c(n.strokeColor,n.strokeOpacity);a.lineWidth=n.strokeWidth;a.stroke()}a.restore();if(n.fade){t(e).css("opacity",0).animate({opacity:1},100)}};r=function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}}else{n=function(e){return t('<var style="zoom:1;overflow:hidden;display:block;width:'+e.width+"px;height:"+e.height+'px;"></var>').get(0)};o=function(e,i,s,n,o){var r,a,l,h;for(var c in s){s[c]=parseInt(s[c],10)}r='<v:fill color="#'+n.fillColor+'" opacity="'+(n.fill?n.fillOpacity:0)+'" />';a=n.stroke?'strokeweight="'+n.strokeWidth+'" stroked="t" strokecolor="#'+n.strokeColor+'"':'stroked="f"';l='<v:stroke opacity="'+n.strokeOpacity+'"/>';if(i=="rect"){h=t('<v:rect name="'+o+'" filled="t" '+a+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+s[0]+"px;top:"+s[1]+"px;width:"+(s[2]-s[0])+"px;height:"+(s[3]-s[1])+'px;"></v:rect>')}else if(i=="poly"){h=t('<v:shape name="'+o+'" filled="t" '+a+' coordorigin="0,0" coordsize="'+e.width+","+e.height+'" path="m '+s[0]+","+s[1]+" l "+s.join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+e.width+"px;height:"+e.height+'px;"></v:shape>')}else if(i=="circ"){h=t('<v:oval name="'+o+'" filled="t" '+a+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(s[0]-s[2])+"px;top:"+(s[1]-s[2])+"px;width:"+s[2]*2+"px;height:"+s[2]*2+'px;"></v:oval>')}h.get(0).innerHTML=r+l;t(e).append(h)};r=function(e){var i=t("<div>"+e.innerHTML+"</div>");i.children("[name=highlighted]").remove();e.innerHTML=i.html()}}a=function(t){var e,i=t.getAttribute("coords").split(",");for(e=0;e<i.length;e++){i[e]=parseFloat(i[e])}return[t.getAttribute("shape").toLowerCase().substr(0,4),i]};f=function(e,i){var s=t(e);return t.extend({},i,t.metadata?s.metadata():false,s.data("maphilight"))};d=function(t){if(!t.complete){return false}if(typeof t.naturalWidth!="undefined"&&t.naturalWidth===0){return false}return true};l={position:"absolute",left:0,top:0,padding:0,border:0};var u=false;t.fn.maphilight=function(i){i=t.extend({},t.fn.maphilight.defaults,i);if(!s&&!u){t(window).ready(function(){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var e=document.createStyleSheet();var i=["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"];t.each(i,function(){e.addRule("v\\:"+this,"behavior: url(#default#VML); antialias:true")})});u=true}return this.each(function(){var h,c,p,u,m,g,v,b;h=t(this);if(!d(this)){return window.setTimeout(function(){h.maphilight(i)},200)}p=t.extend({},i,t.metadata?h.metadata():false,h.data("maphilight"));b=h.get(0).getAttribute("usemap");if(!b){return}u=t('map[name="'+b.substr(1)+'"]');if(!(h.is('img,input[type="image"]')&&b&&u.size()>0)){return}if(h.hasClass("maphilighted")){var _=h.parent();h.insertBefore(_);_.remove();t(u).unbind(".maphilight")}c=t("<div></div>").css({display:"block",backgroundImage:'url("'+this.src+'")',backgroundSize:"contain",position:"relative",padding:0,width:this.width,height:this.height});if(p.wrapClass){if(p.wrapClass===true){c.addClass(t(this).attr("class"))}else{c.addClass(p.wrapClass)}}h.before(c).css("opacity",0).css(l).remove();if(e){h.css("filter","Alpha(opacity=0)")}c.append(h);m=n(this);t(m).css(l);m.height=this.height;m.width=this.width;t(u).bind("alwaysOn.maphilight",function(){if(g){r(g)}if(!s){t(m).empty()}t(u).find("area[coords]").each(function(){var e,i;i=f(this,p);if(i.alwaysOn){if(!g&&s){g=n(h[0]);t(g).css(l);g.width=h[0].width;g.height=h[0].height;h.before(g)}i.fade=i.alwaysOnFade;e=a(this);if(s){o(g,e[0],e[1],i,"")}else{o(m,e[0],e[1],i,"")}}})}).trigger("alwaysOn.maphilight").bind("mouseover.maphilight, focus.maphilight",function(e){var i,n,r=e.target;n=f(r,p);if(!n.neverOn&&!n.alwaysOn){i=a(r);o(m,i[0],i[1],n,"highlighted");if(n.groupBy){var l;if(/^[a-zA-Z][\-a-zA-Z]+$/.test(n.groupBy)){l=u.find("area["+n.groupBy+'="'+t(r).attr(n.groupBy)+'"]')}else{l=u.find(n.groupBy)}var h=r;l.each(function(){if(this!=h){var t=f(this,p);if(!t.neverOn&&!t.alwaysOn){var e=a(this);o(m,e[0],e[1],t,"highlighted")}}})}if(!s){t(m).append("<v:rect></v:rect>")}}}).bind("mouseout.maphilight, blur.maphilight",function(t){r(m)});h.before(m);h.addClass("maphilighted")})};t.fn.maphilight.defaults={fill:true,fillColor:"000000",fillOpacity:.2,stroke:true,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,fade:true,alwaysOn:false,neverOn:false,groupBy:false,wrapClass:true,shadow:false,shadowX:0,shadowY:0,shadowRadius:6,shadowColor:"000000",shadowOpacity:.8,shadowPosition:"outside",shadowFrom:false}})(jQuery);var rpnblackboxmodule=function(){var t;var e;var i;var s;var n;var o=function(s,o,a){_.defaults(s,{operation:"x1",left:[1],right:[1],shuffle:false,validation:{mode:"lock",type:"integer"}});t=s;e=a;i=s.shuffle;if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){n=o}else{n=[];_.each(t.right,function(t,e){n.push({position:"right",originalposition:e,value:t,response:null})});_.each(t.left,function(t,e){n.push({position:"left",originalposition:e,value:t,response:null})});if(i)n=_.shuffle(n)}r()};var r=function(){e.addClass("blackbox,text-center");e.append($('<div class="row header"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><p class="text-center">x</p></div><div class="col-xs-2 operation"></div><div class="col-xs-2"><p class="text-center">y</p></div></div>'));$(".header",e).hide();_.each(n,function(i,s){if(i.position=="left"){e.append($('<div class="row"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><p class="text-center">'+i.value+'</p></div><div class="col-xs-2 operation"><p class="text-center"><i class="glyphicon glyphicon-minus"></i>'+t.operation+'<i class="glyphicon glyphicon-arrow-right"></i></p></div><div class="col-xs-2"><input type="text" data-bind="" class="rpnm_input form-control" style="text-align: center;"></div></div>'))}else{e.append($('<div class="row"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><input type="text" class="rpnm_input form-control" style="text-align: center;"></div><div class="col-xs-2 operation"><p class="text-center"><i class="glyphicon glyphicon-minus"></i>'+t.operation+'<i class="glyphicon glyphicon-arrow-right"></i></p></div><div class="col-xs-2"><p class="text-center">'+i.value+"</p></div></div>"))}});$.each($(".rpnm_input",e),function(t,e){$(e).val(n[t].response)});s=$("<button>",{"data-toggle":"button","class":"btn btn-link btn-xs",text:" "+rpnsequence.getLabels().BlackboxTableView}).prepend($('<i class="glyphicon glyphicon-resize-small"></i>'));e.append($('<p class="text-center"></p>').append(s));l()};var a=function(){$(".operation",e).slideToggle();$(".header",e).slideToggle()};var l=function(){s.click(function(){var t=$(this),e=this.lastChild;t.find("i").toggleClass("glyphicon-resize-small glyphicon-resize-full");e.nodeValue=" ";e.nodeValue=" "+(t.hasClass("showArchieved")?rpnsequence.getLabels().BlackboxTableView:rpnsequence.getLabels().BlackboxView);t.toggleClass("showArchieved");a()});rpnsequence.addvalidation($(".rpnm_input",e),t.validation)};var h=function(){$.each($(".rpnm_input",e),function(t,e){n[t].response=$(e).val()});return n};var c=function(t){var e=0;_.each(t.right,function(t,i){e+=_.findWhere(n,{position:"right",originalposition:i}).response==t?1:0});_.each(t.left,function(t,i){e+=_.findWhere(n,{position:"left",originalposition:i}).response==t?1:0});return e};return{init:o,validate:h,score:c}};var rpncardmazemodule=function(){var t;var e;var i;var s;var n;var o;var r;var a;var l;var h=function(i,r,a){_.defaults(i,{mazewidth:6,mazeheight:4,cards:[{label:"label",clue:"clue"}]});t=i;s=t.mazeheight;n=t.mazewidth;e=a;l=[];o=[];if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){l=r}c()};var c=function(){e.addClass("cardmaze");e.append($('<div class="row"><div class="container maze"></div></div>'));_.each(t.cards,function(t,s){$(".maze",e).append($('<div class="col-xs-2 nopadding"></div>').append($('<div class="card'+(t.start?" start selectable":"")+(t.end?" end":"")+'"><p>'+t.label+"</p><p>"+t.clue+"</p></div>").data("cardId",s)));if(t.start){i=s;r=s}if(t.end){a=s}});d();_.each(l,function(t,e){$($(".card")[t]).trigger("click")})};var d=function(){_.each($(".card"),function(t,e){$(t).click(function(){if($(t).hasClass("start")||$(t).hasClass("selectable")||$(t).hasClass("selected")){if((e==i&&$(t).hasClass("start")||e==i+n||e==i-n||e==i-1||e==i+1)&&!$(t).hasClass("selected")){o.push(t)}else if($(t).hasClass("selected")){o=o.slice(0,_.indexOf(o,t)+1)}i=e;$(".selected").removeClass("selected");$(".selectable").removeClass("selectable");$(".card").removeClass("fromtop frombottom fromleft fromright totop tobottom toleft toright");_.each(o,function(t,e){if(e>0){var i=$(t).data("cardId")-$(o[e-1]).data("cardId");if(i==n){$(t).addClass("fromtop")}else if(i==-n){$(t).addClass("frombottom")}else if(i==1){$(t).addClass("fromleft")}else if(i==-1){$(t).addClass("fromright")}}if(e<o.length-1){var i=$(t).data("cardId")-$(o[e+1]).data("cardId");if(i==-n){$(t).addClass("tobottom")}else if(i==n){$(t).addClass("totop")}else if(i==-1){$(t).addClass("toright")}else if(i==1){$(t).addClass("toleft")}}$(t).addClass("selected")});if(e!=a){if(!(e+n>n*s)){$($(".card")[e+n]).addClass("selectable")}if(!(e-n<0)){$($(".card")[e-n]).addClass("selectable")}if(e%n!=0){$($(".card")[e-1]).addClass("selectable")}if((e+1)%n!=0){$($(".card")[e+1]).addClass("selectable")}}}})})};var f=function(){_.each(o,function(t,e){l[e]=$(t).data("cardId")});return l};var p=function(t){var e=0;_.each(t,function(t,i){e+=l[i]==t?1:0});return e};return{init:h,validate:f,score:p}};var rpnclockmodule=function(){var t;var e;var i;var s;var n=function(i,n,r){_.defaults(i,{random:true,hour:"10:10"});t=i;if(t.random){t.hour=Math.floor(Math.random()*24+1)+":"+Math.floor(Math.random()*59)}if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){s=n}else{s=t.hour}e=r;o()};var o=function(){e.addClass("clock");e.append($('<div id="rpnclock"></div>'));i=EduClock();i.init({hour:parseInt(s.split(":")[0]),minute:parseInt(s.split(":")[1])},$("#rpnclock"));r()};var r=function(){};var a=function(){var t=i.getCurrentTime();return t.hour+":"+t.minute};var l=function(t){return s==t?1:0};return{init:n,validate:a,score:l}};var EduClock=function(){var t;var e;var i;var s;var n;var o=false;var r;var a;var l;var h;var c;var d;var f;var p;var u;var m;var g;var v;var b=function(i,s){_.defaults(i,{margin:10,marginnumbers:-30,fontheight:15,hour:10,minute:10});e=i;v=e.hour>12;t=s;u="nothing";y()};var y=function(){i=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 0;"});s=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 1;"});n=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 2;"});t.append([i,s,n]);i=i[0];s=s[0];n=n[0];r=Math.min(t.width(),t.height());i.width=r;i.height=r;s.width=r;s.height=r;n.width=r;n.height=r;c=r/2-e.margin;d=c+e.marginnumbers;a=i.getContext("2d");l=s.getContext("2d");h=n.getContext("2d");h.translate(r/2,r/2);f=e.hour;p=e.minute;w();C();S()};var w=function(){l.save();l.font="15px Arial";l.lineWidth=3;l.beginPath();l.arc(r/2,r/2,r/2-e.margin,0,Math.PI*2,true);l.stroke();l.beginPath();l.arc(r/2,r/2,10,0,Math.PI*2,true);l.fill();l.fillStyle="#fff";l.beginPath();l.arc(r/2,r/2+c/2,c/4,0,Math.PI*2,true);l.fill();l.fillStyle="#000";var t=[1,2,3,4,5,6,7,8,9,10,11,12];var i=0;var n=0;l.font=e.fontheight+"px Arial";$.each(t,function(t,o){i=Math.PI/6*(o-3);n=l.measureText(o).width;l.fillText(o,s.width/2+Math.cos(i)*d-n/2,s.height/2+Math.sin(i)*d+e.fontheight/3)});l.translate(r/2,r/2);i=Math.PI/30;for(var o=1;o<=60;o++){var a=o%5==0;l.rotate(i);var h=a?8:2;var f=a?15:8;l.fillRect(c-f,-h/2,f,h)}l.translate(-r/2,-r/2);l.restore()};var C=function(){h.save();h.clearRect(-r/2,-r/2,r,r);m=(f*60+p)*.5%360*Math.PI/180-Math.PI/2;if(m<0){m+=2*Math.PI}g=p*6%360*Math.PI/180-Math.PI/2;if(g<0){g+=2*Math.PI}h.rotate(m);h.fillStyle="#000";h.fillRect(5,-4,c*.6,8);h.rotate(-m);h.fillStyle="#f00";h.rotate(g);h.fillRect(5,-2,c*.85,4);h.rotate(-g);h.restore();x()};var x=function(){var t=T();var e=t.hour*60+t.minute;var i=0;if(e>960&&e<1200){i=(1200-e)/2.4}if(e>240&&e<480){i=Math.abs((e-480)/2.4);i=100-i}if(e>=480&&e<=960){i=100}var s=P(new Color("ffffff"),new Color("428bca"),i);a.fillStyle=s.toRGB();a.fillRect(0,0,r,r)};var P=function(t,e,i){var s=i/100;var n=s*2-1;var o=t.toHSL().a-e.toHSL().a;var r=((n*o==-1?n:(n+o)/(1+n*o))+1)/2;var a=1-r;var l=[t.rgb[0]*r+e.rgb[0]*a,t.rgb[1]*r+e.rgb[1]*a,t.rgb[2]*r+e.rgb[2]*a];var h=t.alpha*s+e.alpha*(1-s);return new Color(l,h)};var k=function(t,e){var i=Math.atan2(e-r/2,t-r/2);if(i<0){i=i+2*Math.PI}return i};var I=function(t,i){u="nothing";var s=k(t,i);var n=Math.sqrt(Math.pow(i-r/2,2)+Math.pow(t-r/2,2));if(n<=r/2-e.margin){if(s>g-Math.PI/12&&s<g+Math.PI/12){u="minutes"}else if(s>m-Math.PI/6&&s<m+Math.PI/6){u="hours"}else{u="nothing"}}};var M=function(t,i){var s=Math.sqrt(Math.pow(i-r/2,2)+Math.pow(t-r/2,2));if(s<=r/2-e.margin){var n=k(t,i);n=n+Math.PI/2;if(n>2*Math.PI){n=n-2*Math.PI}if(u=="minutes"){var o=p;p=Math.round(30/Math.PI*n);if(p>=60){p=0}if(p<=15&&o>=45){f++}else if(p>=45&&o<=15){f--}if(f>11){console.log("currentHours:"+f+", PM:"+v);v=!v;f=0}else if(f<0){console.log("currentHours:"+f+", PM:"+v);v=!v;f=11}}else if(u=="hours"){var a=f;var l=Math.round(360/Math.PI*n);p=l%60;var h=Math.floor((l-p)/60);if(h==12){h=0}if(a<=11&&a>=9&&h>=0&&h<=3||a>=0&&a<=3&&h>=9&&h<=11){v=!v}f=h}C()}};var S=function(){$(n).on("mousedown",function(t){I(t.offsetX,t.offsetY);if(u!="nothing"){o=true}});$(n).on("mouseup",function(){o=false});$(n).on("mouseout",function(){o=false});$(n).on("mousemove",function(t){if(o&&u!="nothing"){M(t.offsetX,t.offsetY)}})};var T=function(){return{hour:f+(v?12:0),minute:p}};return{init:b,getCurrentTime:T}};var Color=function(t,e){if(Array.isArray(t)){this.rgb=t}else if(t.length==6){this.rgb=t.match(/.{2}/g).map(function(t){return parseInt(t,16)})}else{this.rgb=t.split("").map(function(t){return parseInt(t+t,16)})}this.alpha=typeof e==="number"?e:1};Color.prototype.type="Color";function toHex(t){return"#"+t.map(function(t){t=Math.min(Math.max(Math.round(t),0),255);return(t<16?"0":"")+t.toString(16)}).join("")}Color.prototype.luma=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255;t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4);e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4);i=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4);return.2126*t+.7152*e+.0722*i};Color.prototype.toRGB=function(){return toHex(this.rgb)};Color.prototype.toHSL=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255,s=this.alpha;var n=Math.max(t,e,i),o=Math.min(t,e,i);var r,a,l=(n+o)/2,h=n-o;if(n===o){r=a=0}else{a=l>.5?h/(2-n-o):h/(n+o);switch(n){case t:r=(e-i)/h+(e<i?6:0);break;case e:r=(i-t)/h+2;break;case i:r=(t-e)/h+4;break}r/=6}return{h:r*360,s:a,l:l,a:s}};Color.prototype.toHSV=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255,s=this.alpha;var n=Math.max(t,e,i),o=Math.min(t,e,i);var r,a,l=n;var h=n-o;if(n===0){a=0}else{a=h/n}if(n===o){r=0}else{switch(n){case t:r=(e-i)/h+(e<i?6:0);break;case e:r=(i-t)/h+2;break;case i:r=(t-e)/h+4;break}r/=6}return{h:r*360,s:a,v:l,a:s}};Color.prototype.toARGB=function(){return toHex([this.alpha*255].concat(this.rgb))};Color.prototype.compare=function(t){return t.rgb&&t.rgb[0]===this.rgb[0]&&t.rgb[1]===this.rgb[1]&&t.rgb[2]===this.rgb[2]&&t.alpha===this.alpha?0:undefined};var rpndragdropsortingmodule=function(){var t;var e;var i;var s=function(s,o,r){_.defaults(s,{todrag:["empty"],todrop:["empty too :'("]});t=s;e=r;if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){i=o}else{i={todrag:t.todrag,todrop:t.todrop}}n()};var n=function(){e.addClass("dragdropsorting");e.append($('<div class="row"><div class="container"><div class="col-md-2 col"><ul id="drag_this_'+e.attr("id")+'" class="dragthis list-unstyled"></ul></div></div><div class="row"><div class="container dropzonecontainer"></div></div>'));$.each(t.todrop,function(t,s){$(".dropzonecontainer",e).append($('<div class="col-md-2"><div class="droppable"><span class="lead">'+s+'</span><ul class="list-unstyled"></ul></div></div>'));if(!_.isUndefined(i[s])){_.each(i[s],function(e,i){$("ul",$(".droppable")[t]).append('<li class="draggable">'+e+"</li>")})}});$(".droppable ul",e).sortable({connectWith:".droppable ul",dropOnEmpty:true,placeholder:"droppable-placeholder",forcePlaceholderSize:true,distance:.5,receive:function(t,e){if($(e.sender[0]).hasClass("dragthis")){i.todrag.pop()}o()}});r();o()};var o=function(){if($(".dragthis li",e).length==0&&i.todrag.length>0){var t=_.last(i.todrag);$(".dragthis").append($('<li class="draggable">'+t+"</li>"));$(".dragthis").sortable({connectWith:".droppable ul",appendTo:"body",placeholder:"droppable-placeholder",forcePlaceholderSize:true,dropOnEmpty:true,distance:.5})}};var r=function(){};var a=function(){_.each($(".droppable",e),function(t,e){var s=[];$.each($(t).find("li"),function(t,e){s.push($(e).text())});i[$(t).find("span").text()]=s});return i};var l=function(t){var e=0;_.map(t,function(t,s){e+=_.intersection(i[s],t).length});return e};return{init:s,validate:a,score:l}};var rpndropdownmodule=function(){var t;var e;var i;var s=function(s,o,r){_.defaults(s,{sentence:"",circumstance:["",""]});t=s;e=r;if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){i=o}else{i=_.map(_.filter(t.items,function(t){return t.choice.length>1}),function(t,e){return""})}n()};var n=function(){e.addClass("dropdown");if(!_.isEmpty(t.circumstance[0])){e.append($('<hr style="border-top: 5px solid #ccc;"><p><b>'+t.circumstance[0]+"</b></p>"))}if(!_.isEmpty(t.sentence)){e.append($("<p>"+t.sentence+"</p>"))}if(!_.isEmpty(t.circumstance[1])){e.append($('<hr style="border-top: 5px solid #ccc;"><p><b>'+t.circumstance[1]+"</b></p>"))}var s=$('<div class="form-inline">');var n=0;$.each(t.items,function(e,o){if(o.choice.length==1){s.append(" "+o.choice[0]+" ")}else{var r=[];r[0]=$('<option value="" '+(i[n]==""?"selected":"")+"> ?</option>");$.each(t.items[e].choice,function(t,e){r[t+1]=$('<option value="'+e+'" '+(i[n]==e?"selected":"")+">"+e+"</option>")});s.append($('<select class="rpnm-input dropdown form-control">').append(r));n++}});e.append(s);o()};var o=function(){};var r=function(){i=_.map($("select",e),function(t,e){return $(t).val()});return i};var a=function(t){var e=0;_.each(t,function(t,s){if(t.alternative){e+=_.contains(t.alternative,i[s])?1:0}else{e+=i[s]==t?1:0}});return e};return{init:s,validate:r,score:a}};var rpngapfullmodule=function(){var t;var e;var i;var s;var n=function(i,n,r){_.defaults(i,{sentence:"sentence not set!"});t=i;e=r;if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){s=n}else{s=t.sentence}o()};var o=function(){e.addClass("gapfull");e.append($("<p>"+t.sentence+'</p><input type="text" class="rpnm_input form-control">'));i=$(".rpnm_input",e);i.val(s);r()};var r=function(){};var a=function(){s=$(".rpnm_input",e).val();return s};var l=function(t){return s==t?1:0};return{init:n,validate:a,score:l}};var rpngapsimplemodule=function(){var t;var e;var i;var s;var n;var o;var r=function(s,n,r){_.defaults(s,{tofill:"tofill not set!<b>Read</b> documentation please!"});t=s;i=!_.isUndefined(s.fillers);e=r;if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){o=n}else{o=_.map($("b",t.tofill),function(t,e){return""})}a()};var a=function(){e.addClass("gapsimple");var s=0;if(i){var r=$('<div class="gapsimpleddtoolbar">');$.each(t.fillers,function(t,i){var n=$('<span class="draggable ori">'+i+"</span> ").draggable({revert:"invalid",appendTo:e,helper:"clone"});r.append(n);s=s<n.width()?n.width():s});n=_.max(t.fillers,function(t){return t.length}).length;e.append(r)}e.append($('<div class="form-inline">'+t.tofill+"</div>"));$.each($("b",e),function(s,n){var r=$(n);var a="";if(i){var l=$('<b class="gapsimpleddresponse">');r.replaceWith(l);l.droppable({accept:".draggable",hoverClass:"gapsimpleddresponse-hover",drop:function(t,i){$(this).empty();$(this).append((i.draggable.hasClass("ori")?i.draggable.clone():i.draggable).removeClass("ori").draggable({revert:"invalid",appendTo:e,helper:"clone"}))}});if(!_.isEmpty(o[s])){var h=$('<span class="'+(_.isEmpty(o[s])?"":"draggable")+'">'+(_.isEmpty(o[s])?"":o[s])+"</span>");l.append(h.draggable({revert:"invalid",appendTo:e,helper:"clone"}))}}else{var c=_.isUndefined(t.validation.align)?"":" "+t.validation.align;var d=_.isUndefined(t.validation.width)?"":" style='width:"+t.validation.width+"'";if(r.text().substr(-1)!="_"){a=_.isEmpty(r.text())?"":"<strong>("+r.text()+")</strong>";r.replaceWith($('<span class="text-nowrap"><input type="text" class="rpnm_input gapsimple form-control'+c+'"'+d+">"+a+"</span>"))}else{a=r.text().slice(0,-1);r.replaceWith($('<span class="text-nowrap">'+a+'<input type="text" class="rpnm_input gapsimple form-control'+c+'"'+d+"></span>"))}$($(".rpnm_input",e)[s]).val(o[s])}});l()};var l=function(){rpnsequence.addvalidation($(".rpnm_input",e),t.validation)};var h=function(){if(i){_.each($(".gapsimpleddresponse",e),function(t,e){o[e]=$(".draggable",$(t)).text()})}else{$.each($(".gapsimple",e),function(t,e){o[t]=$(e).val().trim()})}return o};var c=function(t){var e=0;_.each(t,function(t,i){if(t.alternative){e+=_.contains(t.alternative,o[i])?1:0}else{e+=o[i]==t?1:0}});return e};return{init:r,validate:h,score:c}};var rpnmarkermodule=function(){var t;var e;var i;var s=function(s,o,r){_.defaults(s,{markers:[],tomark:["fill tomark please!"],hidden:false,smallButtons:false,displayTooltip:true});t=s;e=r;if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){i=o}else{var a=["#8d61a4","#01a271","#5dc2e7","#ed656a","#f5a95e","#eee227","#7a5a14","#bbbbbb","#63b553","#e95c7b","#f5a95e"];var l=$("b",t.tomark);$.merge(l,$("area",t.tomark));i={selectedMarker:"",responses:_.map(l,function(t,e){return""}),markers:_.map(t.markers,function(t,e){return{label:t,color:a[e]||"#222"}})}}n()};var n=function(){e.addClass("marker");var s=$("<div>",{"class":"btn-group","data-toggle":"buttons"});s.append($('<label class="btn btn-default '+(t.smallButtons?"":"btn-lg ")+(i.selectedMarker.label==""?"active":"")+' eraser"><input type="radio" name="options" autocomplete="off" '+(i.selectedMarker==""?"checked":"")+'><span class="edicons-tool-eraser"></span> '+rpnsequence.getLabels().Eraser+"</label>").click(function(){i.selectedMarker={color:"",label:""}}));$.each(i.markers,function(e,n){s.append($('<label class="btn btn-default '+(t.smallButtons?"":"btn-lg ")+(i.selectedMarker.label==n.label?"active":"")+' stab"><input type="radio" name="options" autocomplete="off" '+(i.selectedMarker==n.label?"checked":"")+'><span class="edicons-tool-stab" style="color:'+n.color+'"></span> '+n.label+"</label>").click(function(){i.selectedMarker=n}))});e.append(s);if(!_.isUndefined(t.background)){if(_.isUndefined(t.background.url)){rpnsequence.log("background defined without url!");e.append($('<div class="markable" >'+t.tomark+"</div>"))}else{_.defaults(t.background,{width:"0px",height:"0px",paddingTop:"0px",paddingRight:"0px",paddingBottom:"0px",paddingLeft:"0px"});e.append($('<div class="markable" style="width:'+t.background.width+";height:"+t.background.height+";padding-top:"+t.background.paddingTop+";padding-right:"+t.background.paddingRight+";padding-bottom:"+t.background.paddingBottom+";padding-left:"+t.background.paddingLeft+";background-image:url("+rpnsequence.computeMediaUrl(t.background.url)+');background-repeat:no-repeat;background-size:contain">'+t.tomark+"</div>"))}}else{e.append($('<div class="markable" >'+t.tomark+"</div>"))}$.each($("b",e),function(e,s){var n=$(s);if(!_.isEmpty(i.responses[e])){n.css("background-color",_.findWhere(i.markers,{label:i.responses[e]}).color);if(t.displayTooltip){n.attr("data-original-title",i.responses[e]).tooltip("fixTitle")}}if(!t.hidden){n.css("cursor","pointer")}else{n.css("font-weight","normal")}n.click(function(){n.css("background-color",i.selectedMarker.color);if(t.displayTooltip&&i.selectedMarker.color!=""){n.attr("data-original-title",i.selectedMarker.label).tooltip("fixTitle").tooltip("show")}else{n.tooltip("destroy")}i["responses"][e]=i.selectedMarker.label})});$(".map",e).maphilight({strokeWidth:3,fillOpacity:.5});$.each($("area",e),function(s,n){var o=$(n);var r=$(o).mouseout().data("maphilight")||{};if(!_.isEmpty(i.responses[s+$("b",e).length])){r.alwaysOn=true;r.fillColor=_.findWhere(i.markers,{label:i.responses[s+$("b",e).length]}).color.substring(1);r.strokeColor=r.fillColor}else{r.alwaysOn=false;fillOpacity=.5}console.log("data "+r);$(o).data("maphilight",r).trigger("alwaysOn.maphilight");if(!t.hidden){o.css("cursor","pointer")}else{o.css("font-weight","normal")}o.click(function(){i["responses"][s+$("b",e).length]=i.selectedMarker.label;if(i.selectedMarker.label==""){r.alwaysOn=false}else{r.alwaysOn=true;r.fillColor=i.selectedMarker.color.substring(1);r.strokeColor=r.fillColor}$(o).data("maphilight",r).trigger("alwaysOn.maphilight")})});o()};var o=function(){};var r=function(){return i};var a=function(t){var e=0;_.each(t,function(t,s){e+=i.responses[s]==t?1:0});return e};return{init:s,validate:r,score:a}};var rpnmqcmodule=function(){var t;var e;var i;var s=function(s,o,r){_.defaults(s,{questions:["No questions!"],answers:["As no answers"],vertical:false,mqcmultiple:false});t=s;e=r;if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){i=o}else{i={responses:_.map(t.questions,function(t,e){return""})}}n()};var n=function(){e.addClass("mqc");var s=$("<ul>",{"class":"list-unstyled"});$.each(t.questions,function(e,n){var o=$("<li>");o.append($("<p>"+n+"</p>"));var r=$('<div class="'+(t.vertical?"btn-group-vertical":"btn-group")+'" role="group" data-toggle="buttons">');var a=t.answers.length==1?0:e;if(t.mqcmultiple){var l=new Array(t.answers.length);l=_.map(l,function(t,e){return""});$.each(t.answers[a].choice,function(t,s){l[t]=!_.isEmpty(i.responses[e][t])&&i.responses[e][t]==s?i.responses[e][t]:"";r.append($('<label class="btn btn-default '+(!_.isEmpty(i.responses[e][t])&&i.responses[e][t]==s?"active":"")+'"><input type="checkbox" autocomplete="off" '+(!_.isEmpty(i.responses[e][t])&&i.responses[e][t]==s?"checked":"")+">"+s+"</label>").click(function(n){l[t]=!$(n.currentTarget).hasClass("active")?s:"";i.responses[e]=l}));o.append(r)})}else{$.each(t.answers[a].choice,function(t,s){r.append($('<label class="btn btn-default '+(!_.isEmpty(i.responses[e])&&i.responses[e]==s?"active":"")+'"><input type="radio" autocomplete="off" '+(!_.isEmpty(i.responses[e])&&i.responses[e]==s?"checked":"")+">"+s+"</label>").click(function(){i.responses[e]=s}));o.append(r)})}s.append(o)});e.append(s);o()};var o=function(){};var r=function(){return i};var a=function(t){var e=0;_.each(t,function(t,s){e+=_.isEqual(i.responses[s],t)?1:0});return e};return{init:s,validate:r,score:a}};var rpnsequence=function(){var t;var e;var i;var s;var n;var o;var r;var a;var l;var h;var c;var d;var f;var p;var u;var m;var g;var v;var b;var y;var w;var C={en:{Recall:"Recall",Order:"Order",Warning:"Warning",BeforeUnloadMsg:"Module running!",Wait:"Please wait...",Validate:"Next",EndSequence:"Continue",Eraser:"Eraser",DragDropNotEmpty:"There are still some items to sort!",CardMazeNotEnded:"You have not finished the maze!",BlackboxTableView:"Values table",BlackboxView:"Blackbox",Quit:"Quit"},fr:{Recall:"Rappel",Order:"Consignes",Warning:"Attention",BeforeUnloadMsg:"Exercice en cours!",Wait:"Veuillez patienter...",Validate:"Suite",EndSequence:"Continuer",Eraser:"Effaceur",DragDropNotEmpty:"Il y a encore des lments  trier!",CardMazeNotEnded:"Vous n'avez pas termin le labyrinthe!",BlackboxTableView:"Tableau de valeurs",BlackboxView:"Bote noire",Quit:"Quitter"}};var x=function(i){if(_.isUndefined(i)){i={}}_.defaults(i,{sequrl:"seq.json",solurl:"sol.json",stateurl:"sta.json",warnonexit:false,domelem:$("body"),onsequenceend:function(t,e){},onmoduleend:function(){},mediapathformatter:function(t){return"medias/"+t},language:"en",debug:false,disablestateloading:false,navigationEnabled:false,quitDisabled:false,bypassModule:false});y=C[i.language];o=[];w=[];r=i.warnonexit;n=i.solurl;v=i.debug;b=!i.disablestateloading;d=i.domelem;a=i.onsequenceend;l=i.onmoduleend;h=i.mediapathformatter;u=i.quitDisabled;m=i.bypassModule;$.getJSON(i.sequrl,function(s){_.defaults(s,{title:"sequencetitle",modules:[]});t=s;_.each(t.modules,function(t,e){t["status"]="init"});e=0;g=i.navigationEnabled&&t.modules.length>1;if(b){$.getJSON(i.stateurl,function(e){o=_.map(t.modules,function(t,i){return{state:e.states[i]}});P()}).error(function(){o=_.map(t.modules,function(t,e){return{state:undefined}});P()})}else{o=_.map(t.modules,function(t,e){return{state:undefined}});P()}})};var P=function(){i=$("<div></div>");d.append([$('<button id="rpnm_quit" class="btn btn-link pull-right hidden-xs hidden-sm">'+y.Quit+' <i class="glyphicon glyphicon-remove-circle"></i></button>'),$('<div class="container" id="rpnm"></div>').append([$('<div class="row page-header"><div class="col-md-7"><h1 id="rpnm_seq_title"></h1></div><div class="col-md-5"><nav id="rpnm_modulenav"><ul class="pagination pagination-sm"></ul></nav></div></div>'),i,$('<div class="row"><div class="col-md-12"><em id="rpnm_source" class="pull-right"></em></div></div>'),$('<div class="row"><div class="col-md-12"><button id="rpnm_validation" class="btn btn-primary pull-right"></button></div></div>')])]);d.append($('<div id="rpnm_recall_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-bell"></i> '+y.Recall+'</h4></div><div class="modal-body"></div></div></div></div>'));d.append($('<div id="rpnm_order_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-question-sign"></i> '+y.Order+'</h4></div><div class="modal-body"></div></div></div></div>'));d.append($('<div id="rpnm_alert_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-warning-sign"></i> '+y.Warning+'</h4></div><div class="modal-body"></div></div></div></div>'));
d.append($('<div id="rpnm_wait_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">'+y.Wait+'</h4></div><div class="modal-body"><div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"><span class="sr-only">100% completed</span></div></div></div></div></div></div>'));$("#rpnm_seq_title").html(t.title);f=$("#rpnm_validation");p=$("#rpnm_quit");if(u){p.hide()}s=$("#rpnm_source");c=$("#rpnm_alert_modal");if(!g){$("#rpnm_modulenav").remove()}_.each(t.modules,function(t,e){_.defaults(t,{disposition:"top"});var s=$('<button class="btn btn-default btn-sm pull-right" href="#" data-toggle="modal" data-target="#rpnm_order_modal"><i class="glyphicon glyphicon-question-sign"></i> '+y.Order+"</button>");var n=$('<button class="btn btn-default btn-sm pull-right" href="#" data-toggle="modal" data-target="#rpnm_recall_modal"><i class="glyphicon glyphicon-bell"></i> '+y.Recall+"</button>");var r=$('<div id="rpnm_context"></div>');var a=$('<div id="rpnm_directive"></div>');r.html(t.context);a.html(t.directive);var l=$("<div>");var h=$('<div class="row"></div>').append($('<div class="col-md-12"></div>').append($('<h2 id="rpnm_title">'+(_.isUndefined(t.title)?"":t.title)+"</h2>").append([s,n])));if(_.isUndefined(t.recall)){n.hide()}if(_.isUndefined(t.order)){s.hide()}var c=$('<div id="rpnm_inst_'+e+'" class="rpnm_instance">').append(h);if(t.disposition=="bottom"){c.append($('<div class="row"></div>').append($('<div class="col-md-12"></div>').append([l,r,a])))}else if(t.disposition=="left"){c.append($('<div class="row"></div>').append([$('<div class="col-md-6"></div>').append([r,a]),$('<div class="col-md-6"></div>').append(l)]))}else if(t.disposition=="right"){c.append($('<div class="row"></div>').append([$('<div class="col-md-6"></div>').append(l),$('<div class="col-md-6"></div>').append([r,a])]))}else{c.append($('<div class="row"></div>').append($('<div class="col-md-12"></div>').append([r,a,l])))}_.isUndefined(t.context)?r.hide():r.show().html(t.context);_.isUndefined(t.directive)?a.hide():a.show().html(t.directive);i.append(c);if(_.isNull(o[e]).state){_.isNull(o[e]).state=undefined}if(t.type=="marker"){w[e]=rpnmarkermodule();w[e].init(t,o[e].state,l)}else if(t.type=="mqc"){w[e]=rpnmqcmodule();w[e].init(t,o[e].state,l)}else if(t.type=="gapsimple"){w[e]=rpngapsimplemodule();w[e].init(t,o[e].state,l)}else if(t.type=="gapfull"){w[e]=rpngapfullmodule();w[e].init(t,o[e].state,l)}else if(t.type=="clock"){w[e]=rpnclockmodule();w[e].init(t,o[e].state,l)}else if(t.type=="blackbox"){w[e]=rpnblackboxmodule();w[e].init(t,o[e].state,l)}else if(t.type=="dragdropsorting"){w[e]=rpndragdropsortingmodule();w[e].init(t,o[e].state,l)}else if(t.type=="cardmaze"){w[e]=rpncardmazemodule();w[e].init(t,o[e].state,l)}else if(t.type=="dropdown"){w[e]=rpndropdownmodule();w[e].init(t,o[e].state,l)}else if(t.type=="sorting"){w[e]=rpnsortingmodule();w[e].init(t,o[e].state,l)}c.hide();if(t.type!="gapfull"){l.disableSelection()}$("#rpnm_modulenav ul").append($('<li><a href="#">'+(e+1)+"</a></li>"));if(m){T()}});if(r){$(window).bind("beforeunload",function(t){return y.BeforeUnloadMsg})}k();I()};var k=function(){f.click(function(){S(w[e].validate(),e+1)});p.click(function(){S(w[e].validate(),e+1)});if(g&&t.modules.length>1){_.each($("#rpnm_modulenav ul li"),function(t,i){$(t).click(function(){w[e].validate();S(w[e].validate(),i)})})}};var I=function(){$("#rpnm_wait_modal").modal({show:true,backdrop:"static",keyboard:false});var i=t.modules[e];_.defaults(i,{title:"title"});$(".rpnm_instance").hide();var s=$("#rpnm_inst_"+e);M(i);E();if(g){$("#rpnm_modulenav ul li").removeClass("active");$($("#rpnm_modulenav ul li")[e]).addClass("active")}if(e==t.modules.length-1){f.html(y.EndSequence+' <i class="glyphicon glyphicon glyphicon-ok-circle"></i>').removeClass("btn-primary").addClass("btn-success")}else{f.html(y.Validate+' <i class="glyphicon glyphicon-chevron-right"></i>').removeClass("btn-success").addClass("btn-primary")}s.show();$("#rpnm_wait_modal").modal("hide")};var M=function(t){if(!_.isUndefined(t.recall)){$("#rpnm_recall_modal .modal-body").html(t.recall)}if(!_.isUndefined(t.order)){$("#rpnm_order_modal .modal-body").html(t.order)}s.html(_.isUndefined(t.sources)?"":t.sources)};var S=function(i,s){$("#rpnm_wait_modal").modal({show:true,backdrop:"static",keyboard:false});N("End of module");o[e]={state:i};l({states:_.map(o,function(t){return t.state})},function(){t.modules[e].status="ended";e=s;if(e>t.modules.length-1){T()}else{I()}})};var T=function(){N("End of sequence");N(JSON.stringify({states:_.map(o,function(t){return t.state})},null,"	"));$.getJSON(n,function(t){var e=0;_.each(t.solutions,function(t,i){e+=w[i].score(t)});N("Calculated total score for sequence "+e);if(r){$(window).unbind("beforeunload")}a({states:_.map(o,function(t){return t.state})},e)})};var O=function(t,e){$("#rpnm_alert_modal .modal-body").text(t);c.modal();c.on("hidden.bs.modal",function(){if(!_.isUndefined(e)){e()}})};var N=function(t){if(v){console.log(t)}};var E=function(){_.each($("img:not(.rpnm-img, .rpnm-mediapath)"),function(t,e){var i=$(t);i.attr("src",h($(t).attr("src"))).addClass("rpnm-mediapath");if(i.is(".modal-body img")){i.addClass("img-responsive img-rounded")}})};var H=function(){return y};var A=function(t,e){if(_.isUndefined(e)){return}_.defaults(e,{mode:"lock",type:"natural"});$(t).bind("cut copy paste",function(t){t.preventDefault()});if(e.mode=="lock"){$(t).bind("input propertychange",function(){if(e.type=="natural"){var t=/(^-?[0-9]\d*)/.exec($(this).val());if(t==""||t==null||t==0){$(this).val("")}else if(isNaN(t)){$(this).val(parseInt(t))}}else if(e.type=="integer"){var t=/[-0-9]\d*/.exec($(this).val());if(t==""||t==null){$(this).val("")}else if(t=="-"){$(this).val("-")}else if(t=="-0"){$(this).val("-")}else if(t=="00"){$(this).val("0")}else{$(this).val(parseInt(t))}}else if(e.type=="posdecimal"){var i=$(this).val().replace(",",".");var t=/^[.\d]\d*\.?\d*/.exec(i);if($(this).val().match(/^0[^,\.]/)){var s=$(this).val().replace(",",".").substring(0,1);var t=/^[-.\d]\d*.?\d*/.exec(s)}if($(this).val().match(/^-/)){var s=$(this).val().replace(",",".");var t=/[.\d]\d*.?\d*/.exec(s)}if(t==""||t==null){t=""}else if(t=="."){t="0."}$(this).val(t)}else if(e.type=="decimal"){var i=$(this).val().replace(",",".");var t=/^[-.\d]\d*\.?\d*/.exec(i);if($(this).val().match(/^-/)){if($(this).val().substring(1).match(/^0[^,\.]/)){var s=$(this).val().replace(",",".").substring(2);var t=/^[-.\d]\d*.?\d*/.exec(s)}else{var s=$(this).val().replace(",",".").substring(1);var t=/^[-.\d]\d*.?\d*/.exec(s)}var n=true}if($(this).val().match(/^0[^,\.]/)){var s=$(this).val().replace(",",".").substring(0,1);var t=/^[-.\d]\d*.?\d*/.exec(s)}if($(this).val().match(/^-/)){var s=$(this).val().replace(",",".");var t=/[.\d]\d*.?\d*/.exec(s)}if(t==""||t==null){t=""}else if(t=="."){t="0."}if(n){$(this).val("-"+t)}else{$(this).val(t)}}else if(e.type=="lowercase"){var i=$(this).val().toLowerCase();var t=/[a-z]*/.exec(i);if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="familycase"){var t=/^[A-Za-z][a-z]*/.exec($(this).val());if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="uppercase"){var i=$(this).val().toUpperCase();var t=/[A-Z]*/.exec(i);if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="letter"){var t=/[A-Za-z]*/.exec($(this).val());if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="words"){var t=/[A-Za-z' ]*/.exec($(this).val().replace(/\s{2,}/g," "));if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}})}};var W=function(t){return h(t)};return{init:x,buildUi:P,displayAlert:O,log:N,getLabels:H,addvalidation:A,computeMediaUrl:W}}();var rpnsortingmodule=function(){var t;var e;var i;var s=function(s,o,r){_.defaults(s,{sentence:["sentence","not","set!"],shuffle:false});t=s;e=r;if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){i=o}else{i=t.sentence;if(t.shuffle){i=_.shuffle(i)}}n()};var n=function(){e.addClass("sorting");var t=$('<ul class="list-unstyled list-inline"></ul>');_.each(i,function(e,i){t.append($("<li>"+e+"</li>"))});e.append(t);t.sortable({placeholder:"sorting-highlight",tolerance:"pointer"});$("#sortable").disableSelection();o()};var o=function(){};var r=function(){i=_.map($("li",e),function(t,e){return $(t).html()});return i};var a=function(t){var e=0;if(t.alternative){_.each(t.alternative,function(t,s){e+=_.isEqual(i,t)?1:0})}else{e=_.isEqual(i,t)?1:0}return e};return{init:s,validate:r,score:a}};var rpntwolistsmodule=function(){var t;var e;var i;var s=new Array;var n;var o;var r;var a;var l;var h=function(s,n,o){_.defaults(s,{leftitems:["<p>what have you said?</p>"],rightitems:["<p> I don't remember!</p>"],shuffle:false});t=s;e=o;if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){i=n}else{i=[];if(t.leftitems.length<t.rightitems.length){_.each(t.leftitems,function(t,e){i.push({positionLX:0,positionLY:0,positionRX:0,positionRY:0,response:null})})}else{_.each(t.rightitems,function(t,e){i.push({positionLX:0,positionLY:0,positionRX:0,positionRY:0,response:null})})}if(t.shuffle){i=_.shuffle(i)}}c()};var c=function(){var i=(t.rightitems.length+t.leftitems.length)*100/2;e.addClass("twolists");var h=$('<div class="row"><math  display="block"><mspace height="40px"/><mfrac linethickness="2px" numalign="left" denomalign="left"><mrow><mfrac bevelled="true"><mn>1</mn><mi>x</mi></mfrac><mo>+</mo><mfrac bevelled="true"><mn>2</mn><mi>x</mi></mfrac><mo>+</mo><mo>&hellip;</mo></mrow><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>x</mi><mn>4</mn></msup><mo>+</mo><mo>&hellip;</mo></mrow></mfrac></math></div>');e.append(h);n=$('<div id="leftdiv" class="col-xs-4">');r=$('<div id="centerdiv_'+t.idmodule+'" class="col-xs-4">');o=$('<div id="rightdiv" class="col-xs-4">');var c=$('<canvas id="c'+t.idmodule+'"  height="'+i+'px" width="1000px">'),d=new Array,f=new Array,p=t.leftitems.length,u=p,m=t.rightitems.length,g=_.shuffle(["#8d61a4","#01a271","#5dc2e7","#63b553","#ed656a","#e95c7b","#f5a95e","#d62b81","#eee227"]);a=_.shuffle(t.leftitems);l=_.shuffle(t.rightitems);d[t.idmodule]=new Array;f[t.idmodule]=new Array;_.each(a,function(e,i){n.append($('<div id="inputgrpleft_'+i+"_"+t.idmodule+'" class="input-group"><span id="l_'+i+"_"+t.idmodule+'">'+a[i][1]+'</span><span class="input-group-addon"><input  type="radio" id="radleft_'+i+"_"+t.idmodule+'" name="l'+i+"_"+t.idmodule+'"></span></div>'));d[t.idmodule].push("#radleft_"+i+"_"+t.idmodule)});_.each(l,function(e,i){o.append($('<div id="inputgrpright_'+i+"_"+t.idmodule+'" class="input-group"><span class="input-group-addon" ><input type="radio" id="radright_'+i+"_"+t.idmodule+'" name="r'+i+"_"+t.idmodule+'"></span><span id="r_'+i+"_"+t.idmodule+'">'+l[i][1]+"</span></div>"));d[t.idmodule].push("#radright_"+i+"_"+t.idmodule)});e.append(n);e.append(r);e.append(o);e.append(c);$(document).ready(function(){for(var e=0;e<d[t.idmodule].length;e++){f[t.idmodule].push($(d[t.idmodule][e]))}var i=new fabric.Canvas("c"+t.idmodule,{hoverCursor:"pointer",selection:false});if(p>m){u=m}for(var e=0;e<u;e++){if(p<m){var n=$("#inputgrpright_0_"+t.idmodule).offset().top+e*40}else{var n=$("#inputgrpleft_0_"+t.idmodule).offset().top+e*40}var o=.8*$("#centerdiv_"+t.idmodule).offset().left;s[e+10*t.idmodule]=new Bezier(i,o,n,o+100,n,o+100,n,o,n,g[e],f[t.idmodule],c)}})};var d=function(){var e=0;$.each(s,function(n){var o=e+10*t.idmodule;if(s[o]&&s[o].target[0]!=-3&&s[o].target[1]!=-3){i[n].response=[a[s[o].target[0][0]][0],l[s[o].target[1][0]][0]];i[n].positionLX=s[o].fromX;i[n].positionLY=s[o].fromY;i[n].positionRX=s[o].toX;i[n].positionRY=s[o].toY;e++}});return i};var f=function(e){f=0;for(var n=10*t.idmodule;n<s.length;n++){for(var o=0;o<e.length;o++){if(i[n-10*t.idmodule].response!=null){f+=i[n-10*t.idmodule].response[0]==e[o][0]&&i[n-10*t.idmodule].response[1]==e[o][1]?1:0}}}return f};return{init:h,validate:d,score:f}};function Bezier(t,e,i,s,n,o,r,a,l,h,c,d){this.myContainer=d,this.canvas=t,this.fromX=e,this.fromY=i,this.toX=s,this.toY=n,this.g1X=o,this.g1Y=r,this.g2X=a,this.g2Y=l,this.color=h,this.targets=c,this.target1=[-1,-1,"vide1"],this.target2=[-2,-2,"vide2"],this.target=[-3,-3],this.make=function(t,e,i,s,n,o,r,a,l){var h=new fabric.Path("M 65 0 C 100, 100, 100, 200, 200, 0",{fill:"",stroke:l,strokeWidth:3,opacity:1});h.path[0][1]=t;h.path[0][2]=e;h.path[1][1]=i;h.path[1][2]=s;h.path[1][3]=n;h.path[1][4]=o;h.path[1][5]=r;h.path[1][6]=a;return h},this.makeLine=function(t,e){dashL=new fabric.Line(t,{fill:"black",stroke:"red",strokeWidth:1,strokeDashArray:[5,5],opacity:0});return dashL},this.makeCurveCircle=function(t,e,i,s,n,o,r,a,l,h,c){var d=new fabric.Circle({radius:5,left:t-5,top:e-5,strokeWidth:3,fill:a,stroke:a,opacity:1});d.line1=i;d.line2=s;d.line3=n;d.line4=o;d.guide=r;d.target=l;d.targets=h;d.cont=c;return d},this.makeCurvePoint=function(t,e,i,s,n,o,r,a,l){var h=new fabric.Circle({left:t,top:e,strokeWidth:3,radius:2,fill:a,stroke:a,opacity:0});h.line1=i;h.line2=s;h.line3=n;h.line4=o;h.guide=r;return h},this.onObjectSelected=function(e){var i=e.target;if(i.name=="p0"){i.line2.animate("opacity","0",{duration:200,onChange:t.renderAll.bind(t)});i.line2.selectable=true;i.guide.animate("opacity","0",{duration:200,onChange:t.renderAll.bind(t)})}if(i.name=="p3"){i.line3.animate("opacity","0",{duration:200,onChange:t.renderAll.bind(t)});i.line3.selectable=true;i.guide.animate("opacity","0",{duration:200,onChange:t.renderAll.bind(t)})}},this.onObjectMoving=function(t){if(t.target.name=="p0"||t.target.name=="p3"){var i=t.target,s=i.top+i.cont.offset().top,n=i.left+i.cont.offset().left;for(var o=0;o<i.targets.length;o++){var r=i.cont;if(Math.abs(n-i.targets[o].offset().left)<20&&Math.abs(s-i.targets[o].offset().top)<20){i.left=-2-i.radius-i.cont.offset().left+i.targets[o].offset().left+i.targets[o].width()/2;i.top=-3-i.radius-i.cont.offset().top+i.targets[o].offset().top+i.targets[o].height()/2;if(i.targets[o].attr("name").substring(0,1)=="l"){i.target[0]=i.targets[o].attr("name").substring(1)}else if(i.targets[o].attr("name").substring(0,1)=="r"){i.target[1]=i.targets[o].attr("name").substring(1)}}if(i.left<=10){i.left=10}if(i.left>=r.width()){i.left=r.width()-10}if(i.top<=8){i.top=8}if(i.top>=r.height()-10){i.top=r.height()-10}}if(i.name=="p0"){i.guide.set({x1:i.left,y1:i.top,x2:i.p3.left,y2:i.top})}else{i.guide.set({x1:i.left,y1:i.top,x2:i.p0.left,y2:i.top})}if(i.line1){i.line1.path[0][1]=i.left+i.radius;i.line1.path[0][2]=i.top+i.radius;i.line1.path[1][1]=i.p3.left+i.radius;i.line1.path[1][2]=i.top+i.radius;i.line2.left=i.p3.left+i.radius;i.line2.top=i.top+i.radius;e=i.line1.path[0][1]}else if(i.line4){i.line4.path[1][5]=i.left+i.radius;i.line4.path[1][6]=i.top+i.radius;i.line4.path[1][3]=i.p0.left+i.radius;i.line4.path[1][4]=i.top+i.radius;i.line3.left=i.p0.left+i.radius;i.line3.top=i.top+i.radius}}},this.canvas.on({"object:selected":this.onObjectSelected,"object:moving":this.onObjectMoving}),this.drawCubic=function(){this.guide1=this.makeLine([this.fromX,this.fromY,this.g1X,this.g1Y]);this.guide1.name="guide1";this.guide2=this.makeLine([this.toX,this.toY,this.g2X,this.g2Y]);this.guide2.name="guide2";this.line=this.make(this.fromX,this.fromY,this.g1X,this.g1Y,this.g2X,this.g2Y,this.toX,this.toY,this.color);this.line.name="bezier";this.p1=this.makeCurvePoint(this.g1X,this.g1Y,null,this.line,null,null,this.guide1,this.color);this.p1.name="p1";this.p0=this.makeCurveCircle(this.fromX,this.fromY,this.line,this.p1,null,null,this.guide1,this.color,this.target,this.targets,this.myContainer);this.p0.name="p0";this.p2=this.makeCurvePoint(this.g2X,this.g2Y,null,null,this.line,null,this.guide2,this.color);this.p2.name="p2";this.p3=this.makeCurveCircle(this.toX,this.toY,null,null,this.p2,this.line,this.guide2,this.color,this.target,this.targets,this.myContainer);this.p3.name="p3";this.line.p0=this.p0;this.line.p3=this.p3;this.p3.p0=this.p0;this.p0.p3=this.p3;this.line.selectable=this.guide1.selectable=this.guide2.selectable=this.p0.selectable=this.p1.selectable=this.p2.selectable=this.p3.selectable=true;this.line.hasBorders=this.guide1.hasBorders=this.guide2.hasBorders=this.p0.hasBorders=this.p1.hasBorders=this.p2.hasBorders=this.p3.hasBorders=false;this.line.hasControls=this.guide1.hasControls=this.guide2.hasControls=this.p0.hasControls=this.p1.hasControls=this.p2.hasControls=this.p3.hasControls=false;this.line.perPixelTargetFind=this.guide1.perPixelTargetFind=this.guide2.perPixelTargetFind=this.p0.perPixelTargetFind=this.p1.perPixelTargetFind=this.p2.perPixelTargetFind=this.p3.perPixelTargetFind=true;t.add(this.line,this.guide1,this.guide2,this.p0,this.p1,this.p2,this.p3)},this.drawCubic()}
//# sourceMappingURL=rpnmodule.0.1.8.min.js.map