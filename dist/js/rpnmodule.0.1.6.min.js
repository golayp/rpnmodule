(function(t){t.fn.disableSelection=function(){return this.attr("unselectable","on").css("user-select","none").on("selectstart",false)}})(jQuery);(function(t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{t(jQuery)}})(function(t){t.ui=t.ui||{};t.extend(t.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});t.fn.extend({scrollParent:function(e){var i=this.css("position"),s=i==="absolute",n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=t(this);if(s&&e.css("position")==="static"){return false}return n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return i==="fixed"||!r.length?t(this[0].ownerDocument||document):r},uniqueId:function(){var t=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+ ++t}})}}(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){t(this).removeAttr("id")}})}});function e(e,s){var n,r,o,a=e.nodeName.toLowerCase();if("area"===a){n=e.parentNode;r=n.name;if(!e.href||!r||n.nodeName.toLowerCase()!=="map"){return false}o=t("img[usemap='#"+r+"']")[0];return!!o&&i(o)}return(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||s:s)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return t.css(this,"visibility")==="hidden"}).length}t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var s=t.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&e(i,!n)}});if(!t("<a>").outerWidth(1).jquery){t.each(["Width","Height"],function(e,i){var s=i==="Width"?["Left","Right"]:["Top","Bottom"],n=i.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};function o(e,i,n,r){t.each(s,function(){i-=parseFloat(t.css(e,"padding"+this))||0;if(n){i-=parseFloat(t.css(e,"border"+this+"Width"))||0}if(r){i-=parseFloat(t.css(e,"margin"+this))||0}});return i}t.fn["inner"+i]=function(e){if(e===undefined){return r["inner"+i].call(this)}return this.each(function(){t(this).css(n,o(this,e)+"px")})};t.fn["outer"+i]=function(e,s){if(typeof e!=="number"){return r["outer"+i].call(this,e)}return this.each(function(){t(this).css(n,o(this,e,true,s)+"px")})}})}if(!t.fn.addBack){t.fn.addBack=function(t){return this.add(t==null?this.prevObject:this.prevObject.filter(t))}}if(t("<a>").data("a-b","a").removeData("a-b").data("a-b")){t.fn.removeData=function(e){return function(i){if(arguments.length){return e.call(this,t.camelCase(i))}else{return e.call(this)}}}(t.fn.removeData)}t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());t.fn.extend({focus:function(e){return function(i,s){return typeof i==="number"?this.each(function(){var e=this;setTimeout(function(){t(e).focus();if(s){s.call(e)}},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(e!==undefined){return this.css("zIndex",e)}if(this.length){var i=t(this[0]),s,n;while(i.length&&i[0]!==document){s=i.css("position");if(s==="absolute"||s==="relative"||s==="fixed"){n=parseInt(i.css("zIndex"),10);if(!isNaN(n)&&n!==0){return n}}i=i.parent()}}return 0}});t.ui.plugin={add:function(e,i,s){var n,r=t.ui[e].prototype;for(n in s){r.plugins[n]=r.plugins[n]||[];r.plugins[n].push([i,s[n]])}},call:function(t,e,i,s){var n,r=t.plugins[e];if(!r){return}if(!s&&(!t.element[0].parentNode||t.element[0].parentNode.nodeType===11)){return}for(n=0;n<r.length;n++){if(t.options[r[n][0]]){r[n][1].apply(t.element,i)}}}};var s=0,n=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,r;for(r=0;(n=i[r])!=null;r++){try{s=t._data(n,"events");if(s&&s.remove){t(n).triggerHandler("remove")}}catch(o){}}e(i)}}(t.cleanData);t.widget=function(e,i,s){var n,r,o,a,l={},h=e.split(".")[0];e=e.split(".")[1];n=h+"-"+e;if(!s){s=i;i=t.Widget}t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)};t[h]=t[h]||{};r=t[h][e];o=t[h][e]=function(t,e){if(!this._createWidget){return new o(t,e)}if(arguments.length){this._createWidget(t,e)}};t.extend(o,r,{version:s.version,_proto:t.extend({},s),_childConstructors:[]});a=new i;a.options=t.widget.extend({},a.options);t.each(s,function(e,s){if(!t.isFunction(s)){l[e]=s;return}l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e=this._super,i=this._superApply,r;this._super=t;this._superApply=n;r=s.apply(this,arguments);this._super=e;this._superApply=i;return r}}()});o.prototype=t.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix||e:e},l,{constructor:o,namespace:h,widgetName:e,widgetFullName:n});if(r){t.each(r._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)});delete r._childConstructors}else{i._childConstructors.push(o)}t.widget.bridge(e,o);return o};t.widget.extend=function(e){var i=n.call(arguments,1),s=0,r=i.length,o,a;for(;s<r;s++){for(o in i[s]){a=i[s][o];if(i[s].hasOwnProperty(o)&&a!==undefined){if(t.isPlainObject(a)){e[o]=t.isPlainObject(e[o])?t.widget.extend({},e[o],a):t.widget.extend({},a)}else{e[o]=a}}}}return e};t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(r){var o=typeof r==="string",a=n.call(arguments,1),l=this;r=!o&&a.length?t.widget.extend.apply(null,[r].concat(a)):r;if(o){this.each(function(){var i,n=t.data(this,s);if(r==="instance"){l=n;return false}if(!n){return t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+r+"'")}if(!t.isFunction(n[r])||r.charAt(0)==="_"){return t.error("no such method '"+r+"' for "+e+" widget instance")}i=n[r].apply(n,a);if(i!==n&&i!==undefined){l=i&&i.jquery?l.pushStack(i.get()):i;return false}})}else{this.each(function(){var e=t.data(this,s);if(e){e.option(r||{});if(e._init){e._init()}}else{t.data(this,s,new i(r,this))}})}return l}};t.Widget=function(){};t.Widget._childConstructors=[];t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0];this.element=t(i);this.uuid=s++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=t();this.hoverable=t();this.focusable=t();if(i!==this){t.data(i,this.widgetFullName,this);this._on(true,this.element,{remove:function(t){if(t.target===i){this.destroy()}}});this.document=t(i.style?i.ownerDocument:i.document||i);this.window=t(this.document[0].defaultView||this.document[0].parentWindow)}this.options=t.widget.extend({},this.options,this._getCreateOptions(),e);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s=e,n,r,o;if(arguments.length===0){return t.widget.extend({},this.options)}if(typeof e==="string"){s={};n=e.split(".");e=n.shift();if(n.length){r=s[e]=t.widget.extend({},this.options[e]);for(o=0;o<n.length-1;o++){r[n[o]]=r[n[o]]||{};r=r[n[o]]}e=n.pop();if(arguments.length===1){return r[e]===undefined?null:r[e]}r[e]=i}else{if(arguments.length===1){return this.options[e]===undefined?null:this.options[e]}s[e]=i}}this._setOptions(s);return this},_setOptions:function(t){var e;for(e in t){this._setOption(e,t[e])}return this},_setOption:function(t,e){this.options[t]=e;if(t==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!e);if(e){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(e,i,s){var n,r=this;if(typeof e!=="boolean"){s=i;i=e;e=false}if(!s){s=i;i=this.element;n=this.widget()}else{i=n=t(i);this.bindings=this.bindings.add(i)}t.each(s,function(s,o){function a(){if(!e&&(r.options.disabled===true||t(this).hasClass("ui-state-disabled"))){return}return(typeof o==="string"?r[o]:o).apply(r,arguments)}if(typeof o!=="string"){a.guid=o.guid=o.guid||a.guid||t.guid++}var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+r.eventNamespace,c=l[2];if(c){n.delegate(c,h,a)}else{i.bind(h,a)}})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;e.unbind(i).undelegate(i);this.bindings=t(this.bindings.not(e).get());this.focusable=t(this.focusable.not(e).get());this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return(typeof t==="string"?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,r,o=this.options[e];s=s||{};i=t.Event(i);i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();i.target=this.element[0];r=i.originalEvent;if(r){for(n in r){if(!(n in i)){i[n]=r[n]}}}this.element.trigger(i,s);return!(t.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===false||i.isDefaultPrevented())}};t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,r){if(typeof n==="string"){n={effect:n}}var o,a=!n?e:n===true||typeof n==="number"?i:n.effect||i;n=n||{};if(typeof n==="number"){n={duration:n}}o=!t.isEmptyObject(n);n.complete=r;if(n.delay){s.delay(n.delay)}if(o&&t.effects&&t.effects.effect[a]){s[e](n)}else if(a!==e&&s[a]){s[a](n.duration,n.easing,r)}else{s.queue(function(i){t(this)[e]();if(r){r.call(s[0])}i()})}}});var r=t.widget;var o=false;t(document).mouseup(function(){o=false});var a=t.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){if(true===t.data(i.target,e.widgetName+".preventClickEvent")){t.removeData(i.target,e.widgetName+".preventClickEvent");i.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(e){if(o){return}this._mouseMoved=false;this._mouseStarted&&this._mouseUp(e);this._mouseDownEvent=e;var i=this,s=e.which===1,n=typeof this.options.cancel==="string"&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:false;if(!s||n||!this._mouseCapture(e)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==false;if(!this._mouseStarted){e.preventDefault();return true}}if(true===t.data(e.target,this.widgetName+".preventClickEvent")){t.removeData(e.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(t){return i._mouseMove(t)};this._mouseUpDelegate=function(t){return i._mouseUp(t)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);e.preventDefault();o=true;return true},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button){return this._mouseUp(e)}else if(!e.which){return this._mouseUp(e)}}if(e.which||e.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==false;this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)}return!this._mouseStarted},_mouseUp:function(e){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(e.target===this._mouseDownEvent.target){t.data(e.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(e)}o=false;return false},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}});t.widget("ui.draggable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"){this._setPositionRelative()}if(this.options.addClasses){this.element.addClass("ui-draggable")}if(this.options.disabled){this.element.addClass("ui-draggable-disabled")}this._setHandleClassName();this._mouseInit()},_setOption:function(t,e){this._super(t,e);if(t==="handle"){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=true;return}this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._removeHandleClassName();this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;this._blurActiveElement(e);if(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(e);if(!this.handle){return false}this._blockFrames(i.iframeFix===true?"iframe":i.iframeFix);return true},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_blurActiveElement:function(e){var i=this.document[0];if(!this.handleElement.is(e.target)){return}try{if(i.activeElement&&i.activeElement.nodeName.toLowerCase()!=="body"){t(i.activeElement).blur()}}catch(s){}},_mouseStart:function(e){var i=this.options;this.helper=this._createHelper(e);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(t.ui.ddmanager){t.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return t(this).css("position")==="fixed"}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(e);this.originalPosition=this.position=this._generatePosition(e,false);this.originalPageX=e.pageX;this.originalPageY=e.pageY;i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt);this._setContainment();if(this._trigger("start",e)===false){this._clear();return false}this._cacheHelperProportions();if(t.ui.ddmanager&&!i.dropBehaviour){t.ui.ddmanager.prepareOffsets(this,e)}this._normalizeRightBottom();this._mouseDrag(e,true);if(t.ui.ddmanager){t.ui.ddmanager.dragStart(this,e)}return true},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:false,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(e,true);this.positionAbs=this._convertPositionTo("absolute");if(!i){var s=this._uiHash();if(this._trigger("drag",e,s)===false){this._mouseUp({});return false}this.position=s.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if(t.ui.ddmanager){t.ui.ddmanager.drag(this,e)}return false},_mouseStop:function(e){var i=this,s=false;if(t.ui.ddmanager&&!this.options.dropBehaviour){s=t.ui.ddmanager.drop(this,e)}if(this.dropped){s=this.dropped;this.dropped=false}if(this.options.revert==="invalid"&&!s||this.options.revert==="valid"&&s||this.options.revert===true||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)){t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(i._trigger("stop",e)!==false){i._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(e){this._unblockFrames();if(t.ui.ddmanager){t.ui.ddmanager.dragStop(this,e)}if(this.handleElement.is(e.target)){this.element.focus()}return t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:true},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):i.helper==="clone"?this.element.clone().removeAttr("id"):this.element;if(!n.parents("body").length){n.appendTo(i.appendTo==="parent"?this.element[0].parentNode:i.appendTo)}if(s&&n[0]===this.element[0]){this._setPositionRelative()}if(n[0]!==this.element[0]&&!/(fixed|absolute)/.test(n.css("position"))){n.css("position","absolute")}return n},_setPositionRelative:function(){if(!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative"}},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(t.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this._isRootNode(this.offsetParent[0])){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0}}var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(!e?this.scrollParent.scrollTop():0),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(!e?this.scrollParent.scrollLeft():0)}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,r=this.document[0];this.relativeContainer=null;if(!n.containment){this.containment=null;return}if(n.containment==="window"){this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment==="document"){this.containment=[0,0,t(r).width()-this.helperProportions.width-this.margins.left,(t(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(n.containment.constructor===Array){this.containment=n.containment;return}if(n.containment==="parent"){n.containment=this.helper[0].parentNode}i=t(n.containment);s=i[0];if(!s){return}e=/(scroll|auto)/.test(i.css("overflow"));this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relativeContainer=i},_convertPositionTo:function(t,e){if(!e){e=this.position}var i=t==="absolute"?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-(this.cssPosition==="fixed"?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-(this.cssPosition==="fixed"?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,r,o=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;if(!a||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}}if(e){if(this.containment){if(this.relativeContainer){s=this.relativeContainer.offset();i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]}else{i=this.containment}if(t.pageX-this.offset.click.left<i[0]){l=i[0]+this.offset.click.left}if(t.pageY-this.offset.click.top<i[1]){h=i[1]+this.offset.click.top}if(t.pageX-this.offset.click.left>i[2]){l=i[2]+this.offset.click.left}if(t.pageY-this.offset.click.top>i[3]){h=i[3]+this.offset.click.top}}if(o.grid){n=o.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n;r=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;l=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-o.grid[0]:r+o.grid[0]:r}if(o.axis==="y"){l=this.originalPageX}if(o.axis==="x"){h=this.originalPageY}}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy()}},_normalizeRightBottom:function(){if(this.options.axis!=="y"&&this.helper.css("right")!=="auto"){this.helper.width(this.helper.width());this.helper.css("right","auto")}if(this.options.axis!=="x"&&this.helper.css("bottom")!=="auto"){this.helper.height(this.helper.height());this.helper.css("bottom","auto")}},_trigger:function(e,i,s){s=s||this._uiHash();t.ui.plugin.call(this,e,[i,s,this],true);if(/^(drag|start|stop)/.test(e)){this.positionAbs=this._convertPositionTo("absolute");s.offset=this.positionAbs}return t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[];t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");if(i&&!i.options.disabled){s.sortables.push(i);i.refreshPositions();i._trigger("activate",e,n)}})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=false;t.each(s.sortables,function(){var t=this;if(t.isOver){t.isOver=0;s.cancelHelperRemoval=true;t.cancelHelperRemoval=false;t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")};t._mouseStop(e);t.options.helper=t.options._helper}else{t.cancelHelperRemoval=true;t._trigger("deactivate",e,n)}})},drag:function(e,i,s){t.each(s.sortables,function(){var n=false,r=this;r.positionAbs=s.positionAbs;r.helperProportions=s.helperProportions;r.offset.click=s.offset.click;if(r._intersectsWith(r.containerCache)){n=true;t.each(s.sortables,function(){this.positionAbs=s.positionAbs;this.helperProportions=s.helperProportions;this.offset.click=s.offset.click;if(this!==r&&this._intersectsWith(this.containerCache)&&t.contains(r.element[0],this.element[0])){n=false}return n})}if(n){if(!r.isOver){r.isOver=1;r.currentItem=i.helper.appendTo(r.element).data("ui-sortable-item",true);r.options._helper=r.options.helper;r.options.helper=function(){return i.helper[0]};e.target=r.currentItem[0];r._mouseCapture(e,true);r._mouseStart(e,true,true);r.offset.click.top=s.offset.click.top;r.offset.click.left=s.offset.click.left;r.offset.parent.left-=s.offset.parent.left-r.offset.parent.left;r.offset.parent.top-=s.offset.parent.top-r.offset.parent.top;s._trigger("toSortable",e);s.dropped=r.element;t.each(s.sortables,function(){this.refreshPositions()});s.currentItem=s.element;r.fromOutside=s}if(r.currentItem){r._mouseDrag(e);i.position=r.position}}else{if(r.isOver){r.isOver=0;r.cancelHelperRemoval=true;r.options._revert=r.options.revert;r.options.revert=false;r._trigger("out",e,r._uiHash(r));r._mouseStop(e,true);r.options.revert=r.options._revert;r.options.helper=r.options._helper;if(r.placeholder){r.placeholder.remove()}s._refreshOffsets(e);i.position=s._generatePosition(e,true);s._trigger("fromSortable",e);s.dropped=false;t.each(s.sortables,function(){this.refreshPositions()})}}})}});t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),r=s.options;if(n.css("cursor")){r._cursor=n.css("cursor")}n.css("cursor",r.cursor)},stop:function(e,i,s){var n=s.options;if(n._cursor){t("body").css("cursor",n._cursor)}}});t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),r=s.options;if(n.css("opacity")){r._opacity=n.css("opacity")}n.css("opacity",r.opacity)},stop:function(e,i,s){var n=s.options;if(n._opacity){t(i.helper).css("opacity",n._opacity)}}});t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){if(!i.scrollParentNotHidden){i.scrollParentNotHidden=i.helper.scrollParent(false)}if(i.scrollParentNotHidden[0]!==i.document[0]&&i.scrollParentNotHidden[0].tagName!=="HTML"){i.overflowOffset=i.scrollParentNotHidden.offset()}},drag:function(e,i,s){var n=s.options,r=false,o=s.scrollParentNotHidden[0],a=s.document[0];if(o!==a&&o.tagName!=="HTML"){if(!n.axis||n.axis!=="x"){if(s.overflowOffset.top+o.offsetHeight-e.pageY<n.scrollSensitivity){o.scrollTop=r=o.scrollTop+n.scrollSpeed}else if(e.pageY-s.overflowOffset.top<n.scrollSensitivity){o.scrollTop=r=o.scrollTop-n.scrollSpeed}}if(!n.axis||n.axis!=="y"){if(s.overflowOffset.left+o.offsetWidth-e.pageX<n.scrollSensitivity){o.scrollLeft=r=o.scrollLeft+n.scrollSpeed}else if(e.pageX-s.overflowOffset.left<n.scrollSensitivity){o.scrollLeft=r=o.scrollLeft-n.scrollSpeed}}}else{if(!n.axis||n.axis!=="x"){if(e.pageY-t(a).scrollTop()<n.scrollSensitivity){r=t(a).scrollTop(t(a).scrollTop()-n.scrollSpeed)}else if(t(window).height()-(e.pageY-t(a).scrollTop())<n.scrollSensitivity){r=t(a).scrollTop(t(a).scrollTop()+n.scrollSpeed)}}if(!n.axis||n.axis!=="y"){if(e.pageX-t(a).scrollLeft()<n.scrollSensitivity){r=t(a).scrollLeft(t(a).scrollLeft()-n.scrollSpeed)}else if(t(window).width()-(e.pageX-t(a).scrollLeft())<n.scrollSensitivity){r=t(a).scrollLeft(t(a).scrollLeft()+n.scrollSpeed)}}}if(r!==false&&t.ui.ddmanager&&!n.dropBehaviour){t.ui.ddmanager.prepareOffsets(s,e)}}});t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[];t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();if(this!==s.element[0]){s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})}})},drag:function(e,i,s){var n,r,o,a,l,h,c,f,d,p,u=s.options,m=u.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,b=i.offset.top,_=b+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--){l=s.snapElements[d].left-s.margins.left;h=l+s.snapElements[d].width;c=s.snapElements[d].top-s.margins.top;f=c+s.snapElements[d].height;if(v<l-m||g>h+m||_<c-m||b>f+m||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)){if(s.snapElements[d].snapping){s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item}))}s.snapElements[d].snapping=false;continue}if(u.snapMode!=="inner"){n=Math.abs(c-_)<=m;r=Math.abs(f-b)<=m;o=Math.abs(l-v)<=m;a=Math.abs(h-g)<=m;if(n){i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top}if(r){i.position.top=s._convertPositionTo("relative",{top:f,left:0}).top}if(o){i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left}if(a){i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left}}p=n||r||o||a;if(u.snapMode!=="outer"){n=Math.abs(c-b)<=m;r=Math.abs(f-_)<=m;o=Math.abs(l-g)<=m;a=Math.abs(h-v)<=m;if(n){i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top}if(r){i.position.top=s._convertPositionTo("relative",{top:f-s.helperProportions.height,left:0}).top}if(o){i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left}if(a){i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left}}if(!s.snapElements[d].snapping&&(n||r||o||a||p)){s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item}))
}s.snapElements[d].snapping=n||r||o||a||p}}});t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,r=s.options,o=t.makeArray(t(r.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});if(!o.length){return}n=parseInt(t(o[0]).css("zIndex"),10)||0;t(o).each(function(e){t(this).css("zIndex",n+e)});this.css("zIndex",n+o.length)}});t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),r=s.options;if(n.css("zIndex")){r._zIndex=n.css("zIndex")}n.css("zIndex",r.zIndex)},stop:function(e,i,s){var n=s.options;if(n._zIndex){t(i.helper).css("zIndex",n._zIndex)}}});var l=t.ui.draggable;t.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=false;this.isout=true;this.accept=t.isFunction(s)?s:function(t){return t.is(s)};this.proportions=function(){if(arguments.length){e=arguments[0]}else{return e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(i.scope);i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[];t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){var e=0;for(;e<t.length;e++){if(t[e]===this){t.splice(e,1)}}},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if(e==="accept"){this.accept=t.isFunction(i)?i:function(t){return t.is(i)}}else if(e==="scope"){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s);this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(i){this._trigger("activate",e,this.ui(i))}},_deactivate:function(e){var i=t.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(i){this._trigger("deactivate",e,this.ui(i))}},_over:function(e){var i=t.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],i.currentItem||i.element)){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",e,this.ui(i))}},_out:function(e){var i=t.ui.ddmanager.current;if(!i||(i.currentItem||i.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],i.currentItem||i.element)){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",e,this.ui(i))}},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=false;if(!s||(s.currentItem||s.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");if(i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&t.ui.intersect(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)){n=true;return false}});if(n){return false}if(this.accept.call(this.element[0],s.currentItem||s.element)){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",e,this.ui(s));return this.element}return false},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}});t.ui.intersect=function(){function t(t,e,i){return t>=e&&t<e+i}return function(e,i,s,n){if(!i.offset){return false}var r=(e.positionAbs||e.position.absolute).left+e.margins.left,o=(e.positionAbs||e.position.absolute).top+e.margins.top,a=r+e.helperProportions.width,l=o+e.helperProportions.height,h=i.offset.left,c=i.offset.top,f=h+i.proportions().width,d=c+i.proportions().height;switch(s){case"fit":return h<=r&&a<=f&&c<=o&&l<=d;case"intersect":return h<r+e.helperProportions.width/2&&a-e.helperProportions.width/2<f&&c<o+e.helperProportions.height/2&&l-e.helperProportions.height/2<d;case"pointer":return t(n.pageY,c,i.proportions().height)&&t(n.pageX,h,i.proportions().width);case"touch":return(o>=c&&o<=d||l>=c&&l<=d||o<c&&l>d)&&(r>=h&&r<=f||a>=h&&a<=f||r<h&&a>f);default:return false}}}();t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,r=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;s<r.length;s++){if(r[s].options.disabled||e&&!r[s].accept.call(r[s].element[0],e.currentItem||e.element)){continue}for(n=0;n<a.length;n++){if(a[n]===r[s].element[0]){r[s].proportions().height=0;continue t}}r[s].visible=r[s].element.css("display")!=="none";if(!r[s].visible){continue}if(o==="mousedown"){r[s]._activate.call(r[s],i)}r[s].offset=r[s].element.offset();r[s].proportions({width:r[s].element[0].offsetWidth,height:r[s].element[0].offsetHeight})}},drop:function(e,i){var s=false;t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)){s=this._drop.call(this,i)||s}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)){this.isout=true;this.isover=false;this._deactivate.call(this,i)}});return s},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){if(!e.options.refreshPositions){t.ui.ddmanager.prepareOffsets(e,i)}})},drag:function(e,i){if(e.options.refreshPositions){t.ui.ddmanager.prepareOffsets(e,i)}t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var s,n,r,o=t.ui.intersect(e,this,this.options.tolerance,i),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;if(!a){return}if(this.options.greedy){n=this.options.scope;r=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n});if(r.length){s=t(r[0]).droppable("instance");s.greedyChild=a==="isover"}}if(s&&a==="isover"){s.isover=false;s.isout=true;s._out.call(s,i)}this[a]=true;this[a==="isout"?"isover":"isout"]=false;this[a==="isover"?"_over":"_out"].call(this,i);if(s&&a==="isout"){s.isout=false;s.isover=true;s._over.call(s,i)}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable");if(!e.options.refreshPositions){t.ui.ddmanager.prepareOffsets(e,i)}}};var h=t.ui.droppable;var c=t.widget("ui.sortable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){var t=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?t.axis==="x"||this._isFloating(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true},_setOption:function(t,e){this._super(t,e);if(t==="handle"){this._setHandleClassName()}},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--){this.items[t].item.removeData(this.widgetName+"-item")}return this},_mouseCapture:function(e,i){var s=null,n=false,r=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(e);t(e.target).parents().each(function(){if(t.data(this,r.widgetName+"-item")===r){s=t(this);return false}});if(t.data(e.target,r.widgetName+"-item")===r){s=t(e.target)}if(!s){return false}if(this.options.handle&&!i){t(this.options.handle,s).find("*").addBack().each(function(){if(this===e.target){n=true}});if(!n){return false}}this.currentItem=s;this._removeCurrentsFromItems();return true},_mouseStart:function(e,i,s){var n,r,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(e);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(e);this.originalPageX=e.pageX;this.originalPageY=e.pageY;o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(o.containment){this._setContainment()}if(o.cursor&&o.cursor!=="auto"){r=this.document.find("body");this.storedCursor=r.css("cursor");r.css("cursor",o.cursor);this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(r)}if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",o.opacity)}if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",o.zIndex)}if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",e,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!s){for(n=this.containers.length-1;n>=0;n--){this.containers[n]._trigger("activate",e,this._uiHash(this))}}if(t.ui.ddmanager){t.ui.ddmanager.current=this}if(t.ui.ddmanager&&!o.dropBehaviour){t.ui.ddmanager.prepareOffsets(this,e)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(e);return true},_mouseDrag:function(e){var i,s,n,r,o=this.options,a=false;this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed}else if(e.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed}if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed}else if(e.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed}}else{if(e.pageY-t(document).scrollTop()<o.scrollSensitivity){a=t(document).scrollTop(t(document).scrollTop()-o.scrollSpeed)}else if(t(window).height()-(e.pageY-t(document).scrollTop())<o.scrollSensitivity){a=t(document).scrollTop(t(document).scrollTop()+o.scrollSpeed)}if(e.pageX-t(document).scrollLeft()<o.scrollSensitivity){a=t(document).scrollLeft(t(document).scrollLeft()-o.scrollSpeed)}else if(t(window).width()-(e.pageX-t(document).scrollLeft())<o.scrollSensitivity){a=t(document).scrollLeft(t(document).scrollLeft()+o.scrollSpeed)}}if(a!==false&&t.ui.ddmanager&&!o.dropBehaviour){t.ui.ddmanager.prepareOffsets(this,e)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(i=this.items.length-1;i>=0;i--){s=this.items[i];n=s.item[0];r=this._intersectsWithPointer(s);if(!r){continue}if(s.instance!==this.currentContainer){continue}if(n!==this.currentItem[0]&&this.placeholder[r===1?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&(this.options.type==="semi-dynamic"?!t.contains(this.element[0],n):true)){this.direction=r===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(s)){this._rearrange(e,s)}else{break}this._trigger("change",e,this._uiHash());break}}this._contactContainers(e);if(t.ui.ddmanager){t.ui.ddmanager.drag(this,e)}this._trigger("sort",e,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,i){if(!e){return}if(t.ui.ddmanager&&!this.options.dropBehaviour){t.ui.ddmanager.drop(this,e)}if(this.options.revert){var s=this,n=this.placeholder.offset(),r=this.options.axis,o={};if(!r||r==="x"){o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)}if(!r||r==="y"){o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)}this.reverting=true;t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else{this._clear(e,i)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,this._uiHash(this));if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",null,this._uiHash(this));this.containers[e].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}t.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){t(this.domPosition.prev).after(this.currentItem)}else{t(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];e=e||{};t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);if(i){s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}});if(!s.length&&e.key){s.push(e.key+"=")}return s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];e=e||{};i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")});return s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,r=t.left,o=r+t.width,a=t.top,l=a+t.height,h=this.offset.click.top,c=this.offset.click.left,f=this.options.axis==="x"||s+h>a&&s+h<l,d=this.options.axis==="y"||e+c>r&&e+c<o,p=f&&d;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]){return p}else{return r<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&a<s+this.helperProportions.height/2&&n-this.helperProportions.height/2<l}},_intersectsWithPointer:function(t){var e=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),s=e&&i,n=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();if(!s){return false}return this.floating?r&&r==="right"||n==="down"?2:1:n&&(n==="down"?2:1)},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();if(this.floating&&n){return n==="right"&&i||n==="left"&&!i}else{return s&&(s==="down"&&e||s==="up"&&!e)}},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return t!==0&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return t!==0&&(t>0?"right":"left")},refresh:function(t){this._refreshItems(t);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,s,n,r,o=[],a=[],l=this._connectWith();if(l&&e){for(i=l.length-1;i>=0;i--){n=t(l[i]);for(s=n.length-1;s>=0;s--){r=t.data(n[s],this.widgetFullName);if(r&&r!==this&&!r.options.disabled){a.push([t.isFunction(r.options.items)?r.options.items.call(r.element):t(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r])}}}}a.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function h(){o.push(this)}for(i=a.length-1;i>=0;i--){a[i][0].each(h)}return t(o)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++){if(e[i]===t.item[0]){return false}}return true})},_refreshItems:function(e){this.items=[];this.containers=[this];var i,s,n,r,o,a,l,h,c=this.items,f=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready){for(i=d.length-1;i>=0;i--){n=t(d[i]);for(s=n.length-1;s>=0;s--){r=t.data(n[s],this.widgetFullName);if(r&&r!==this&&!r.options.disabled){f.push([t.isFunction(r.options.items)?r.options.items.call(r.element[0],e,{item:this.currentItem}):t(r.options.items,r.element),r]);this.containers.push(r)}}}}for(i=f.length-1;i>=0;i--){o=f[i][1];a=f[i][0];for(s=0,h=a.length;s<h;s++){l=t(a[s]);l.data(this.widgetName+"-item",o);c.push({item:l,instance:o,width:0,height:0,left:0,top:0})}}},refreshPositions:function(e){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var i,s,n,r;for(i=this.items.length-1;i>=0;i--){s=this.items[i];if(s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]){continue}n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item;if(!e){s.width=n.outerWidth();s.height=n.outerHeight()}r=n.offset();s.left=r.left;s.top=r.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(i=this.containers.length-1;i>=0;i--){r=this.containers[i].element.offset();this.containers[i].containerCache.left=r.left;this.containers[i].containerCache.top=r.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}}return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;if(!s.placeholder||s.placeholder.constructor===String){i=s.placeholder;s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(s==="tr"){e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)})}else if(s==="img"){n.attr("src",e.currentItem.attr("src"))}if(!i){n.css("visibility","hidden")}return n},update:function(t,n){if(i&&!s.forcePlaceholderSize){return}if(!n.height()){n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10))}if(!n.width()){n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}}e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem));e.currentItem.after(e.placeholder);s.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var i,s,n,r,o,a,l,h,c,f,d=null,p=null;for(i=this.containers.length-1;i>=0;i--){if(t.contains(this.currentItem[0],this.containers[i].element[0])){continue}if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0])){continue}d=this.containers[i];p=i}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",e,this._uiHash(this));this.containers[i].containerCache.over=0}}}if(!d){return}if(this.containers.length===1){if(!this.containers[p].containerCache.over){this.containers[p]._trigger("over",e,this._uiHash(this));this.containers[p].containerCache.over=1}}else{n=1e4;r=null;c=d.floating||this._isFloating(this.currentItem);o=c?"left":"top";a=c?"width":"height";f=c?"clientX":"clientY";for(s=this.items.length-1;s>=0;s--){if(!t.contains(this.containers[p].element[0],this.items[s].item[0])){continue}if(this.items[s].item[0]===this.currentItem[0]){continue}l=this.items[s].item.offset()[o];h=false;if(e[f]-l>this.items[s][a]/2){h=true}if(Math.abs(e[f]-l)<n){n=Math.abs(e[f]-l);r=this.items[s];this.direction=h?"up":"down"}}if(!r&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[p]){if(!this.currentContainer.containerCache.over){this.containers[p]._trigger("over",e,this._uiHash());this.currentContainer.containerCache.over=1}return}r?this._rearrange(e,r,null,true):this._rearrange(e,null,this.containers[p].element,true);this._trigger("change",e,this._uiHash());this.containers[p]._trigger("change",e,this._uiHash(this));this.currentContainer=this.containers[p];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[p]._trigger("over",e,this._uiHash(this));this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):i.helper==="clone"?this.currentItem.clone():this.currentItem;if(!s.parents("body").length){t(i.appendTo!=="parent"?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0])}if(s[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!s[0].style.width||i.forceHelperSize){s.width(this.currentItem.width())}if(!s[0].style.height||i.forceHelperSize){s.height(this.currentItem.height())}return s},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(t.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left"in e){this.offset.click.left=e.left+this.margins.left}if("right"in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top"in e){this.offset.click.top=e.top+this.margins.top}if("bottom"in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&t.ui.ie){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;if(n.containment==="parent"){n.containment=this.helper[0].parentNode}if(n.containment==="document"||n.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t(n.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(t(n.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(n.containment)){e=t(n.containment)[0];i=t(n.containment).offset();s=t(e).css("overflow")!=="hidden";this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,i){if(!i){i=this.position}var s=e==="absolute"?1:-1,n=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,r=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():r?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():r?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,r=e.pageX,o=e.pageY,a=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=/(html|body)/i.test(a[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(e.pageX-this.offset.click.left<this.containment[0]){r=this.containment[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<this.containment[1]){o=this.containment[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>this.containment[2]){r=this.containment[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>this.containment[3]){o=this.containment[3]+this.offset.click.top}}if(n.grid){i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i;s=this.originalPageX+Math.round((r-this.originalPageX)/n.grid[0])*n.grid[0];r=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?e.item[0]:e.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){if(n===this.counter){this.refreshPositions(!s)}})},_clear:function(t,e){this.reverting=false;var i,s=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!e){s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!e){s.push(function(t){this._trigger("update",t,this._uiHash())})}if(this!==this.currentContainer){if(!e){s.push(function(t){this._trigger("remove",t,this._uiHash())});s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer));s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))}}function n(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}for(i=this.containers.length-1;i>=0;i--){if(!e){s.push(n("deactivate",this,this.containers[i]))}if(this.containers[i].containerCache.over){s.push(n("out",this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(!e){this._trigger("beforeStop",t,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(!this.cancelHelperRemoval){if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null}if(!e){for(i=0;i<s.length;i++){s[i].call(this,t)}this._trigger("stop",t,this._uiHash())}this.fromOutside=false;return!this.cancelHelperRemoval},_trigger:function(){if(t.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})});var rpnblackboxmodule=function(){var t;var e;var i;var s;var n;var r=function(t,e,i,s,n,r,m,g,v,b,_,y,w){var P=function(t,e,i,s){switch(t){case"isNumberN":o(e,i,s);break;case"isNumberZ":a(e,i,s);break;case"isNumberD":h(e,i,s);break;case"isNumberQ":l(e,i,s);break;case"isNumber":c(e,i,s);break;case"withComma":f(e);break;case"firstPoint":d(e);break;case"firstComma":p(e);break;
case"firstPointComma":u(e);break;default:break}};$(t).bind("input propertychange",function(){P(n,t,e,i);P(r,t,e,i);P(m,t,e,i);P(g,t,e,i);P(v,t,e,i);P(b,t,e,i);P(_,t,e,i);P(y,t,e,i);P(w,t,e,i)})};var o=function(t,e,i){var s=$(t).val();var n=s.charAt(s.length-1);var r=s.substring(0,s.length-1);if(/[0-9]/.test(n)){if(/0/.test(r)&&r.length==1){$(t).val(n)}$(e).css("display","none")}else if(/,/.test(n)){$(t).val(s.substring(0,s.length-1))}else if(/\./.test(n)){$(t).val(s.substring(0,s.length-1))}else if(/-/.test(n)){$(t).val(s.substring(0,s.length-1))}else{$(t).val(r)}};var a=function(t,e,i){var s=$(t).val();var n=s.charAt(s.length-1);var r=s.substring(0,s.length-1);if(/[0-9]/.test(n)){if(/0/.test(r)&&r.length==1){$(t).val(n)}if(/-0/.test(r)&&r.length==2){$(t).val("-"+n)}$(e).css("display","none")}else if(/,/.test(n)){$(t).val(s.substring(0,s.length-1))}else if(/\./.test(n)){$(t).val(s.substring(0,s.length-1))}else if(/-/.test(n)){if(s.length>1){$(t).val(s.substring(0,s.length-1))}}else{$(t).val(r)}};var l=function(t,e,i){var s=$(t).val();var n=s.charAt(s.length-1);var r=s.substring(0,s.length-1);if(/[0-9]/.test(n)){if(/0/.test(r)&&r.length==1){$(t).val(n)}if(/-0/.test(r)&&r.length==2){$(t).val("-"+n)}$(e).css("display","none")}else if(/,/.test(n)){$(t).val(s.substring(0,s.length-1));$(i).text(monTexte);$(e).css("display","block")}else if(/\./.test(n)){$(t).val(s.substring(0,s.length-1))}else if(/-/.test(n)){if(s.length>1){$(t).val(s.substring(0,s.length-1))}}else{$(t).val(r)}};var h=function(t,e,i){var s=$(t).val(),n=s.charAt(s.length-1),r=s.substring(0,s.length-1);if(/[0-9]/.test(n)){if(/0/.test(r)&&r.length==1){$(t).val(n)}if(/-0/.test(r)&&r.length==2){$(t).val("-"+n)}$(e).css("display","none")}else if(/,/.test(n)){if(/,/.test(r.substring(0,s.length-1))){$(t).val(s.substring(0,s.length-1))}}else if(/\./.test(n)){if(/,/.test(r.substring(0,s.length-1))){$(t).val(s.substring(0,s.length-1))}}else if(/-/.test(n)){if(s.length>1){$(t).val(s.substring(0,s.length-1))}}else{$(t).val(r)}};var c=function(t,e,i){var s=$(t).val(),n=s.charAt(s.length-1),r=s.substring(0,s.length-1);if(/[0-9]/.test(n)){if(/0/.test(r)&&r.length==1){$(t).val(n)}if(/-0/.test(r)&&r.length==2){$(t).val("-"+n)}$(e).css("display","none")}else if(/,/.test(n)){if(/,/.test(r.substring(0,s.length-1))){$(t).val(s.substring(0,s.length-1))}}else if(/\./.test(n)){if(/,/.test(r.substring(0,s.length-1))){$(t).val(s.substring(0,s.length-1))}}else if(/-/.test(n)){if(s.length>1){$(t).val(s.substring(0,s.length-1))}}else{$(t).val(r)}};var f=function(t){var e=$(t).val(),i=e.charAt(e.length-1),s=e.substring(0,e.length-1);if(/,/.test(i)){if(/,/.test(s.substring(0,e.length-1))){$(t).val(e.substring(0,e.length-1))}}if(/\./.test(i)){if(/,/.test(s)){$(t).val(s.substring(0,s.length-1))}else{$(t).val(e.substring(0,e.length-1).concat(","))}}};var d=function(t){var e=$(t).val(),i=e.charAt(e.length-1),s=e.substring(0,e.length-1);if(/-/.test(s)&&/^\./.test(i)){$(t).val("-0.")}if(/^\./.test(e)){$(t).val("0.")}};var p=function(t){var e=$(t).val(),i=e.charAt(e.length-1),s=e.substring(0,e.length-1);if(/-/.test(s)&&/^,/.test(i)){$(t).val("-0,")}if(/^,/.test(e)){$(t).val("0,")}};var u=function(t){var e=$(t).val(),i=e.charAt(e.length-1),s=e.substring(0,e.length-1);if(/-/.test(s)&&/^\./.test(i)){$(t).val("-0,")}if(/^\./.test(e)){$(t).val("0,")}};var m=function(s,r,o){_.defaults(s,{operation:"x1",left:[1],right:[1],shuffle:false,validation:{mode:"lock",type:"integer"}});t=s;e=o;i=s.shuffle;if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){n=r}else{n=[];_.each(t.right,function(t,e){n.push({position:"right",originalposition:e,value:t,response:null})});_.each(t.left,function(t,e){n.push({position:"left",originalposition:e,value:t,response:null})});if(i)n=_.shuffle(n)}g()};var g=function(){e.addClass("blackbox,text-center");e.append($('<div class="row header"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><p class="text-center">x</p></div><div class="col-xs-2 operation"></div><div class="col-xs-2"><p class="text-center">y</p></div></div>'));$(".header",e).hide();_.each(n,function(i,s){if(i.position=="left"){e.append($('<div class="row"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><p class="text-center">'+i.value+'</p></div><div class="col-xs-2 operation"><p class="text-center"><i class="glyphicon glyphicon-minus"></i>'+t.operation+'<i class="glyphicon glyphicon-arrow-right"></i></p></div><div class="col-xs-2"><input type="text" data-bind="" class="rpnm_input form-control" style="text-align: center;"></div></div>'))}else{e.append($('<div class="row"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><input type="text" class="rpnm_input form-control" style="text-align: center;"></div><div class="col-xs-2 operation"><p class="text-center"><i class="glyphicon glyphicon-minus"></i>'+t.operation+'<i class="glyphicon glyphicon-arrow-right"></i></p></div><div class="col-xs-2"><p class="text-center">'+i.value+"</p></div></div>"))}});$.each($(".rpnm_input",e),function(t,e){$(e).val(n[t].response)});s=$("<button>",{"data-toggle":"button","class":"btn btn-link btn-xs",text:" "+rpnsequence.getLabels().BlackboxTableView}).prepend($('<i class="glyphicon glyphicon-resize-small"></i>'));e.append($('<p class="text-center"></p>').append(s));b()};var v=function(){$(".operation",e).slideToggle();$(".header",e).slideToggle()};var b=function(){s.click(function(){var t=$(this),e=this.lastChild;t.find("i").toggleClass("glyphicon-resize-small glyphicon-resize-full");e.nodeValue=" ";e.nodeValue=" "+(t.hasClass("showArchieved")?rpnsequence.getLabels().BlackboxTableView:rpnsequence.getLabels().BlackboxView);t.toggleClass("showArchieved");v()});rpnsequence.addvalidation($(".rpnm_input",e),t.validation)};var y=function(){$.each($(".rpnm_input",e),function(t,e){n[t].response=$(e).val()});rpnsequence.handleEndOfModule(n)};var w=function(t){var e=0;_.each(t.right,function(t,i){e+=_.findWhere(n,{position:"right",originalposition:i}).response==t?1:0});_.each(t.left,function(t,i){e+=_.findWhere(n,{position:"left",originalposition:i}).response==t?1:0});return e};return{init:m,validate:y,score:w}};var rpncardmazemodule=function(){var t;var e;var i;var s;var n;var r;var o;var a;var l;var h=function(i,o,a){_.defaults(i,{mazewidth:6,mazeheight:4,cards:[{label:"label",clue:"clue"}]});t=i;s=t.mazeheight;n=t.mazewidth;e=a;l=[];r=[];if(!_.isUndefined(o)&&!_.isNull(o)&&!_.isEmpty(o)){l=o}c()};var c=function(){e.addClass("cardmaze");e.append($('<div class="row"><div class="container maze"></div></div>'));_.each(t.cards,function(t,s){$(".maze",e).append($('<div class="col-xs-2 nopadding"></div>').append($('<div class="card'+(t.start?" start selectable":"")+(t.end?" end":"")+'"><p>'+t.label+"</p><p>"+t.clue+"</p></div>").data("cardId",s)));if(t.start){i=s;o=s}if(t.end){a=s}});f();_.each(l,function(t,e){$($(".card")[t]).trigger("click")})};var f=function(){_.each($(".card"),function(t,e){$(t).click(function(){if($(t).hasClass("start")||$(t).hasClass("selectable")||$(t).hasClass("selected")){if((e==i&&$(t).hasClass("start")||e==i+n||e==i-n||e==i-1||e==i+1)&&!$(t).hasClass("selected")){r.push(t)}else if($(t).hasClass("selected")){r=r.slice(0,_.indexOf(r,t)+1)}i=e;$(".selected").removeClass("selected");$(".selectable").removeClass("selectable");$(".card").removeClass("fromtop frombottom fromleft fromright totop tobottom toleft toright");_.each(r,function(t,e){if(e>0){var i=$(t).data("cardId")-$(r[e-1]).data("cardId");if(i==n){$(t).addClass("fromtop")}else if(i==-n){$(t).addClass("frombottom")}else if(i==1){$(t).addClass("fromleft")}else if(i==-1){$(t).addClass("fromright")}}if(e<r.length-1){var i=$(t).data("cardId")-$(r[e+1]).data("cardId");if(i==-n){$(t).addClass("tobottom")}else if(i==n){$(t).addClass("totop")}else if(i==-1){$(t).addClass("toright")}else if(i==1){$(t).addClass("toleft")}}$(t).addClass("selected")});if(e!=a){if(!(e+n>n*s)){$($(".card")[e+n]).addClass("selectable")}if(!(e-n<0)){$($(".card")[e-n]).addClass("selectable")}if(e%n!=0){$($(".card")[e-1]).addClass("selectable")}if((e+1)%n!=0){$($(".card")[e+1]).addClass("selectable")}}}})})};var d=function(){_.each(r,function(t,e){l[e]=$(t).data("cardId")});rpnsequence.handleEndOfModule(l)};var p=function(t){var e=0;_.each(t,function(t,i){e+=l[i]==t?1:0});return e};return{init:h,validate:d,score:p}};var rpnclockmodule=function(){var t;var e;var i;var s;var n=function(i,n,o){_.defaults(i,{random:true,hour:"10:10"});t=i;if(t.random){t.hour=Math.floor(Math.random()*24+1)+":"+Math.floor(Math.random()*59)}if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){s=n}else{s=t.hour}e=o;r()};var r=function(){e.addClass("clock");e.append($('<div id="rpnclock"></div>'));i=EduClock();i.init({hour:parseInt(s.split(":")[0]),minute:parseInt(s.split(":")[1])},$("#rpnclock"));o()};var o=function(){};var a=function(){var t=i.getCurrentTime();rpnsequence.handleEndOfModule(t.hour+":"+t.minute)};var l=function(t){return s==t?1:0};return{init:n,validate:a,score:l}};var EduClock=function(){var t;var e;var i;var s;var n;var r=false;var o;var a;var l;var h;var c;var f;var d;var p;var u;var m;var g;var v;var b=function(i,s){_.defaults(i,{margin:10,marginnumbers:-30,fontheight:15,hour:10,minute:10});e=i;v=e.hour>12;t=s;u="nothing";y()};var y=function(){i=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 0;"});s=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 1;"});n=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 2;"});t.append([i,s,n]);i=i[0];s=s[0];n=n[0];o=Math.min(t.width(),t.height());i.width=o;i.height=o;s.width=o;s.height=o;n.width=o;n.height=o;c=o/2-e.margin;f=c+e.marginnumbers;a=i.getContext("2d");l=s.getContext("2d");h=n.getContext("2d");h.translate(o/2,o/2);d=e.hour;p=e.minute;w();P();S()};var w=function(){l.save();l.font="15px Arial";l.lineWidth=3;l.beginPath();l.arc(o/2,o/2,o/2-e.margin,0,Math.PI*2,true);l.stroke();l.beginPath();l.arc(o/2,o/2,10,0,Math.PI*2,true);l.fill();l.fillStyle="#fff";l.beginPath();l.arc(o/2,o/2+c/2,c/4,0,Math.PI*2,true);l.fill();l.fillStyle="#000";var t=[1,2,3,4,5,6,7,8,9,10,11,12];var i=0;var n=0;l.font=e.fontheight+"px Arial";$.each(t,function(t,r){i=Math.PI/6*(r-3);n=l.measureText(r).width;l.fillText(r,s.width/2+Math.cos(i)*f-n/2,s.height/2+Math.sin(i)*f+e.fontheight/3)});l.translate(o/2,o/2);i=Math.PI/30;for(var r=1;r<=60;r++){var a=r%5==0;l.rotate(i);var h=a?8:2;var d=a?15:8;l.fillRect(c-d,-h/2,d,h)}l.translate(-o/2,-o/2);l.restore()};var P=function(){h.save();h.clearRect(-o/2,-o/2,o,o);m=(d*60+p)*.5%360*Math.PI/180-Math.PI/2;if(m<0){m+=2*Math.PI}g=p*6%360*Math.PI/180-Math.PI/2;if(g<0){g+=2*Math.PI}h.rotate(m);h.fillStyle="#000";h.fillRect(5,-4,c*.6,8);h.rotate(-m);h.fillStyle="#f00";h.rotate(g);h.fillRect(5,-2,c*.85,4);h.rotate(-g);h.restore();x()};var x=function(){var t=N();var e=t.hour*60+t.minute;var i=0;if(e>960&&e<1200){i=(1200-e)/2.4}if(e>240&&e<480){i=Math.abs((e-480)/2.4);i=100-i}if(e>=480&&e<=960){i=100}var s=C(new Color("ffffff"),new Color("428bca"),i);a.fillStyle=s.toRGB();a.fillRect(0,0,o,o)};var C=function(t,e,i){var s=i/100;var n=s*2-1;var r=t.toHSL().a-e.toHSL().a;var o=((n*r==-1?n:(n+r)/(1+n*r))+1)/2;var a=1-o;var l=[t.rgb[0]*o+e.rgb[0]*a,t.rgb[1]*o+e.rgb[1]*a,t.rgb[2]*o+e.rgb[2]*a];var h=t.alpha*s+e.alpha*(1-s);return new Color(l,h)};var I=function(t,e){var i=Math.atan2(e-o/2,t-o/2);if(i<0){i=i+2*Math.PI}return i};var k=function(t,i){u="nothing";var s=I(t,i);var n=Math.sqrt(Math.pow(i-o/2,2)+Math.pow(t-o/2,2));if(n<=o/2-e.margin){if(s>g-Math.PI/12&&s<g+Math.PI/12){u="minutes"}else if(s>m-Math.PI/6&&s<m+Math.PI/6){u="hours"}else{u="nothing"}}};var M=function(t,i){var s=Math.sqrt(Math.pow(i-o/2,2)+Math.pow(t-o/2,2));if(s<=o/2-e.margin){var n=I(t,i);n=n+Math.PI/2;if(n>2*Math.PI){n=n-2*Math.PI}if(u=="minutes"){var r=p;p=Math.round(30/Math.PI*n);if(p>=60){p=0}if(p<=15&&r>=45){d++}else if(p>=45&&r<=15){d--}if(d>11){console.log("currentHours:"+d+", PM:"+v);v=!v;d=0}else if(d<0){console.log("currentHours:"+d+", PM:"+v);v=!v;d=11}}else if(u=="hours"){var a=d;var l=Math.round(360/Math.PI*n);p=l%60;var h=Math.floor((l-p)/60);if(h==12){h=0}if(a<=11&&a>=9&&h>=0&&h<=3||a>=0&&a<=3&&h>=9&&h<=11){v=!v}d=h}P()}};var S=function(){$(n).on("mousedown",function(t){k(t.offsetX,t.offsetY);if(u!="nothing"){r=true}});$(n).on("mouseup",function(){r=false});$(n).on("mouseout",function(){r=false});$(n).on("mousemove",function(t){if(r&&u!="nothing"){M(t.offsetX,t.offsetY)}})};var N=function(){return{hour:d+(v?12:0),minute:p}};return{init:b,getCurrentTime:N}};var Color=function(t,e){if(Array.isArray(t)){this.rgb=t}else if(t.length==6){this.rgb=t.match(/.{2}/g).map(function(t){return parseInt(t,16)})}else{this.rgb=t.split("").map(function(t){return parseInt(t+t,16)})}this.alpha=typeof e==="number"?e:1};Color.prototype.type="Color";function toHex(t){return"#"+t.map(function(t){t=Math.min(Math.max(Math.round(t),0),255);return(t<16?"0":"")+t.toString(16)}).join("")}Color.prototype.luma=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255;t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4);e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4);i=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4);return.2126*t+.7152*e+.0722*i};Color.prototype.toRGB=function(){return toHex(this.rgb)};Color.prototype.toHSL=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255,s=this.alpha;var n=Math.max(t,e,i),r=Math.min(t,e,i);var o,a,l=(n+r)/2,h=n-r;if(n===r){o=a=0}else{a=l>.5?h/(2-n-r):h/(n+r);switch(n){case t:o=(e-i)/h+(e<i?6:0);break;case e:o=(i-t)/h+2;break;case i:o=(t-e)/h+4;break}o/=6}return{h:o*360,s:a,l:l,a:s}};Color.prototype.toHSV=function(){var t=this.rgb[0]/255,e=this.rgb[1]/255,i=this.rgb[2]/255,s=this.alpha;var n=Math.max(t,e,i),r=Math.min(t,e,i);var o,a,l=n;var h=n-r;if(n===0){a=0}else{a=h/n}if(n===r){o=0}else{switch(n){case t:o=(e-i)/h+(e<i?6:0);break;case e:o=(i-t)/h+2;break;case i:o=(t-e)/h+4;break}o/=6}return{h:o*360,s:a,v:l,a:s}};Color.prototype.toARGB=function(){return toHex([this.alpha*255].concat(this.rgb))};Color.prototype.compare=function(t){return t.rgb&&t.rgb[0]===this.rgb[0]&&t.rgb[1]===this.rgb[1]&&t.rgb[2]===this.rgb[2]&&t.alpha===this.alpha?0:undefined};var rpndragdropsortingmodule=function(){var t;var e;var i;var s=function(s,r,o){_.defaults(s,{todrag:["empty"],todrop:["empty too :'("]});t=s;e=o;if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){i=r}else{i={todrag:t.todrag,todrop:t.todrop}}n()};var n=function(){e.addClass("dragdropsorting");e.append($('<div class="row"><div class="container"><div class="col-md-2 col"><ul id="drag_this_'+e.attr("id")+'" class="dragthis list-unstyled"></ul></div></div><div class="row"><div class="container dropzonecontainer"></div></div>'));$.each(t.todrop,function(t,s){$(".dropzonecontainer",e).append($('<div class="col-md-2"><div class="droppable"><span class="lead">'+s+'</span><ul class="list-unstyled"></ul></div></div>'));if(!_.isUndefined(i[s])){_.each(i[s],function(e,i){$("ul",$(".droppable")[t]).append('<li class="draggable">'+e+"</li>")})}});$(".droppable ul",e).sortable({connectWith:".droppable ul",dropOnEmpty:true,placeholder:"droppable-placeholder",forcePlaceholderSize:true,distance:.5,receive:function(t,e){if($(e.sender[0]).hasClass("dragthis")){i.todrag.pop()}r()}});o();r()};var r=function(){if($(".dragthis li",e).length==0&&i.todrag.length>0){var t=_.last(i.todrag);$(".dragthis").append($('<li class="draggable">'+t+"</li>"));$(".dragthis").sortable({connectWith:".droppable ul",appendTo:"body",placeholder:"droppable-placeholder",forcePlaceholderSize:true,dropOnEmpty:true,distance:.5})}};var o=function(){};var a=function(){_.each($(".droppable",e),function(t,e){var s=[];$.each($(t).find("li"),function(t,e){s.push($(e).text())});i[$(t).find("span").text()]=s});rpnsequence.handleEndOfModule(i)};var l=function(t){var e=0;_.map(t,function(t,s){e+=_.intersection(i[s],t).length});return e};return{init:s,validate:a,score:l}};var rpndropdownmodule=function(){var t;var e;var i;var s=function(s,r,o){_.defaults(s,{sentence:"",circumstance:["",""]});t=s;e=o;if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){i=r}else{i=_.map(_.filter(t.items,function(t){return t.choice.length>1}),function(t,e){return""})}n()};var n=function(){e.addClass("dropdown");if(!_.isEmpty(t.circumstance[0])){e.append($('<hr style="border-top: 5px solid #ccc;"><p><b>'+t.circumstance[0]+"</b></p>"))}if(!_.isEmpty(t.sentence)){e.append($("<p>"+t.sentence+"</p>"))}if(!_.isEmpty(t.circumstance[1])){e.append($('<hr style="border-top: 5px solid #ccc;"><p><b>'+t.circumstance[1]+"</b></p>"))}var s=$('<div class="form-inline">');var n=0;$.each(t.items,function(e,r){if(r.choice.length==1){s.append(" "+r.choice[0]+" ")}else{var o=[];o[0]=$('<option value="" '+(i[n]==""?"selected":"")+"> ?</option>");$.each(t.items[e].choice,function(t,e){o[t+1]=$('<option value="'+e+'" '+(i[n]==e?"selected":"")+">"+e+"</option>")});s.append($('<select class="rpnm-input dropdown form-control">').append(o));n++}});e.append(s);r()};var r=function(){};var o=function(){i=_.map($("select",e),function(t,e){return $(t).val()});rpnsequence.handleEndOfModule(i)};var a=function(t){var e=0;_.each(t,function(t,s){e+=_.contains(t.alternative,i[s])?1:0});return e};return{init:s,validate:o,score:a}};var rpngapfullmodule=function(){var t;var e;var i;var s;var n=function(i,n,o){_.defaults(i,{sentence:"sentence not set!"});t=i;e=o;if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){s=n}else{s=t.sentence}r()};var r=function(){e.addClass("gapfull");e.append($("<p>"+t.sentence+'</p><input type="text" class="rpnm_input form-control">'));i=$(".rpnm_input",e);i.val(s);o()};var o=function(){};var a=function(){s=$(".rpnm_input",e).val();rpnsequence.handleEndOfModule(s)};var l=function(t){return s==t?1:0};return{init:n,validate:a,score:l}};var rpngapsimplemodule=function(){var t;var e;var i;var s;var n;var r;var o=function(s,n,o){_.defaults(s,{tofill:"tofill not set!<b>Read</b> documentation please!"});t=s;i=!_.isUndefined(s.fillers);e=o;if(!_.isUndefined(n)&&!_.isNull(n)&&!_.isEmpty(n)){r=n}else{r=_.map($("b",t.tofill),function(t,e){return""})}a()};var a=function(){e.addClass("gapsimple");var s=0;if(i){var o=$('<div class="gapsimpleddtoolbar">');$.each(t.fillers,function(t,i){var n=$('<span class="draggable ori">'+i+"</span> ").draggable({revert:"invalid",appendTo:e,helper:"clone"});o.append(n);s=s<n.width()?n.width():s});n=_.max(t.fillers,function(t){return t.length}).length;e.append(o)}e.append($('<div class="form-inline">'+t.tofill+"</div>"));$.each($("b",e),function(s,n){var o=$(n);var a="";if(i){var l=$('<b class="gapsimpleddresponse">');o.replaceWith(l);l.droppable({accept:".draggable",hoverClass:"gapsimpleddresponse-hover",drop:function(t,i){$(this).empty();$(this).append((i.draggable.hasClass("ori")?i.draggable.clone():i.draggable).removeClass("ori").draggable({revert:"invalid",appendTo:e,helper:"clone"}))}});if(!_.isEmpty(r[s])){var h=$('<span class="'+(_.isEmpty(r[s])?"":"draggable")+'">'+(_.isEmpty(r[s])?"":r[s])+"</span>");l.append(h.draggable({revert:"invalid",appendTo:e,helper:"clone"}))}}else{var c=_.isUndefined(t.validation.align)?"":" "+t.validation.align;var f=_.isUndefined(t.validation.width)?"":" style='width:"+t.validation.width+"'";if(o.text().substr(-1)!="_"){a=_.isEmpty(o.text())?"":"<strong>("+o.text()+")</strong>";o.replaceWith($('<span class="text-nowrap"><input type="text" class="rpnm_input gapsimple form-control'+c+'"'+f+">"+a+"</span>"))}else{a=o.text().slice(0,-1);o.replaceWith($('<span class="text-nowrap">'+a+'<input type="text" class="rpnm_input gapsimple form-control'+c+'"'+f+"></span>"))}$($(".rpnm_input",e)[s]).val(r[s])}});l()};var l=function(){rpnsequence.addvalidation($(".rpnm_input",e),t.validation)};var h=function(){if(i){_.each($(".gapsimpleddresponse",e),function(t,e){r[e]=$(".draggable",$(t)).text()})}else{$.each($(".gapsimple",e),function(t,e){r[t]=$(e).val()})}rpnsequence.handleEndOfModule(r)};var c=function(t){var e=0;_.each(t,function(t,i){e+=r[i]==t?1:0});return e};return{init:o,validate:h,score:c}};var rpnmarkermodule=function(){var t;var e;var i;var s=function(s,r,o){_.defaults(s,{markers:[],tomark:["fill tomark please!"],hidden:false,smallButtons:false});t=s;e=o;if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){i=r}else{var a=["#8d61a4","#01a271","#5dc2e7","#ed656a","#f5a95e","#eee227","#63b553","#e95c7b","#f5a95e","#d62b81","#eee227"];i={selectedMarker:"",responses:_.map($("b",t.tomark),function(t,e){return""}),markers:_.map(t.markers,function(t,e){return{label:t,color:a[e]||"#222"}})}}n()};var n=function(){e.addClass("marker");var s=$("<div>",{"class":"btn-group","data-toggle":"buttons"});s.append($('<label class="btn btn-default '+(t.smallButtons?"":"btn-lg ")+(i.selectedMarker==""?"active":"")+' eraser"><input type="radio" name="options" autocomplete="off" '+(i.selectedMarker==""?"checked":"")+'><span class="edicons-tool-eraser"></span> '+rpnsequence.getLabels().Eraser+"</label>").click(function(){i.selectedMarker={color:"",label:""}}));$.each(i.markers,function(e,n){s.append($('<label class="btn btn-default '+(t.smallButtons?"":"btn-lg ")+(i.selectedMarker==n.label?"active":"")+' stab"><input type="radio" name="options" autocomplete="off" '+(i.selectedMarker==n.label?"checked":"")+'><span class="edicons-tool-stab" style="color:'+n.color+'"></span> '+n.label+"</label>").click(function(){i.selectedMarker=n}))});e.append(s);if(!_.isUndefined(t.background)){if(_.isUndefined(t.background.url)){rpnsequence.log("background defined without url!");e.append($('<div class="markable" >'+t.tomark+"</div>"))}else{_.defaults(t.background,{width:"0px",height:"0px",paddingTop:"0px",paddingRight:"0px",paddingBottom:"0px",paddingLeft:"0px"});e.append($('<div class="markable" style="width:'+t.background.width+";height:"+t.background.height+";padding-top:"+t.background.paddingTop+";padding-right:"+t.background.paddingRight+";padding-bottom:"+t.background.paddingBottom+";padding-left:"+t.background.paddingLeft+";background-image:url("+rpnsequence.computeMediaUrl(t.background.url)+');background-repeat:no-repeat;background-size:contain">'+t.tomark+"</div>"))}}else{e.append($('<div class="markable" >'+t.tomark+"</div>"))}$.each($("b",e),function(e,s){var n=$(s);if(!_.isEmpty(i.responses[e])){n.css("background-color",_.findWhere(i.markers,{label:i.responses[e]}).color)}if(!t.hidden){n.css("cursor","pointer")}else{n.css("font-weight","normal")}n.click(function(){n.css("background-color",i.selectedMarker.color);i["responses"][e]=i.selectedMarker.label})});r()};var r=function(){};var o=function(){rpnsequence.handleEndOfModule(i)};var a=function(t){var e=0;_.each(t,function(t,s){e+=i.responses[s]==t?1:0});return e};return{init:s,validate:o,score:a}};var rpnmqcmodule=function(){var t;var e;var i;var s=function(s,r,o){_.defaults(s,{questions:["No questions!"],answers:["As no answers"],vertical:false});t=s;e=o;if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){i=r}else{i={responses:_.map(t.questions,function(t,e){return""})}}n()};var n=function(){e.addClass("mqc");var s=$("<ul>",{"class":"list-unstyled"});$.each(t.questions,function(e,n){var r=$("<li>");r.append($("<p>"+n+"</p>"));var o=$('<div class="'+(t.vertical?"btn-group-vertical":"btn-group")+'" role="group" data-toggle="buttons">');var a=t.answers.length==1?0:e;$.each(t.answers[a].choice,function(t,s){o.append($('<label class="btn btn-default '+(!_.isEmpty(i.responses[e])&&i.responses[e]==s?"active":"")+'"><input type="radio" autocomplete="off" '+(!_.isEmpty(i.responses[e])&&i.responses[e]==s?"checked":"")+">"+s+"</label>").click(function(){i.responses[e]=s}));r.append(o)});s.append(r)});e.append(s);r()};var r=function(){};var o=function(){rpnsequence.handleEndOfModule(i)};var a=function(t){var e=0;_.each(t,function(t,s){e+=i.responses[s]==t?1:0});return e};return{init:s,validate:o,score:a}};var rpnsequence=function(){var t;var e;var i;var s;var n;var r;var o;var a;var l;var h;var c;var f;var d;var p;var u;var m;var g;var v;var b;var y;var w={en:{Recall:"Recall",Order:"Order",Warning:"Warning",BeforeUnloadMsg:"Module running!",Wait:"Please wait...",Validate:"Next",EndSequence:"Continue",Eraser:"Eraser",DragDropNotEmpty:"There are still some items to sort!",CardMazeNotEnded:"You have not finished the maze!",BlackboxTableView:"Values table",BlackboxView:"Blackbox",Quit:"Quit"},fr:{Recall:"Rappel",Order:"Consignes",Warning:"Attention",BeforeUnloadMsg:"Exercice en cours!",Wait:"Veuillez patienter...",Validate:"Suite",EndSequence:"Continuer",Eraser:"Effaceur",DragDropNotEmpty:"Il y a encore des lments  trier!",CardMazeNotEnded:"Vous n'avez pas termin le labyrinthe!",BlackboxTableView:"Tableau de valeurs",BlackboxView:"Bote noire",Quit:"Quitter"}};var P=function(i){if(_.isUndefined(i)){i={}}_.defaults(i,{sequrl:"seq.json",solurl:"sol.json",stateurl:"sta.json",warnonexit:false,domelem:$("body"),onsequenceend:function(t,e){},onmoduleend:function(){},mediapathformatter:function(t){return"medias/"+t},language:"en",debug:false,disablestateloading:false,navigationEnabled:false,quitDisabled:false});b=w[i.language];r=[];y=[];o=i.warnonexit;n=i.solurl;g=i.debug;v=!i.disablestateloading;f=i.domelem;a=i.onsequenceend;l=i.onmoduleend;h=i.mediapathformatter;u=i.quitDisabled;$.getJSON(i.sequrl,function(s){_.defaults(s,{title:"sequencetitle",modules:[]});t=s;_.each(t.modules,function(t,e){t["status"]="init"});e=0;m=i.navigationEnabled&&t.modules.length>1;if(v){$.getJSON(i.stateurl,function(e){r=_.map(t.modules,function(t,i){return{state:e.states[i]}});x()}).error(function(){r=_.map(t.modules,function(t,e){return{state:undefined}});x()})}else{r=_.map(t.modules,function(t,e){return{state:undefined}});x()}})};var x=function(){i=$("<div></div>");f.append([$('<button id="rpnm_quit" class="btn btn-link pull-right hidden-xs hidden-sm">'+b.Quit+' <i class="glyphicon glyphicon-remove-circle"></i></button>'),$('<div class="container" id="rpnm"></div>').append([$('<div class="row page-header"><div class="col-md-7"><h1 id="rpnm_seq_title"></h1></div><div class="col-md-5"><nav id="rpnm_modulenav"><ul class="pagination pagination-sm"></ul></nav></div></div>'),i,$('<div class="row"><div class="col-md-12"><em id="rpnm_source" class="pull-right"></em></div></div>'),$('<div class="row"><div class="col-md-12"><button id="rpnm_validation" class="btn btn-primary pull-right"></button></div></div>')])]);f.append($('<div id="rpnm_recall_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-bell"></i> '+b.Recall+'</h4></div><div class="modal-body"></div></div></div></div>'));f.append($('<div id="rpnm_order_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-question-sign"></i> '+b.Order+'</h4></div><div class="modal-body"></div></div></div></div>'));f.append($('<div id="rpnm_alert_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-warning-sign"></i> '+b.Warning+'</h4></div><div class="modal-body"></div></div></div></div>'));f.append($('<div id="rpnm_wait_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">'+b.Wait+'</h4></div><div class="modal-body"><div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"><span class="sr-only">100% completed</span></div></div></div></div></div></div>'));$("#rpnm_seq_title").html(t.title);d=$("#rpnm_validation");p=$("#rpnm_quit");if(u){p.hide()}s=$("#rpnm_source");c=$("#rpnm_alert_modal");if(!m){$("#rpnm_modulenav").remove()}_.each(t.modules,function(t,e){_.defaults(t,{disposition:"top"});var s=$('<button class="btn btn-default btn-sm pull-right" href="#" data-toggle="modal" data-target="#rpnm_order_modal"><i class="glyphicon glyphicon-question-sign"></i> '+b.Order+"</button>");var n=$('<button class="btn btn-default btn-sm pull-right" href="#" data-toggle="modal" data-target="#rpnm_recall_modal"><i class="glyphicon glyphicon-bell"></i> '+b.Recall+"</button>");var o=$('<div id="rpnm_context"></div>');var a=$('<div id="rpnm_directive"></div>');o.html(t.context);a.html(t.directive);var l=$("<div>");var h=$('<div class="row"></div>').append($('<div class="col-md-12"></div>').append($('<h2 id="rpnm_title">'+(_.isUndefined(t.title)?"":t.title)+"</h2>").append([s,n])));if(_.isUndefined(t.recall)){n.hide()}if(_.isUndefined(t.order)){s.hide()}var c=$('<div id="rpnm_inst_'+e+'" class="rpnm_instance">').append(h);if(t.disposition=="bottom"){c.append($('<div class="row"></div>').append($('<div class="col-md-12"></div>').append([l,o,a])))}else if(t.disposition=="left"){c.append($('<div class="row"></div>').append([$('<div class="col-md-6"></div>').append([o,a]),$('<div class="col-md-6"></div>').append(l)]))}else if(t.disposition=="right"){c.append($('<div class="row"></div>').append([$('<div class="col-md-6"></div>').append(l),$('<div class="col-md-6"></div>').append([o,a])]))}else{c.append($('<div class="row"></div>').append($('<div class="col-md-12"></div>').append([o,a,l])))}_.isUndefined(t.context)?o.hide():o.show().html(t.context);_.isUndefined(t.directive)?a.hide():a.show().html(t.directive);i.append(c);if(_.isNull(r[e]).state){_.isNull(r[e]).state=undefined}if(t.type=="marker"){y[e]=rpnmarkermodule();y[e].init(t,r[e].state,l)}else if(t.type=="mqc"){y[e]=rpnmqcmodule();y[e].init(t,r[e].state,l)}else if(t.type=="gapsimple"){y[e]=rpngapsimplemodule();y[e].init(t,r[e].state,l)}else if(t.type=="gapfull"){y[e]=rpngapfullmodule();y[e].init(t,r[e].state,l)}else if(t.type=="clock"){y[e]=rpnclockmodule();y[e].init(t,r[e].state,l)}else if(t.type=="blackbox"){y[e]=rpnblackboxmodule();y[e].init(t,r[e].state,l)}else if(t.type=="dragdropsorting"){y[e]=rpndragdropsortingmodule();y[e].init(t,r[e].state,l)}else if(t.type=="cardmaze"){y[e]=rpncardmazemodule();y[e].init(t,r[e].state,l)}else if(t.type=="dropdown"){y[e]=rpndropdownmodule();y[e].init(t,r[e].state,l)}else if(t.type=="sorting"){y[e]=rpnsortingmodule();y[e].init(t,r[e].state,l)}c.hide();if(t.type!="gapfull"){l.disableSelection()}$("#rpnm_modulenav ul").append($('<li><a href="#">'+(e+1)+"</a></li>"))});if(o){$(window).bind("beforeunload",function(t){return b.BeforeUnloadMsg})}C();I()};var C=function(){d.click(function(){y[e].validate();if(e==t.modules.length-1){S()}else{e++;I()}});p.click(function(){y[e].validate();S()});if(m&&t.modules.length>1){_.each($("#rpnm_modulenav ul li"),function(t,i){$(t).click(function(){y[e].validate();e=i;I()})})}};var I=function(){$("#rpnm_wait_modal").modal({show:true,backdrop:"static",keyboard:false});var i=t.modules[e];_.defaults(i,{title:"title"});$(".rpnm_instance").hide();var s=$("#rpnm_inst_"+e);k(i);H();if(m){$("#rpnm_modulenav ul li").removeClass("active");$($("#rpnm_modulenav ul li")[e]).addClass("active")}if(e==t.modules.length-1){d.html(b.EndSequence+' <i class="glyphicon glyphicon glyphicon-ok-circle"></i>').removeClass("btn-primary").addClass("btn-success")}else{d.html(b.Validate+' <i class="glyphicon glyphicon-chevron-right"></i>').removeClass("btn-success").addClass("btn-primary")
}s.show();$("#rpnm_wait_modal").modal("hide")};var k=function(t){if(!_.isUndefined(t.recall)){$("#rpnm_recall_modal .modal-body").html(t.recall)}if(!_.isUndefined(t.order)){$("#rpnm_order_modal .modal-body").html(t.order)}s.html(_.isUndefined(t.sources)?"":t.sources)};var M=function(i){$("#rpnm_wait_modal").modal({show:true,backdrop:"static",keyboard:false});E("End of module");r[e]={state:i};l({states:_.map(r,function(t){return t.state})});t.modules[e].status="ended"};var S=function(){E("End of sequence");E(JSON.stringify({states:_.map(r,function(t){return t.state})},null,"	"));$.getJSON(n,function(t){var e=0;_.each(t.solutions,function(t,i){e+=y[i].score(t)});E("Calculated total score for sequence "+e);if(o){$(window).unbind("beforeunload")}a({states:_.map(r,function(t){return t.state})},e)})};var N=function(t,e){$("#rpnm_alert_modal .modal-body").text(t);c.modal();c.on("hidden.bs.modal",function(){if(!_.isUndefined(e)){e()}})};var E=function(t){if(g){console.log(t)}};var H=function(){_.each($("img:not(.rpnm-img, .rpnm-mediapath)"),function(t,e){var i=$(t);i.attr("src",h($(t).attr("src"))).addClass("rpnm-mediapath");if(i.is(".modal-body img")){i.addClass("img-responsive img-rounded")}})};var T=function(){return b};var O=function(t,e){if(_.isUndefined(e)){return}_.defaults(e,{mode:"lock",type:"natural"});$(t).bind("cut copy paste",function(t){t.preventDefault()});if(e.mode=="lock"){$(t).bind("input propertychange",function(){if(e.type=="natural"){var t=/(^-?[0-9]\d*)/.exec($(this).val());if(t==""||t==null||t==0){$(this).val("")}else if(isNaN(t)){$(this).val(parseInt(t))}}else if(e.type=="integer"){var t=/[-0-9]\d*/.exec($(this).val());if(t==""||t==null){$(this).val("")}else if(t=="-"){$(this).val("-")}else if(t=="-0"){$(this).val("-")}else if(t=="00"){$(this).val("0")}else{$(this).val(parseInt(t))}}else if(e.type=="posdecimal"){var i=$(this).val().replace(",",".");var t=/^[.\d]\d*\.?\d*/.exec(i);if($(this).val().match(/^0[^,\.]/)){var s=$(this).val().replace(",",".").substring(0,1);var t=/^[-.\d]\d*.?\d*/.exec(s)}if($(this).val().match(/^-/)){var s=$(this).val().replace(",",".");var t=/[.\d]\d*.?\d*/.exec(s)}if(t==""||t==null){t=""}else if(t=="."){t="0."}$(this).val(t)}else if(e.type=="decimal"){var i=$(this).val().replace(",",".");var t=/^[-.\d]\d*\.?\d*/.exec(i);if($(this).val().match(/^-/)){if($(this).val().substring(1).match(/^0[^,\.]/)){var s=$(this).val().replace(",",".").substring(2);var t=/^[-.\d]\d*.?\d*/.exec(s)}else{var s=$(this).val().replace(",",".").substring(1);var t=/^[-.\d]\d*.?\d*/.exec(s)}var n=true}if($(this).val().match(/^0[^,\.]/)){var s=$(this).val().replace(",",".").substring(0,1);var t=/^[-.\d]\d*.?\d*/.exec(s)}if($(this).val().match(/^-/)){var s=$(this).val().replace(",",".");var t=/[.\d]\d*.?\d*/.exec(s)}if(t==""||t==null){t=""}else if(t=="."){t="0."}if(n){$(this).val("-"+t)}else{$(this).val(t)}}else if(e.type=="lowercase"){var i=$(this).val().toLowerCase();var t=/[a-z]*/.exec(i);if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="familycase"){var t=/^[A-Za-z][a-z]*/.exec($(this).val());if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="uppercase"){var i=$(this).val().toUpperCase();var t=/[A-Z]*/.exec(i);if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}else if(e.type=="letter"){var t=/[A-Za-z]*/.exec($(this).val());if(t==""||t==null){$(this).val("")}else{$(this).val(t)}}})}};var A=function(t){return h(t)};return{init:P,buildUi:x,handleEndOfModule:M,displayAlert:N,log:E,getLabels:T,addvalidation:O,computeMediaUrl:A}}();var rpnsortingmodule=function(){var t;var e;var i;var s=function(s,r,o){_.defaults(s,{sentence:["sentence","not","set!"],shuffle:false});t=s;e=o;if(!_.isUndefined(r)&&!_.isNull(r)&&!_.isEmpty(r)){i=r}else{i=t.sentence;if(t.shuffle){i=_.shuffle(i)}}n()};var n=function(){e.addClass("sorting");var t=$('<ul class="list-unstyled list-inline"></ul>');_.each(i,function(e,i){t.append($("<li>"+e+"</li>"))});e.append(t);t.sortable({placeholder:"sorting-highlight",tolerance:"pointer"});$("#sortable").disableSelection();r()};var r=function(){};var o=function(){i=_.map($("li",e),function(t,e){return $(t).text()});rpnsequence.handleEndOfModule(i)};var a=function(t){var e=0;e=_.isEqual(i,t)?1:0;return e};return{init:s,validate:o,score:a}};
//# sourceMappingURL=rpnmodule.0.1.6.min.js.map