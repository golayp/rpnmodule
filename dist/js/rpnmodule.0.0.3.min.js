(function(e){e.fn.disableSelection=function(){return this.attr("unselectable","on").css("user-select","none").on("selectstart",false)}})(jQuery);!function(e,t,n,i){var a,r={drag:true,drop:true,exclude:"",nested:true,vertical:true},s={afterMove:function(e,t,n){},containerPath:"",containerSelector:"ol, ul",distance:0,delay:0,handle:"",itemPath:"",itemSelector:"li",isValidTarget:function(e,t){return true},onCancel:function(e,t,n,i){},onDrag:function(e,t,n,i){e.css(t)},onDragStart:function(t,n,i,a){t.css({height:t.height(),width:t.width()});t.addClass("dragged");e("body").addClass("dragging")},onDrop:function(t,n,i,a){t.removeClass("dragged").removeAttr("style");e("body").removeClass("dragging")},onMousedown:function(e,t,n){if(!n.target.nodeName.match(/^(input|select)$/i)){n.preventDefault();return true}},placeholder:'<li class="placeholder"/>',pullPlaceholder:true,serialize:function(t,n,i){var a=e.extend({},t.data());if(i)return[n];else if(n[0]){a.children=n}delete a.subContainers;delete a.sortable;return a},tolerance:0},o={},l=0,c={left:0,top:0,bottom:0,right:0},a={start:"touchstart.sortable mousedown.sortable",drop:"touchend.sortable touchcancel.sortable mouseup.sortable",drag:"touchmove.sortable mousemove.sortable",scroll:"scroll.sortable"},d="subContainers";function u(e,t){var n=Math.max(0,e[0]-t[0],t[0]-e[1]),i=Math.max(0,e[2]-t[1],t[1]-e[3]);return n+i}function f(t,n,i,a){var r=t.length,s=a?"offset":"position";i=i||0;while(r--){var o=t[r].el?t[r].el:e(t[r]),l=o[s]();l.left+=parseInt(o.css("margin-left"),10);l.top+=parseInt(o.css("margin-top"),10);n[r]=[l.left-i,l.left+o.outerWidth()+i,l.top-i,l.top+o.outerHeight()+i]}}function h(e,t){var n=t.offset();return{left:e.left-n.left,top:e.top-n.top}}function p(e,t,n){t=[t.left,t.top];n=n&&[n.left,n.top];var i,a=e.length,r=[];while(a--){i=e[a];r[a]=[a,u(i,t),n&&u(i,n)]}r=r.sort(function(e,t){return t[1]-e[1]||t[2]-e[2]||t[0]-e[0]});return r}function v(t){this.options=e.extend({},s,t);this.containers=[];if(!this.options.rootGroup){this.scrollProxy=e.proxy(this.scroll,this);this.dragProxy=e.proxy(this.drag,this);this.dropProxy=e.proxy(this.drop,this);this.placeholder=e(this.options.placeholder);if(!t.isValidTarget)this.options.isValidTarget=i}}v.get=function(e){if(!o[e.group]){if(e.group===i)e.group=l++;o[e.group]=new v(e)}return o[e.group]};v.prototype={dragInit:function(t,n){this.$document=e(n.el[0].ownerDocument);this.item=e(t.target).closest(this.options.itemSelector);this.itemContainer=n;if(this.item.is(this.options.exclude)||!this.options.onMousedown(this.item,s.onMousedown,t)){return}this.setPointer(t);this.toggleListeners("on");this.setupDelayTimer();this.dragInitDone=true},drag:function(e){if(!this.dragging){if(!this.distanceMet(e)||!this.delayMet)return;this.options.onDragStart(this.item,this.itemContainer,s.onDragStart,e);this.item.before(this.placeholder);this.dragging=true}this.setPointer(e);this.options.onDrag(this.item,h(this.pointer,this.item.offsetParent()),s.onDrag,e);var t=e.pageX||e.originalEvent.pageX,n=e.pageY||e.originalEvent.pageY,i=this.sameResultBox,a=this.options.tolerance;if(!i||i.top-a>n||i.bottom+a<n||i.left-a>t||i.right+a<t)if(!this.searchValidTarget())this.placeholder.detach()},drop:function(e){this.toggleListeners("off");this.dragInitDone=false;if(this.dragging){if(this.placeholder.closest("html")[0])this.placeholder.before(this.item).detach();else this.options.onCancel(this.item,this.itemContainer,s.onCancel,e);this.options.onDrop(this.item,this.getContainer(this.item),s.onDrop,e);this.clearDimensions();this.clearOffsetParent();this.lastAppendedItem=this.sameResultBox=i;this.dragging=false}},searchValidTarget:function(e,t){if(!e){e=this.relativePointer||this.pointer;t=this.lastRelativePointer||this.lastPointer}var n=p(this.getContainerDimensions(),e,t),a=n.length;while(a--){var r=n[a][0],s=n[a][1];if(!s||this.options.pullPlaceholder){var o=this.containers[r];if(!o.disabled){if(!this.$getOffsetParent()){var l=o.getItemOffsetParent();e=h(e,l);t=h(t,l)}if(o.searchValidTarget(e,t))return true}}}if(this.sameResultBox)this.sameResultBox=i},movePlaceholder:function(e,t,n,i){var a=this.lastAppendedItem;if(!i&&a&&a[0]===t[0])return;t[n](this.placeholder);this.lastAppendedItem=t;this.sameResultBox=i;this.options.afterMove(this.placeholder,e,t)},getContainerDimensions:function(){if(!this.containerDimensions)f(this.containers,this.containerDimensions=[],this.options.tolerance,!this.$getOffsetParent());return this.containerDimensions},getContainer:function(e){return e.closest(this.options.containerSelector).data(n)},$getOffsetParent:function(){if(this.offsetParent===i){var e=this.containers.length-1,t=this.containers[e].getItemOffsetParent();if(!this.options.rootGroup){while(e--){if(t[0]!=this.containers[e].getItemOffsetParent()[0]){t=false;break}}}this.offsetParent=t}return this.offsetParent},setPointer:function(e){var t=this.getPointer(e);if(this.$getOffsetParent()){var n=h(t,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer;this.relativePointer=n}this.lastPointer=this.pointer;this.pointer=t},distanceMet:function(e){var t=this.getPointer(e);return Math.max(Math.abs(this.pointer.left-t.left),Math.abs(this.pointer.top-t.top))>=this.options.distance},getPointer:function(e){return{left:e.pageX||e.originalEvent.pageX,top:e.pageY||e.originalEvent.pageY}},setupDelayTimer:function(){var e=this;this.delayMet=!this.options.delay;if(!this.delayMet){clearTimeout(this._mouseDelayTimer);this._mouseDelayTimer=setTimeout(function(){e.delayMet=true},this.options.delay)}},scroll:function(e){this.clearDimensions();this.clearOffsetParent()},toggleListeners:function(t){var n=this,i=["drag","drop","scroll"];e.each(i,function(e,i){n.$document[t](a[i],n[i+"Proxy"])})},clearOffsetParent:function(){this.offsetParent=i},clearDimensions:function(){this.traverse(function(e){e._clearDimensions()})},traverse:function(e){e(this);var t=this.containers.length;while(t--){this.containers[t].traverse(e)}},_clearDimensions:function(){this.containerDimensions=i},_destroy:function(){o[this.options.group]=i}};function g(t,n){this.el=t;this.options=e.extend({},r,n);this.group=v.get(this.options);this.rootGroup=this.options.rootGroup||this.group;this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;var i=this.rootGroup.options.itemPath;this.target=i?this.el.find(i):this.el;this.target.on(a.start,this.handle,e.proxy(this.dragInit,this));if(this.options.drop)this.group.containers.push(this)}g.prototype={dragInit:function(e){var t=this.rootGroup;if(!this.disabled&&!t.dragInitDone&&this.options.drag&&this.isValidDrag(e)){t.dragInit(e,this)}},isValidDrag:function(e){return e.which==1||e.type=="touchstart"&&e.originalEvent.touches.length==1},searchValidTarget:function(e,t){var n=p(this.getItemDimensions(),e,t),i=n.length,a=this.rootGroup,r=!a.options.isValidTarget||a.options.isValidTarget(a.item,this);if(!i&&r){a.movePlaceholder(this,this.target,"append");return true}else while(i--){var s=n[i][0],o=n[i][1];if(!o&&this.hasChildGroup(s)){var l=this.getContainerGroup(s).searchValidTarget(e,t);if(l)return true}else if(r){this.movePlaceholder(s,e);return true}}},movePlaceholder:function(t,n){var i=e(this.items[t]),a=this.itemDimensions[t],r="after",s=i.outerWidth(),o=i.outerHeight(),l=i.offset(),d={left:l.left,right:l.left+s,top:l.top,bottom:l.top+o};if(this.options.vertical){var u=(a[2]+a[3])/2,f=n.top<=u;if(f){r="before";d.bottom-=o/2}else d.top+=o/2}else{var h=(a[0]+a[1])/2,p=n.left<=h;if(p){r="before";d.right-=s/2}else d.left+=s/2}if(this.hasChildGroup(t))d=c;this.rootGroup.movePlaceholder(this,i,r,d)},getItemDimensions:function(){if(!this.itemDimensions){this.items=this.$getChildren(this.el,"item").filter(":not(.placeholder, .dragged)").get();f(this.items,this.itemDimensions=[],this.options.tolerance)}return this.itemDimensions},getItemOffsetParent:function(){var e,t=this.el;if(t.css("position")==="relative"||t.css("position")==="absolute"||t.css("position")==="fixed")e=t;else e=t.offsetParent();return e},hasChildGroup:function(e){return this.options.nested&&this.getContainerGroup(e)},getContainerGroup:function(t){var a=e.data(this.items[t],d);if(a===i){var r=this.$getChildren(this.items[t],"container");a=false;if(r[0]){var s=e.extend({},this.options,{rootGroup:this.rootGroup,group:l++});a=r[n](s).data(n).group}e.data(this.items[t],d,a)}return a},$getChildren:function(t,n){var i=this.rootGroup.options,a=i[n+"Path"],r=i[n+"Selector"];t=e(t);if(a)t=t.find(a);return t.children(r)},_serialize:function(t,n){var i=this,a=n?"item":"container",r=this.$getChildren(t,a).not(this.options.exclude).map(function(){return i._serialize(e(this),!n)}).get();return this.rootGroup.options.serialize(t,r,n)},traverse:function(t){e.each(this.items||[],function(n){var i=e.data(this,d);if(i)i.traverse(t)});t(this)},_clearDimensions:function(){this.itemDimensions=i},_destroy:function(){var t=this;this.target.off(a.start,this.handle);this.el.removeData(n);if(this.options.drop)this.group.containers=e.grep(this.group.containers,function(e){return e!=t});e.each(this.items||[],function(){e.removeData(this,d)})}};var m={enable:function(){this.traverse(function(e){e.disabled=false})},disable:function(){this.traverse(function(e){e.disabled=true})},serialize:function(){return this._serialize(this.el,true)},refresh:function(){this.traverse(function(e){e._clearDimensions()})},destroy:function(){this.traverse(function(e){e._destroy()})}};e.extend(g.prototype,m);e.fn[n]=function(t){var a=Array.prototype.slice.call(arguments,1);return this.map(function(){var r=e(this),s=r.data(n);if(s&&m[t])return m[t].apply(s,a)||this;else if(!s&&(t===i||typeof t==="object"))r.data(n,new g(r,t));return this})}}(jQuery,window,"sortable");(function(e){var t="undefined";var n,i,a,r,s;var o,l,c,d;function u(e,t){var n=typeof e[t];return n==="function"||!!(n=="object"&&e[t])||n=="unknown"}function f(e,n){return typeof e[n]!=t}function h(e,t){return!!(typeof e[t]=="object"&&e[t])}function p(e){if(window.console&&window.console.log){window.console.log("RangyInputs not supported in your browser. Reason: "+e)}}function v(e,n,i){if(n<0){n+=e.value.length}if(typeof i==t){i=n}if(i<0){i+=e.value.length}return{start:n,end:i}}function g(e,t,n){return{start:t,end:n,length:n-t,text:e.value.slice(t,n)}}function m(){return h(document,"body")?document.body:document.getElementsByTagName("body")[0]}e(document).ready(function(){var b=document.createElement("textarea");m().appendChild(b);if(f(b,"selectionStart")&&f(b,"selectionEnd")){n=function(e){var t=e.selectionStart,n=e.selectionEnd;return g(e,t,n)};i=function(e,t,n){var i=v(e,t,n);e.selectionStart=i.start;e.selectionEnd=i.end};d=function(e,t){if(t){e.selectionEnd=e.selectionStart}else{e.selectionStart=e.selectionEnd}}}else if(u(b,"createTextRange")&&h(document,"selection")&&u(document.selection,"createRange")){n=function(e){var t=0,n=0,i,a,r,s;var o=document.selection.createRange();if(o&&o.parentElement()==e){r=e.value.length;i=e.value.replace(/\r\n/g,"\n");a=e.createTextRange();a.moveToBookmark(o.getBookmark());s=e.createTextRange();s.collapse(false);if(a.compareEndPoints("StartToEnd",s)>-1){t=n=r}else{t=-a.moveStart("character",-r);t+=i.slice(0,t).split("\n").length-1;if(a.compareEndPoints("EndToEnd",s)>-1){n=r}else{n=-a.moveEnd("character",-r);n+=i.slice(0,n).split("\n").length-1}}}return g(e,t,n)};var $=function(e,t){return t-(e.value.slice(0,t).split("\r\n").length-1)};i=function(e,t,n){var i=v(e,t,n);var a=e.createTextRange();var r=$(e,i.start);a.collapse(true);if(i.start==i.end){a.move("character",r)}else{a.moveEnd("character",$(e,i.end));a.moveStart("character",r)}a.select()};d=function(e,t){var n=document.selection.createRange();n.collapse(t);n.select()}}else{m().removeChild(b);p("No means of finding text input caret position");return}m().removeChild(b);function y(e,t){var i=e.value,a=n(e),r=a.start;return{value:i.slice(0,r)+t+i.slice(a.end),index:r,replaced:a.text}}function _(e,t){e.focus();var a=n(e);i(e,a.start,a.end);if(t==""){document.execCommand("delete",false,null)}else{document.execCommand("insertText",false,t)}return{replaced:a.text,index:a.start}}function x(e,t){e.focus();var n=y(e,t);e.value=n.value;return n}var C=function(e,t){var n=y(e,t);try{var i=_(e,t);if(e.value==n.value){C=_;return i}}catch(a){}C=x;e.value=n.value;return n};r=function(e,t,n,a){if(t!=n){i(e,t,n);C(e,"")}if(a){i(e,t)}};a=function(e){i(e,C(e,"").index)};c=function(e){var t=C(e,"");i(e,t.index);return t.replaced};var w=function(e,t,n,a){var r=t+n.length;a=typeof a=="string"?a.toLowerCase():"";if((a=="collapsetoend"||a=="select")&&/[\r\n]/.test(n)){var s=n.replace(/\r\n/g,"\n").replace(/\r/g,"\n");r=t+s.length;var o=t+s.indexOf("\n");if(e.value.slice(o,o+2)=="\r\n"){r+=s.match(/\n/g).length}}switch(a){case"collapsetostart":i(e,t,t);break;case"collapsetoend":i(e,r,r);break;case"select":i(e,t,r);break}};s=function(e,t,n,a){i(e,n);C(e,t);if(typeof a=="boolean"){a=a?"collapseToEnd":""}w(e,n,t,a)};o=function(e,t,n){var i=C(e,t);w(e,i.index,t,n||"collapseToEnd")};l=function(e,i,a,r){if(typeof a==t){a=i}var s=n(e);var o=C(e,i+s.text+a);w(e,o.index+i.length,s.text,r||"select")};function k(e,t){return function(){var n=this.jquery?this[0]:this;var i=n.nodeName.toLowerCase();if(n.nodeType==1&&(i=="textarea"||i=="input"&&/^(?:text|email|number|search|tel|url|password)$/i.test(n.type))){var a=[n].concat(Array.prototype.slice.call(arguments));var r=e.apply(this,a);if(!t){return r}}if(t){return this}}}e.fn.extend({getSelection:k(n,false),setSelection:k(i,true),collapseSelection:k(d,true),deleteSelectedText:k(a,true),deleteText:k(r,true),extractSelectedText:k(c,false),insertText:k(s,true),replaceSelectedText:k(o,true),surroundSelectedText:k(l,true)})})})(jQuery);var rpnblackboxmodule=function(){var e;var t;var n;var i;var a;var r=function(e,t,n,i,a,r,v,g,m,b,y,_,x){var C=function(e,t,n,i){switch(e){case"isNumberN":s(t,n,i);break;case"isNumberZ":o(t,n,i);break;case"isNumberD":c(t,n,i);break;case"isNumberQ":l(t,n,i);break;case"isNumber":d(t,n,i);break;case"withComma":u(t);break;case"firstPoint":f(t);break;case"firstComma":h(t);break;case"firstPointComma":p(t);break;default:break}};$(e).bind("input propertychange",function(){C(a,e,t,n);C(r,e,t,n);C(v,e,t,n);C(g,e,t,n);C(m,e,t,n);C(b,e,t,n);C(y,e,t,n);C(_,e,t,n);C(x,e,t,n)})};var s=function(e,t,n){var i=$(e).val();var a=i.charAt(i.length-1);var r=i.substring(0,i.length-1);if(/[0-9]/.test(a)){if(/0/.test(r)&&r.length==1){$(e).val(a)}$(t).css("display","none")}else if(/,/.test(a)){$(e).val(i.substring(0,i.length-1))}else if(/\./.test(a)){$(e).val(i.substring(0,i.length-1))}else if(/-/.test(a)){$(e).val(i.substring(0,i.length-1))}else{$(e).val(r)}};var o=function(e,t,n){var i=$(e).val();var a=i.charAt(i.length-1);var r=i.substring(0,i.length-1);if(/[0-9]/.test(a)){if(/0/.test(r)&&r.length==1){$(e).val(a)}if(/-0/.test(r)&&r.length==2){$(e).val("-"+a)}$(t).css("display","none")}else if(/,/.test(a)){$(e).val(i.substring(0,i.length-1))}else if(/\./.test(a)){$(e).val(i.substring(0,i.length-1))}else if(/-/.test(a)){if(i.length>1){$(e).val(i.substring(0,i.length-1))}}else{$(e).val(r)}};var l=function(e,t,n){var i=$(e).val();var a=i.charAt(i.length-1);var r=i.substring(0,i.length-1);if(/[0-9]/.test(a)){if(/0/.test(r)&&r.length==1){$(e).val(a)}if(/-0/.test(r)&&r.length==2){$(e).val("-"+a)}$(t).css("display","none")}else if(/,/.test(a)){$(e).val(i.substring(0,i.length-1));$(n).text(monTexte);$(t).css("display","block")}else if(/\./.test(a)){$(e).val(i.substring(0,i.length-1))}else if(/-/.test(a)){if(i.length>1){$(e).val(i.substring(0,i.length-1))}}else{$(e).val(r)}};var c=function(e,t,n){var i=$(e).val(),a=i.charAt(i.length-1),r=i.substring(0,i.length-1);if(/[0-9]/.test(a)){if(/0/.test(r)&&r.length==1){$(e).val(a)}if(/-0/.test(r)&&r.length==2){$(e).val("-"+a)}$(t).css("display","none")}else if(/,/.test(a)){if(/,/.test(r.substring(0,i.length-1))){$(e).val(i.substring(0,i.length-1))}}else if(/\./.test(a)){if(/,/.test(r.substring(0,i.length-1))){$(e).val(i.substring(0,i.length-1))}}else if(/-/.test(a)){if(i.length>1){$(e).val(i.substring(0,i.length-1))}}else{$(e).val(r)}};var d=function(e,t,n){var i=$(e).val(),a=i.charAt(i.length-1),r=i.substring(0,i.length-1);if(/[0-9]/.test(a)){if(/0/.test(r)&&r.length==1){$(e).val(a)}if(/-0/.test(r)&&r.length==2){$(e).val("-"+a)}$(t).css("display","none")}else if(/,/.test(a)){if(/,/.test(r.substring(0,i.length-1))){$(e).val(i.substring(0,i.length-1))}}else if(/\./.test(a)){if(/,/.test(r.substring(0,i.length-1))){$(e).val(i.substring(0,i.length-1))}}else if(/-/.test(a)){if(i.length>1){$(e).val(i.substring(0,i.length-1))}}else{$(e).val(r)}};var u=function(e){var t=$(e).val(),n=t.charAt(t.length-1),i=t.substring(0,t.length-1);if(/,/.test(n)){if(/,/.test(i.substring(0,t.length-1))){$(e).val(t.substring(0,t.length-1))}}if(/\./.test(n)){if(/,/.test(i)){$(e).val(i.substring(0,i.length-1))}else{$(e).val(t.substring(0,t.length-1).concat(","))}}};var f=function(e){var t=$(e).val(),n=t.charAt(t.length-1),i=t.substring(0,t.length-1);if(/-/.test(i)&&/^\./.test(n)){$(e).val("-0.")}if(/^\./.test(t)){$(e).val("0.")}};var h=function(e){var t=$(e).val(),n=t.charAt(t.length-1),i=t.substring(0,t.length-1);if(/-/.test(i)&&/^,/.test(n)){$(e).val("-0,")}if(/^,/.test(t)){$(e).val("0,")}};var p=function(e){var t=$(e).val(),n=t.charAt(t.length-1),i=t.substring(0,t.length-1);if(/-/.test(i)&&/^\./.test(n)){$(e).val("-0,")}if(/^\./.test(t)){$(e).val("0,")}};var v=function(i,r,s){_.defaults(i,{operation:"x1",left:[1],right:[1],shuffle:false,validation:{mode:"lock",type:"integer"}});e=i;t=s;n=i.shuffle;if(!_.isUndefined(r)){a=r}else{a=[];_.each(e.right,function(e,t){a.push({position:"right",originalposition:t,value:e,response:null})});_.each(e.left,function(e,t){a.push({position:"left",originalposition:t,value:e,response:null})});if(n)a=_.shuffle(a)}g()};var g=function(){t.addClass("blackbox");t.append($('<div class="row header"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><p class="text-center">x</p></div><div class="col-xs-2 operation"></div><div class="col-xs-2"><p class="text-center">y</p></div></div>'));$(".header",t).hide();_.each(a,function(n,i){if(n.position=="left"){t.append($('<div class="row"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><p class="text-center">'+n.value+'</p></div><div class="col-xs-2 operation"><p class="text-center"><i class="glyphicon glyphicon-minus"></i>'+e.operation+'<i class="glyphicon glyphicon-arrow-right"></i></p></div><div class="col-xs-2"><input type="text" data-bind="" class="rpnm_input form-control" style="text-align: center;"></div></div>'))}else{t.append($('<div class="row"><div class="col-md-3 hidden-xs hidden-sm"></div><div class="col-xs-2"><input type="text" class="rpnm_input form-control" style="text-align: center;"></div><div class="col-xs-2 operation"><p class="text-center"><i class="glyphicon glyphicon-minus"></i>'+e.operation+'<i class="glyphicon glyphicon-arrow-right"></i></p></div><div class="col-xs-2"><p class="text-center">'+n.value+"</p></div></div>"))}});$.each($(".rpnm_input",t),function(e,t){$(t).val(a[e].response)});i=$("<button>",{"data-toggle":"button","class":"btn btn-link btn-xs",text:" "+rpnsequence.getLabels().BlackboxTableView}).prepend($('<i class="glyphicon glyphicon-resize-small"></i>'));t.append($('<p class="text-center"></p>').append(i));b()};var m=function(){$(".operation",t).slideToggle();$(".header",t).slideToggle()};var b=function(){i.click(function(){var e=$(this),t=this.lastChild;e.find("i").toggleClass("glyphicon-resize-small glyphicon-resize-full");t.nodeValue=" ";t.nodeValue=" "+(e.hasClass("showArchieved")?rpnsequence.getLabels().BlackboxTableView:rpnsequence.getLabels().BlackboxView);e.toggleClass("showArchieved");m()});rpnsequence.addvalidation($(".rpnm_input",t),e.validation)};var y=function(){$.each($(".rpnm_input",t),function(e,t){a[e].response=$(t).val()});rpnsequence.handleEndOfModule(a,function(e,t){var n=0;_.each(t.right,function(t,i){n+=_.findWhere(e,{position:"right",originalposition:i}).response==t?1:0});_.each(t.left,function(t,i){n+=_.findWhere(e,{position:"left",originalposition:i}).response==t?1:0});return n})};return{init:v,validate:y}};var rpncardmazemodule=function(){var e;var t;var n;var i;var a;var r;var s;var o;var l;var c=function(n,s,o){_.defaults(n,{mazewidth:6,mazeheight:4,cards:[{label:"label",clue:"clue"}]});e=n;i=e.mazeheight;a=e.mazewidth;t=o;l=[];r=[];if(!_.isUndefined(s)){l=s}d()};var d=function(){t.addClass("cardmaze");t.append($('<div class="row"><div class="container maze"></div></div>'));_.each(e.cards,function(e,i){$(".maze",t).append($('<div class="col-xs-2 nopadding"></div>').append($('<div class="card'+(e.start?" start selectable":"")+(e.end?" end":"")+'"><p>'+e.label+"</p><p>"+e.clue+"</p></div>").data("cardId",i)));if(e.start){n=i;s=i}if(e.end){o=i}});u();_.each(l,function(e,t){$($(".card")[e]).trigger("click")})};var u=function(){_.each($(".card"),function(e,t){$(e).click(function(){if($(e).hasClass("start")||$(e).hasClass("selectable")||$(e).hasClass("selected")){if((t==n&&$(e).hasClass("start")||t==n+a||t==n-a||t==n-1||t==n+1)&&!$(e).hasClass("selected")){r.push(e)}else if($(e).hasClass("selected")){r=r.slice(0,_.indexOf(r,e)+1)}n=t;$(".selected").removeClass("selected");$(".selectable").removeClass("selectable");$(".card").removeClass("fromtop frombottom fromleft fromright totop tobottom toleft toright");_.each(r,function(e,t){if(t>0){var n=$(e).data("cardId")-$(r[t-1]).data("cardId");if(n==a){$(e).addClass("fromtop")}else if(n==-a){$(e).addClass("frombottom")}else if(n==1){$(e).addClass("fromleft")}else if(n==-1){$(e).addClass("fromright")}}if(t<r.length-1){var n=$(e).data("cardId")-$(r[t+1]).data("cardId");if(n==-a){$(e).addClass("tobottom")}else if(n==a){$(e).addClass("totop")}else if(n==-1){$(e).addClass("toright")}else if(n==1){$(e).addClass("toleft")}}$(e).addClass("selected")});if(t!=o){if(!(t+a>a*i)){$($(".card")[t+a]).addClass("selectable")}if(!(t-a<0)){$($(".card")[t-a]).addClass("selectable")}if(t%a!=0){$($(".card")[t-1]).addClass("selectable")}if((t+1)%a!=0){$($(".card")[t+1]).addClass("selectable")}}}})})};var f=function(){_.each(r,function(e,t){l[t]=$(e).data("cardId")});rpnsequence.handleEndOfModule(l,function(e,t){var n=0;_.each(t,function(t,i){n+=e[i]==t?1:0});return n})};return{init:c,validate:f}};var rpnclockmodule=function(){var e;var t;var n;var i;var a=function(n,a,s){_.defaults(n,{random:true,hour:"10:10"});e=n;if(e.random){e.hour=Math.floor(Math.random()*24+1)+":"+Math.floor(Math.random()*59)}if(!(_.isUndefined(a)||_.isEmpty(a)||_.isNull(a))){i=a}else{i=e.hour}t=s;r()};var r=function(){t.addClass("clock");t.append($('<div id="rpnclock"></div>'));n=EduClock();n.init({hour:parseInt(i.split(":")[0]),minute:parseInt(i.split(":")[1])},$("#rpnclock"));s()};var s=function(){};var o=function(){var e=n.getCurrentTime();rpnsequence.handleEndOfModule(e.hour+":"+e.minute,function(e,t){return e==t?1:0})};return{init:a,validate:o}};var EduClock=function(){var e;var t;var n;var i;var a;var r=false;var s;var o;var l;var c;var d;var u;var f;var h;var p;var v;var g;var m;var b=function(n,i){_.defaults(n,{margin:10,marginnumbers:-30,fontheight:15,hour:10,minute:10});t=n;m=t.hour>12;e=i;p="nothing";y()};var y=function(){n=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 0;"});i=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 1;"});a=$("<canvas>",{style:"position: absolute; left: 0; top: 0; z-index: 2;"});e.append([n,i,a]);n=n[0];i=i[0];a=a[0];s=Math.min(e.width(),e.height());n.width=s;n.height=s;i.width=s;i.height=s;a.width=s;a.height=s;d=s/2-t.margin;u=d+t.marginnumbers;o=n.getContext("2d");l=i.getContext("2d");c=a.getContext("2d");c.translate(s/2,s/2);f=t.hour;h=t.minute;x();C();S()};var x=function(){l.save();l.font="15px Arial";l.lineWidth=3;l.beginPath();l.arc(s/2,s/2,s/2-t.margin,0,Math.PI*2,true);l.stroke();l.beginPath();l.arc(s/2,s/2,10,0,Math.PI*2,true);l.fill();l.fillStyle="#fff";l.beginPath();l.arc(s/2,s/2+d/2,d/4,0,Math.PI*2,true);l.fill();l.fillStyle="#000";var e=[1,2,3,4,5,6,7,8,9,10,11,12];var n=0;var a=0;l.font=t.fontheight+"px Arial";$.each(e,function(e,r){n=Math.PI/6*(r-3);a=l.measureText(r).width;l.fillText(r,i.width/2+Math.cos(n)*u-a/2,i.height/2+Math.sin(n)*u+t.fontheight/3)});l.translate(s/2,s/2);n=Math.PI/30;for(var r=1;r<=60;r++){var o=r%5==0;l.rotate(n);var c=o?8:2;var f=o?15:8;l.fillRect(d-f,-c/2,f,c)}l.translate(-s/2,-s/2);l.restore()};var C=function(){c.save();c.clearRect(-s/2,-s/2,s,s);v=(f*60+h)*.5%360*Math.PI/180-Math.PI/2;if(v<0){v+=2*Math.PI}g=h*6%360*Math.PI/180-Math.PI/2;if(g<0){g+=2*Math.PI}c.rotate(v);c.fillStyle="#000";c.fillRect(5,-4,d*.6,8);c.rotate(-v);c.fillStyle="#f00";c.rotate(g);c.fillRect(5,-2,d*.85,4);c.rotate(-g);c.restore();w()};var w=function(){var e=D();var t=e.hour*60+e.minute;var n=0;if(t>960&&t<1200){n=(1200-t)/2.4}if(t>240&&t<480){n=Math.abs((t-480)/2.4);n=100-n}if(t>=480&&t<=960){n=100}var i=k(new Color("ffffff"),new Color("428bca"),n);o.fillStyle=i.toRGB();o.fillRect(0,0,s,s)};var k=function(e,t,n){var i=n/100;var a=i*2-1;var r=e.toHSL().a-t.toHSL().a;var s=((a*r==-1?a:(a+r)/(1+a*r))+1)/2;var o=1-s;var l=[e.rgb[0]*s+t.rgb[0]*o,e.rgb[1]*s+t.rgb[1]*o,e.rgb[2]*s+t.rgb[2]*o];var c=e.alpha*i+t.alpha*(1-i);return new Color(l,c)};var M=function(e,t){var n=Math.atan2(t-s/2,e-s/2);if(n<0){n=n+2*Math.PI}return n};var P=function(e,n){p="nothing";var i=M(e,n);var a=Math.sqrt(Math.pow(n-s/2,2)+Math.pow(e-s/2,2));if(a<=s/2-t.margin){if(i>g-Math.PI/12&&i<g+Math.PI/12){p="minutes"}else if(i>v-Math.PI/6&&i<v+Math.PI/6){p="hours"}else{p="nothing"}}};var E=function(e,n){var i=Math.sqrt(Math.pow(n-s/2,2)+Math.pow(e-s/2,2));if(i<=s/2-t.margin){var a=M(e,n);a=a+Math.PI/2;if(a>2*Math.PI){a=a-2*Math.PI}if(p=="minutes"){var r=h;h=Math.round(30/Math.PI*a);if(h>=60){h=0}if(h<=15&&r>=45){f++}else if(h>=45&&r<=15){f--}if(f>11){console.log("currentHours:"+f+", PM:"+m);m=!m;f=0}else if(f<0){console.log("currentHours:"+f+", PM:"+m);m=!m;f=11}}else if(p=="hours"){var o=f;var l=Math.round(360/Math.PI*a);h=l%60;var c=Math.floor((l-h)/60);if(c==12){c=0}if(o<=11&&o>=9&&c>=0&&c<=3||o>=0&&o<=3&&c>=9&&c<=11){m=!m}f=c}C()}};var S=function(){$(a).on("mousedown",function(e){P(e.offsetX,e.offsetY);if(p!="nothing"){r=true}});$(a).on("mouseup",function(){r=false});$(a).on("mouseout",function(){r=false});$(a).on("mousemove",function(e){if(r&&p!="nothing"){E(e.offsetX,e.offsetY)}})};var D=function(){return{hour:f+(m?12:0),minute:h}};return{init:b,getCurrentTime:D}};var Color=function(e,t){if(Array.isArray(e)){this.rgb=e}else if(e.length==6){this.rgb=e.match(/.{2}/g).map(function(e){return parseInt(e,16)})}else{this.rgb=e.split("").map(function(e){return parseInt(e+e,16)})}this.alpha=typeof t==="number"?t:1};Color.prototype.type="Color";function toHex(e){return"#"+e.map(function(e){e=Math.min(Math.max(Math.round(e),0),255);return(e<16?"0":"")+e.toString(16)}).join("")}Color.prototype.luma=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,n=this.rgb[2]/255;e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4);t=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4);n=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4);return.2126*e+.7152*t+.0722*n};Color.prototype.toRGB=function(){return toHex(this.rgb)};Color.prototype.toHSL=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,n=this.rgb[2]/255,i=this.alpha;var a=Math.max(e,t,n),r=Math.min(e,t,n);var s,o,l=(a+r)/2,c=a-r;if(a===r){s=o=0}else{o=l>.5?c/(2-a-r):c/(a+r);switch(a){case e:s=(t-n)/c+(t<n?6:0);break;case t:s=(n-e)/c+2;break;case n:s=(e-t)/c+4;break}s/=6}return{h:s*360,s:o,l:l,a:i}};Color.prototype.toHSV=function(){var e=this.rgb[0]/255,t=this.rgb[1]/255,n=this.rgb[2]/255,i=this.alpha;var a=Math.max(e,t,n),r=Math.min(e,t,n);var s,o,l=a;var c=a-r;if(a===0){o=0}else{o=c/a}if(a===r){s=0}else{switch(a){case e:s=(t-n)/c+(t<n?6:0);break;case t:s=(n-e)/c+2;break;case n:s=(e-t)/c+4;break}s/=6}return{h:s*360,s:o,v:l,a:i}};Color.prototype.toARGB=function(){return toHex([this.alpha*255].concat(this.rgb))};Color.prototype.compare=function(e){return e.rgb&&e.rgb[0]===this.rgb[0]&&e.rgb[1]===this.rgb[1]&&e.rgb[2]===this.rgb[2]&&e.alpha===this.alpha?0:undefined};var rpndragdropsortingmodule=function(){var e;var t;var n;var i=function(i,r,s){_.defaults(i,{todrag:["empty"],todrop:["empty too :'("]});e=i;t=s;if(!_.isUndefined(r)){n=r}else{n={todrag:e.todrag,todrop:e.todrop}}a()};var a=function(){t.addClass("dragdropsorting");t.append($('<div class="row"><div class="container"><div class="col-md-2 col"><ul class="dragthis list-unstyled"></ul></div></div><div class="row"><div class="container dropzonecontainer"></div></div>'));$.each(e.todrop,function(e,i){$(".dropzonecontainer",t).append($('<div class="col-md-2"><div class="droppable"><span class="lead">'+i+'</span><ul class="list-unstyled"></ul></div></div>'));if(!_.isUndefined(n[i])){_.each(n[i],function(t,n){$("ul",$(".droppable")[e]).append('<li class="draggable">'+t+"</li>")})}});$(".droppable ul").sortable({group:"drop",onDrop:function(e,t,i){n.todrag.pop();r();i(e)}});s();r()};var r=function(){if($(".dragthis li").length==0&&n.todrag.length>0){var e=_.last(n.todrag);$(".dragthis").append($('<li class="draggable">'+e+"</li>"));$(".dragthis").sortable({group:"drop",drop:false})}};var s=function(){};var o=function(){_.each($(".droppable"),function(e,t){var i=[];$.each($(e).find("li"),function(e,t){i.push($(t).text())});n[$(e).find("span").text()]=i});rpnsequence.handleEndOfModule(n,function(e,t){var n=0;_.map(t,function(t,i){n+=_.intersection(e[i],t).length});return n})};return{init:i,validate:o}};var rpngapfullmodule=function(){var e;var t;var n;var i;var a=function(n,a,s){_.defaults(n,{sentence:"sentence not set!"});e=n;t=s;if(!_.isUndefined(a)){i=a}else{i=e.sentence}r()};var r=function(){t.addClass("gapfull");t.append($("<p>"+e.sentence+'</p><input type="text" class="rpnm_input form-control">'));n=$(".rpnm_input",t);n.val(i);s()};var s=function(){};var o=function(){i=$(".rpnm_input",t).val();rpnsequence.handleEndOfModule(i,function(e,t){return e==t?1:0})};return{init:a,validate:o}};var rpngapsimplemodule=function(){var e;var t;var n;var i;var a;var r=function(i,r,o){_.defaults(i,{tofill:"tofill not set!<b>Read</b> documentation please!"});e=i;n=!_.isUndefined(i.fillers);t=o;if(!_.isUndefined(r)){a=r}else{a=_.map($("b",e.tofill),function(e,t){return""})}s()};var s=function(){t.addClass("gapsimple");if(n){var r=$('<div class="gapsimpleddtoolbar">');$.each(e.fillers,function(e,t){r.append($('<span class="draggable">'+t+"</span> "))});i=_.max(e.fillers,function(e){return e.length}).length;t.append(r.sortable({group:"drop",drop:false,itemSelector:"span",containerSelector:"div",placeholder:'<span class="placeholder"/>',onDragStart:function(e,t,n){if(!t.options.drop){e.clone().insertAfter(e)}else{$("<span>"+Array(i).join("_")+"</span>").insertAfter(e)}n(e)},onDrop:function(e,t,n,i){e.parent().empty().append(e);n(e)}}))}t.append($('<div class="form-inline">'+e.tofill+"</div>"));$.each($("b",t),function(e,r){var s=$(r);if(n){s.replaceWith($('<b class="gapsimpleddresponse">').append('<span class="'+(_.isEmpty(a[e])?"":"draggable")+'">'+(_.isEmpty(a[e])?Array(i).join("_"):a[e])+"</span>").sortable({group:"drop",itemSelector:"span",containerSelector:"b",vertical:false}))}else{s.replaceWith($('<input type="text" class="rpnm_input gapsimple form-control"> <strong>('+s.text()+")</strong>"));$($(".rpnm_input",t)[e]).val(a[e])}});o()};var o=function(){};var l=function(){if(n){_.each($(".gapsimpleddresponse",t),function(e,t){a[t]=$(".draggable",$(e)).text()})}else{$.each($(".gapsimple",t),function(e,t){a[e]=$(t).val()})}rpnsequence.handleEndOfModule(a,function(e,t){var n=0;_.each(t,function(t,i){n+=e[i]==t?1:0});return n})};return{init:r,validate:l}};var rpnmarkermodule=function(){var e;var t;var n;var i=function(i,r,s){_.defaults(i,{markers:[],tomark:["fill tomark please!"]});e=i;t=s;if(!_.isUndefined(r)){n=r}else{var o=_.shuffle(["primary","success","info","warning","danger"]);
n={selectedMarker:"",responses:_.map($("b",e.tomark),function(e,t){return""}),markers:_.map(e.markers,function(e,t){return{label:e,color:o[t]||"default"}})}}a()};var a=function(){t.addClass("marker");var i=$("<div>",{"class":"btn-group","data-toggle":"buttons"});i.append($('<label class="btn btn-default '+(n.selectedMarker==""?"active":"")+'"><input type="radio" name="options" autocomplete="off" '+(n.selectedMarker==""?"checked":"")+'><i class="glyphicon glyphicon-remove-sign"></i> '+rpnsequence.getLabels().Eraser+"</label>").click(function(){n.selectedMarker=""}));$.each(n.markers,function(e,t){i.append($('<label class="btn btn-'+t.color+" "+(n.selectedMarker==t.label?"active":"")+'"><input type="radio" name="options" autocomplete="off" '+(n.selectedMarker==t.label?"checked":"")+'><i class="glyphicon glyphicon-pencil"></i> '+t.label+"</label>").click(function(){n.selectedMarker=t.label}))});t.append(i);t.append($("<div>"+e.tomark+"</div>"));$.each($("b",t),function(e,t){var i=$(t);if(!_.isEmpty(n.responses[e])){i.addClass("marker-"+_.findWhere(n.markers,{label:n.responses[e]}).color)}i.css("cursor","pointer").click(function(){i.removeClass();if(n.selectedMarker!=""){i.addClass("marker-"+_.findWhere(n.markers,{label:n.selectedMarker}).color)}n["responses"][e]=n.selectedMarker})});r()};var r=function(){};var s=function(){rpnsequence.handleEndOfModule(n,function(e,t){var n=0;_.each(t,function(t,i){n+=e.responses[i]==t?1:0});return n})};return{init:i,validate:s}};var rpnmqcmodule=function(){var e;var t;var n;var i=function(i,r,s){_.defaults(i,{questions:["No questions!"],answers:["As no answers"]});e=i;t=s;if(!_.isUndefined(r)){n=r}else{n={responses:_.map(e.questions,function(e,t){return""})}}a()};var a=function(){t.addClass("mqc");var i=$("<ul>",{"class":"list-unstyled"});$.each(e.questions,function(t,a){var r=$("<li>");r.append($("<p>"+a+"</p>"));var s=$('<div class="btn-group" data-toggle="buttons">');$.each(e.answers,function(e,i){s.append($('<label class="btn btn-default '+(!_.isEmpty(n.responses[t])&&n.responses[t]==i?"active":"")+'"><input type="radio" autocomplete="off" '+(!_.isEmpty(n.responses[t])&&n.responses[t]==i?"checked":"")+">"+i+"</label>").click(function(){n.responses[t]=i}));r.append(s)});i.append(r)});t.append(i);r()};var r=function(){};var s=function(){rpnsequence.handleEndOfModule(n,function(e,t){var n=0;_.each(t,function(t,i){n+=e.responses[i]==t?1:0});return n})};return{init:i,validate:s}};var rpnsequence=function(){var e;var t;var n;var i;var a;var r;var s;var o;var l;var c;var d;var u;var f;var h;var p;var v;var g;var m;var b={en:{Recall:"Recall",Order:"Order",Warning:"Warning",BeforeUnloadMsg:"Module running!",Wait:"Please wait...",Validate:"Next module",EndSequence:"End",Eraser:"Eraser",DragDropNotEmpty:"There are still some items to sort!",CardMazeNotEnded:"You have not finished the maze!",Sources:"Sources",BlackboxTableView:"Values table",BlackboxView:"Blackbox"},fr:{Recall:"Rappel",Order:"Consignes",Warning:"Attention",BeforeUnloadMsg:"Exercice en cours!",Wait:"Veuillez patienter...",Validate:"Exercice suivant",EndSequence:"Terminer",Eraser:"Effaceur",DragDropNotEmpty:"Il y a encore des éléments à trier!",CardMazeNotEnded:"Vous n'avez pas terminé le labyrinthe!",Sources:"Sources",BlackboxTableView:"Tableau de valeurs",BlackboxView:"Boîte noire"}};var y=function(n){if(_.isUndefined(n)){n={}}_.defaults(n,{sequrl:"seq.json",solurl:"sol.json",stateurl:"sta.json",returnurl:"../",warnonexit:false,domelem:$("body"),onsequenceend:function(){},onmoduleend:function(){},mediapathformatter:function(e){return"medias/"+e},language:"en",debug:false,navigationEnabled:false});g=b[n.language];s=[];m=[];o=n.warnonexit;r=n.returnurl;a=n.solurl;v=n.debug;f=n.domelem;l=n.onsequenceend;c=n.onmoduleend;d=n.mediapathformatter;$.getJSON(n.sequrl,function(i){_.defaults(i,{title:"sequencetitle",modules:[]});e=i;_.each(e.modules,function(e,t){e["status"]="init"});t=0;p=n.navigationEnabled&&e.modules.length>1;$.getJSON(n.stateurl,function(t){s=_.map(e.modules,function(e,n){return{state:t.states[n],correctionFct:undefined}});x()}).error(function(){s=_.map(e.modules,function(e,t){return{state:undefined,correctionFct:undefined}});x()})})};var x=function(){f.append($('<div class="container" id="rpnm"></div>').append([$('<div class="row page-header"><div class="col-md-8"><h1 id="rpnm_seq_title"></h1></div><div class="col-md-4"><nav id="rpnm_modulenav"><ul class="pagination pagination-sm"></ul></nav></div></div>'),$('<div class="row"><div class="col-md-12"><h2 id="rpnm_title"></h2><h3 id="rpnm_context"></h3><h4 id="rpnm_directive"></h4></div></div>'),$('<div class="row"><div id="rpnm_module_content" class="col-md-12"></div></div>'),$('<div class="row"><div class="col-md-12"><em id="rpnm_source" class="pull-right"></em></div></div>'),$('<div class="row"><div class="col-md-12"><button id="rpnm_validation" class="btn btn-primary pull-right"></button></div></div>')]));f.append($('<div id="rpnm_recall_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-bell"></i> '+g.Recall+'</h4></div><div class="modal-body"></div></div></div></div>'));f.append($('<div id="rpnm_order_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-question-sign"></i> '+g.Order+'</h4></div><div class="modal-body"></div></div></div></div>'));f.append($('<div id="rpnm_alert_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title"><i class="glyphicon glyphicon-warning-sign"></i> '+g.Warning+'</h4></div><div class="modal-body"></div></div></div></div>'));f.append($('<div id="rpnm_wait_modal" class="modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title">'+g.Wait+'</h4></div><div class="modal-body"><div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"><span class="sr-only">100% completed</span></div></div></div></div></div></div>'));$("#rpnm_seq_title").html(e.title);h=$("#rpnm_validation");i=$("#rpnm_source");n=$("#rpnm_module_content");u=$("#rpnm_alert_modal");if(!p){$("#rpnm_modulenav").remove()}_.each(e.modules,function(e,t){var i=$('<div class="rpnm_instance" id="rpnm_inst_'+t+'">');n.append(i);if(_.isNull(s[t]).state){_.isNull(s[t]).state=undefined}if(e.type=="marker"){m[t]=rpnmarkermodule();m[t].init(e,s[t].state,i)}else if(e.type=="mqc"){m[t]=rpnmqcmodule();m[t].init(e,s[t].state,i)}else if(e.type=="gapsimple"){m[t]=rpngapsimplemodule();m[t].init(e,s[t].state,i)}else if(e.type=="gapfull"){m[t]=rpngapfullmodule();m[t].init(e,s[t].state,i)}else if(e.type=="clock"){m[t]=rpnclockmodule();m[t].init(e,s[t].state,i)}else if(e.type=="blackbox"){m[t]=rpnblackboxmodule();m[t].init(e,s[t].state,i)}else if(e.type=="dragdropsorting"){m[t]=rpndragdropsortingmodule();m[t].init(e,s[t].state,i)}else if(e.type=="cardmaze"){m[t]=rpncardmazemodule();m[t].init(e,s[t].state,i)}i.hide();i.disableSelection();$("#rpnm_modulenav ul").append($('<li><a href="#">'+(t+1)+"</a></li>"))});if(o){$(window).bind("beforeunload",function(e){return g.BeforeUnloadMsg})}C();w()};var C=function(){h.click(function(){m[t].validate();if(t==e.modules.length-1){P()}else{t++;w()}});if(p&&e.modules.length>1){_.each($("#rpnm_modulenav ul li"),function(e,n){$(e).click(function(){m[t].validate();t=n;w()})})}};var w=function(){$("#rpnm_wait_modal").modal("show");var n=e.modules[t];_.defaults(n,{title:"title"});$(".rpnm_instance").hide();var i=$("#rpnm_inst_"+t);k(n);D();if(p){$("#rpnm_modulenav ul li").removeClass("active");$($("#rpnm_modulenav ul li")[t]).addClass("active")}if(t==e.modules.length-1){h.html('<i class="glyphicon glyphicon glyphicon-ok-circle"></i> '+g.EndSequence).removeClass("btn-primary").addClass("btn-success")}else{h.html('<i class="glyphicon glyphicon-ok"></i> '+g.Validate).removeClass("btn-success").addClass("btn-primary")}i.show();$("#rpnm_wait_modal").modal("hide")};var k=function(e){$("#rpnm_title").show().html(e.title+' <button class="btn btn-default btn-sm  pull-right" href="#" id="rpnm_order_link" data-toggle="modal" data-target="#rpnm_order_modal"><i class="glyphicon glyphicon-question-sign"></i> '+g.Order+'</button><button class="btn btn-default btn-sm pull-right" id="rpnm_recall_link" data-toggle="modal" data-target="#rpnm_recall_modal"><i class="glyphicon glyphicon-bell"></i> '+g.Recall+"</button>");_.isUndefined(e.context)?$("#rpnm_context").hide():$("#rpnm_context").show().text(e.context);_.isUndefined(e.directive)?$("#rpnm_directive").hide():$("#rpnm_directive").show().text(e.directive);if(_.isUndefined(e.recall)){$("#rpnm_recall_link").hide()}else{$("#rpnm_recall_link").show();$("#rpnm_recall_modal .modal-body").html(e.recall)}if(_.isUndefined(e.order)){$("#rpnm_order_link").hide()}else{$("#rpnm_order_link").show();$("#rpnm_order_modal .modal-body").html(e.order)}i.html(_.isUndefined(e.sources)?"":g.Sources+": "+e.sources)};var M=function(n,i){$("#rpnm_wait_modal").modal("show");S("End of module");s[t]={state:n,correctionFct:i};c({states:_.map(s,function(e){return e.state})});e.modules[t].status="ended"};var P=function(){S("End of sequence");l(s);$.getJSON(a,function(e){var t=0;_.each(e.solutions,function(e,n){t+=_.isUndefined(s[n])?0:s[n].correctionFct(s[n].state,e)});S("Calculated total score for sequence "+t);if(o){$(window).unbind("beforeunload")}window.location=r})};var E=function(e,t){$("#rpnm_alert_modal .modal-body").text(e);u.modal();u.on("hidden.bs.modal",function(){if(!_.isUndefined(t)){t()}})};var S=function(e){if(v){console.log(e)}};var D=function(){_.each($("img:not(.rpnm-img, .rpnm-mediapath)"),function(e,t){var n=$(e);n.attr("src",d($(e).attr("src"))).addClass("rpnm-mediapath");if(n.is(".modal-body img")){n.addClass("img-responsive img-rounded")}})};var I=function(){return g};var T=function(e,t){_.defaults(t,{mode:"lock",type:"integer"});$(e).bind("cut copy paste",function(e){e.preventDefault()});if(t.mode=="lock"){$(e).keydown(function(e){if(t.type=="integer"){if(!_.contains([8,9,16,37,39,46,48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105,109,189],e.keyCode)||(e.keyCode==109||e.keyCode==189)&&$(this).getSelection().start!=0){S(e.keyCode);e.preventDefault()}}});$(e).keyup(function(){});$(e).change(function(){if(t.type=="integer"){var e=/(^-?[1-9]\d*)/.exec($(this).val());if(e==""||e==null){$(this).val("")}else{$(this).val(parseInt(e))}}})}else{}};return{init:y,buildUi:x,handleEndOfModule:M,displayAlert:E,log:S,getLabels:I,addvalidation:T}}();
//# sourceMappingURL=rpnmodule.0.0.3.min.js.map